import{Buffer as s}from"node:buffer";import o from"node:process";import{EventEmitter as a}from"node:events";import{setImmediate as c,clearImmediate as u}from"node:timers";import{AsyncLocalStorage as p}from"node:async_hooks";import{pathToFileURL as w}from"node:url";"global"in globalThis||(globalThis.global=globalThis);class WriteStream{fd;columns=80;rows=24;isTTY=!1;constructor(s){this.fd=s}clearLine(s,o){return o&&o(),!1}clearScreenDown(s){return s&&s(),!1}cursorTo(s,o,a){return a&&"function"==typeof a&&a(),!1}moveCursor(s,o,a){return a&&a(),!1}getColorDepth(s){return 1}hasColors(s,o){return!1}getWindowSize(){return[this.columns,this.rows]}write(s,o,a){s instanceof Uint8Array&&(s=(new TextDecoder).decode(s));try{console.log(s)}catch{}return a&&"function"==typeof a&&a(),!1}}class ReadStream{fd;isRaw=!1;isTTY=!1;constructor(s){this.fd=s}setRawMode(s){return this.isRaw=s,this}}function createNotImplementedError(s){return new Error(`[unenv] ${s} is not implemented yet!`)}function notImplemented(s){return Object.assign((()=>{throw createNotImplementedError(s)}),{__unenv__:!0})}const v="22.14.0";class Process extends a{env;hrtime;nextTick;constructor(s){super(),this.env=s.env,this.hrtime=s.hrtime,this.nextTick=s.nextTick;for(const s of[...Object.getOwnPropertyNames(Process.prototype),...Object.getOwnPropertyNames(a.prototype)]){const o=this[s];"function"==typeof o&&(this[s]=o.bind(this))}}emitWarning(s,o,a){console.warn(`${a?`[${a}] `:""}${o?`${o}: `:""}${s}`)}emit(...s){return super.emit(...s)}listeners(s){return super.listeners(s)}#e;#t;#r;get stdin(){return this.#e??=new ReadStream(0)}get stdout(){return this.#t??=new WriteStream(1)}get stderr(){return this.#r??=new WriteStream(2)}#s="/";chdir(s){this.#s=s}cwd(){return this.#s}arch="";platform="";argv=[];argv0="";execArgv=[];execPath="";title="";pid=200;ppid=100;get version(){return`v${v}`}get versions(){return{node:v}}get allowedNodeEnvironmentFlags(){return new Set}get sourceMapsEnabled(){return!1}get debugPort(){return 0}get throwDeprecation(){return!1}get traceDeprecation(){return!1}get features(){return{}}get release(){return{}}get connected(){return!1}get config(){return{}}get moduleLoadList(){return[]}constrainedMemory(){return 0}availableMemory(){return 0}uptime(){return 0}resourceUsage(){return{}}ref(){}unref(){}umask(){throw createNotImplementedError("process.umask")}getBuiltinModule(){}getActiveResourcesInfo(){throw createNotImplementedError("process.getActiveResourcesInfo")}exit(){throw createNotImplementedError("process.exit")}reallyExit(){throw createNotImplementedError("process.reallyExit")}kill(){throw createNotImplementedError("process.kill")}abort(){throw createNotImplementedError("process.abort")}dlopen(){throw createNotImplementedError("process.dlopen")}setSourceMapsEnabled(){throw createNotImplementedError("process.setSourceMapsEnabled")}loadEnvFile(){throw createNotImplementedError("process.loadEnvFile")}disconnect(){throw createNotImplementedError("process.disconnect")}cpuUsage(){throw createNotImplementedError("process.cpuUsage")}setUncaughtExceptionCaptureCallback(){throw createNotImplementedError("process.setUncaughtExceptionCaptureCallback")}hasUncaughtExceptionCaptureCallback(){throw createNotImplementedError("process.hasUncaughtExceptionCaptureCallback")}initgroups(){throw createNotImplementedError("process.initgroups")}openStdin(){throw createNotImplementedError("process.openStdin")}assert(){throw createNotImplementedError("process.assert")}binding(){throw createNotImplementedError("process.binding")}permission={has:notImplemented("process.permission.has")};report={directory:"",filename:"",signal:"SIGUSR2",compact:!1,reportOnFatalError:!1,reportOnSignal:!1,reportOnUncaughtException:!1,getReport:notImplemented("process.report.getReport"),writeReport:notImplemented("process.report.writeReport")};finalization={register:notImplemented("process.finalization.register"),unregister:notImplemented("process.finalization.unregister"),registerBeforeExit:notImplemented("process.finalization.registerBeforeExit")};memoryUsage=Object.assign((()=>({arrayBuffers:0,rss:0,external:0,heapTotal:0,heapUsed:0})),{rss:()=>0});mainModule=void 0;domain=void 0;send=void 0;exitCode=void 0;channel=void 0;getegid=void 0;geteuid=void 0;getgid=void 0;getgroups=void 0;getuid=void 0;setegid=void 0;seteuid=void 0;setgid=void 0;setgroups=void 0;setuid=void 0;_events=void 0;_eventsCount=void 0;_exiting=void 0;_maxListeners=void 0;_debugEnd=void 0;_debugProcess=void 0;_fatalException=void 0;_getActiveHandles=void 0;_getActiveRequests=void 0;_kill=void 0;_preload_modules=void 0;_rawDebug=void 0;_startProfilerIdleNotifier=void 0;_stopProfilerIdleNotifier=void 0;_tickCallback=void 0;_disconnect=void 0;_handleQueue=void 0;_pendingMessage=void 0;_channel=void 0;_send=void 0;_linkedBinding=void 0}const $=Object.create(null),C=globalThis.process,_getEnv=s=>globalThis.__env__||C?.env||(s?$:globalThis),q=new Proxy($,{get:(s,o)=>_getEnv()[o]??$[o],has:(s,o)=>o in _getEnv()||o in $,set:(s,o,a)=>(_getEnv(!0)[o]=a,!0),deleteProperty:(s,o)=>(delete _getEnv(!0)[o],!0),ownKeys(){const s=_getEnv();return Object.keys(s)},getOwnPropertyDescriptor(s,o){const a=_getEnv();if(o in a)return{value:a[o],writable:!0,enumerable:!0,configurable:!0}}}),z=new Process({env:q,hrtime:Object.assign((function(s){const o=Date.now(),a=Math.trunc(o/1e3),c=o%1e3*1e6;if(s){let o=a-s[0],u=c-s[0];return u<0&&(o-=1,u=1e9+u),[o,u]}return[a,c]}),{bigint:function(){return BigInt(1e6*Date.now())}}),nextTick:o.nextTick});for(const s of["exit","getBuiltinModule","platform"])s in o&&(z[s]=o[s]);o.features&&Object.defineProperty(z,"features",{get:()=>o.features});const{abort:j,addListener:L,allowedNodeEnvironmentFlags:Q,hasUncaughtExceptionCaptureCallback:H,setUncaughtExceptionCaptureCallback:K,loadEnvFile:J,sourceMapsEnabled:Z,arch:X,argv:te,argv0:oe,chdir:ae,config:le,connected:ce,constrainedMemory:ue,availableMemory:de,cpuUsage:he,cwd:fe,debugPort:pe,dlopen:me,disconnect:ge,emit:ye,emitWarning:be,env:we,eventNames:Se,execArgv:xe,execPath:Ee,exit:Re,finalization:ke,features:ze,getBuiltinModule:Ie,getActiveResourcesInfo:Ne,getMaxListeners:Qe,hrtime:Be,kill:De,listeners:Me,listenerCount:Ke,memoryUsage:Ve,nextTick:Je,on:Ge,off:Ye,once:Ze,pid:Xe,platform:et,ppid:tt,prependListener:at,prependOnceListener:lt,rawListeners:ct,release:ut,removeAllListeners:ht,removeListener:pt,report:gt,resourceUsage:bt,setMaxListeners:wt,setSourceMapsEnabled:vt,stderr:St,stdin:xt,stdout:$t,title:_t,umask:Et,uptime:Rt,version:Tt,versions:At,domain:Ct,initgroups:qt,moduleLoadList:zt,reallyExit:Pt,openStdin:jt,assert:It,binding:Ot,send:Lt,exitCode:Nt,channel:Qt,getegid:Bt,geteuid:Ht,getgid:Vt,getgroups:Gt,getuid:Yt,setegid:Zt,seteuid:Xt,setgid:er,setgroups:tr,setuid:rr,permission:ir,mainModule:ar,_events:lr,_eventsCount:dr,_exiting:hr,_maxListeners:pr,_debugEnd:yr,_debugProcess:wr,_fatalException:vr,_getActiveHandles:Sr,_getActiveRequests:$r,_kill:_r,_preload_modules:Er,_rawDebug:Rr,_startProfilerIdleNotifier:Tr,_stopProfilerIdleNotifier:Ar,_tickCallback:Cr,_disconnect:kr,_handleQueue:qr,_pendingMessage:zr,_channel:Pr,_send:jr,_linkedBinding:Ir}=z,Or=globalThis.process;globalThis.process=Or?new Proxy(Or,{get:(s,o,a)=>Reflect.has(s,o)?Reflect.get(s,o,a):Reflect.get(z,o,a)}):z,globalThis.Buffer||(globalThis.Buffer=s),globalThis.setImmediate||(globalThis.setImmediate=c),globalThis.clearImmediate||(globalThis.clearImmediate=u);const Lr=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Qr=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Br=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(s,o){if(!("__proto__"===s||"constructor"===s&&o&&"object"==typeof o&&"prototype"in o))return o;!function(s){console.warn(`[destr] Dropping "${s}" key to prevent prototype pollution.`)}(s)}function destr(s,o={}){if("string"!=typeof s)return s;if('"'===s[0]&&'"'===s[s.length-1]&&-1===s.indexOf("\\"))return s.slice(1,-1);const a=s.trim();if(a.length<=9)switch(a.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!Br.test(s)){if(o.strict)throw new SyntaxError("[destr] Invalid JSON");return s}try{if(Lr.test(s)||Qr.test(s)){if(o.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(s,jsonParseTransform)}return JSON.parse(s)}catch(a){if(o.strict)throw a;return s}}const Dr=/#/g,Mr=/&/g,Hr=/\//g,Fr=/=/g,Ur=/\+/g,Kr=/%5e/gi,Wr=/%60/gi,Vr=/%7c/gi,Jr=/%20/gi;function encodeQueryValue(s){return function(s){return encodeURI(""+s).replace(Vr,"|")}("string"==typeof s?s:JSON.stringify(s)).replace(Ur,"%2B").replace(Jr,"+").replace(Dr,"%23").replace(Mr,"%26").replace(Wr,"`").replace(Kr,"^").replace(Hr,"%2F")}function encodeQueryKey(s){return encodeQueryValue(s).replace(Fr,"%3D")}function decode$1(s=""){try{return decodeURIComponent(""+s)}catch{return""+s}}function decodeQueryKey(s){return decode$1(s.replace(Ur," "))}function decodeQueryValue(s){return decode$1(s.replace(Ur," "))}function parseQuery(s=""){const o=Object.create(null);"?"===s[0]&&(s=s.slice(1));for(const a of s.split("&")){const s=a.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;const c=decodeQueryKey(s[1]);if("__proto__"===c||"constructor"===c)continue;const u=decodeQueryValue(s[2]||"");void 0===o[c]?o[c]=u:Array.isArray(o[c])?o[c].push(u):o[c]=[o[c],u]}return o}function stringifyQuery(s){return Object.keys(s).filter((o=>void 0!==s[o])).map((o=>{return a=o,"number"!=typeof(c=s[o])&&"boolean"!=typeof c||(c=String(c)),c?Array.isArray(c)?c.map((s=>`${encodeQueryKey(a)}=${encodeQueryValue(s)}`)).join("&"):`${encodeQueryKey(a)}=${encodeQueryValue(c)}`:encodeQueryKey(a);var a,c})).filter(Boolean).join("&")}const Gr=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Yr=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Zr=/^([/\\]\s*){2,}[^/\\]/,Xr=/^\.?\//;function hasProtocol(s,o={}){return"boolean"==typeof o&&(o={acceptRelative:o}),o.strict?Gr.test(s):Yr.test(s)||!!o.acceptRelative&&Zr.test(s)}function withoutTrailingSlash(s="",o){return(function(s=""){return s.endsWith("/")}(s)?s.slice(0,-1):s)||"/"}function withTrailingSlash(s="",o){return s.endsWith("/")?s:s+"/"}function withoutBase(s,o){if(isEmptyURL(o))return s;const a=withoutTrailingSlash(o);if(!s.startsWith(a))return s;const c=s.slice(a.length);return"/"===c[0]?c:"/"+c}function withQuery(s,o){const a=parseURL(s),c={...parseQuery(a.search),...o};return a.search=stringifyQuery(c),function(s){const o=s.pathname||"",a=s.search?(s.search.startsWith("?")?"":"?")+s.search:"",c=s.hash||"",u=s.auth?s.auth+"@":"",p=s.host||"",w=s.protocol||s[es]?(s.protocol||"")+"//":"";return w+u+p+o+a+c}(a)}function getQuery(s){return parseQuery(parseURL(s).search)}function isEmptyURL(s){return!s||"/"===s}function joinURL(s,...o){let a=s||"";for(const s of o.filter((s=>function(s){return s&&"/"!==s}(s))))if(a){const o=s.replace(Xr,"");a=withTrailingSlash(a)+o}else a=s;return a}const es=Symbol.for("ufo:protocolRelative");function parseURL(s="",o){const a=s.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(a){const[,s,o=""]=a;return{protocol:s.toLowerCase(),pathname:o,href:s+o,auth:"",host:"",search:"",hash:""}}if(!hasProtocol(s,{acceptRelative:!0}))return parsePath(s);const[,c="",u,p=""]=s.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,w="",v=""]=p.match(/([^#/?]*)(.*)?/)||[];"file:"===c&&(v=v.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:$,search:C,hash:q}=parsePath(v);return{protocol:c.toLowerCase(),auth:u?u.slice(0,Math.max(0,u.length-1)):"",host:w,pathname:$,search:C,hash:q,[es]:!c}}function parsePath(s=""){const[o="",a="",c=""]=(s.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:o,search:a,hash:c}}const ts=0,rs=1,ss=2;function createRouter$1(s={}){const o={options:s,rootNode:createRadixNode(),staticRoutesMap:{}},normalizeTrailingSlash=o=>s.strictTrailingSlash?o:o.replace(/\/$/,"")||"/";if(s.routes)for(const a in s.routes)insert(o,normalizeTrailingSlash(a),s.routes[a]);return{ctx:o,lookup:s=>function(s,o){const a=s.staticRoutesMap[o];if(a)return a.data;const c=o.split("/"),u={};let p=!1,w=null,v=s.rootNode,$=null;for(let s=0;s<c.length;s++){const o=c[s];null!==v.wildcardChildNode&&(w=v.wildcardChildNode,$=c.slice(s).join("/"));const a=v.children.get(o);if(void 0===a){if(v&&v.placeholderChildren.length>1){const o=c.length-s;v=v.placeholderChildren.find((s=>s.maxDepth===o))||null}else v=v.placeholderChildren[0]||null;if(!v)break;v.paramName&&(u[v.paramName]=o),p=!0}else v=a}null!==v&&null!==v.data||null===w||(v=w,u[v.paramName||"_"]=$,p=!0);if(!v)return null;if(p)return{...v.data,params:p?u:void 0};return v.data}(o,normalizeTrailingSlash(s)),insert:(s,a)=>insert(o,normalizeTrailingSlash(s),a),remove:s=>function(s,o){let a=!1;const c=o.split("/");let u=s.rootNode;for(const s of c)if(u=u.children.get(s),!u)return a;if(u.data){const s=c.at(-1)||"";u.data=null,0===Object.keys(u.children).length&&u.parent&&(u.parent.children.delete(s),u.parent.wildcardChildNode=null,u.parent.placeholderChildren=[]),a=!0}return a}(o,normalizeTrailingSlash(s))}}function insert(s,o,a){let c=!0;const u=o.split("/");let p=s.rootNode,w=0;const v=[p];for(const s of u){let o;if(o=p.children.get(s))p=o;else{const a=getNodeType(s);o=createRadixNode({type:a,parent:p}),p.children.set(s,o),a===ss?(o.paramName="*"===s?"_"+w++:s.slice(1),p.placeholderChildren.push(o),c=!1):a===rs&&(p.wildcardChildNode=o,o.paramName=s.slice(3)||"_",c=!1),v.push(o),p=o}}for(const[s,o]of v.entries())o.maxDepth=Math.max(v.length-s,o.maxDepth||0);return p.data=a,!0===c&&(s.staticRoutesMap[o]=p),p}function createRadixNode(s={}){return{type:s.type||ts,maxDepth:0,parent:s.parent||null,children:new Map,data:s.data||null,paramName:s.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function getNodeType(s){return s.startsWith("**")?rs:":"===s[0]||"*"===s?ss:ts}function toRouteMatcher(s){return function(s,o){return{ctx:{table:s},matchAll:a=>_matchRoutes(a,s,o)}}(_routerNodeToTable("",s.ctx.rootNode),s.ctx.options.strictTrailingSlash)}function _matchRoutes(s,o,a){!0!==a&&s.endsWith("/")&&(s=s.slice(0,-1)||"/");const c=[];for(const[a,u]of _sortRoutesMap(o.wildcard))(s===a||s.startsWith(a+"/"))&&c.push(u);for(const[a,u]of _sortRoutesMap(o.dynamic))if(s.startsWith(a+"/")){const o="/"+s.slice(a.length).split("/").splice(2).join("/");c.push(..._matchRoutes(o,u))}const u=o.static.get(s);return u&&c.push(u),c.filter(Boolean)}function _sortRoutesMap(s){return[...s.entries()].sort(((s,o)=>s[0].length-o[0].length))}function _routerNodeToTable(s,o){const a={static:new Map,wildcard:new Map,dynamic:new Map};return function _addNode(s,o){if(s)if(o.type!==ts||s.includes("*")||s.includes(":")){if(o.type===rs)a.wildcard.set(s.replace("/**",""),o.data);else if(o.type===ss){const c=_routerNodeToTable("",o);return o.data&&c.static.set("/",o.data),void a.dynamic.set(s.replace(/\/\*|\/:\w+/,""),c)}}else o.data&&a.static.set(s,o.data);for(const[a,c]of o.children.entries())_addNode(`${s}/${a}`.replace("//","/"),c)}(s,o),a}function isPlainObject(s){if(null===s||"object"!=typeof s)return!1;const o=Object.getPrototypeOf(s);return(null===o||o===Object.prototype||null===Object.getPrototypeOf(o))&&(!(Symbol.iterator in s)&&(!(Symbol.toStringTag in s)||"[object Module]"===Object.prototype.toString.call(s)))}function _defu(s,o,a=".",c){if(!isPlainObject(o))return _defu(s,{},a,c);const u=Object.assign({},o);for(const o in s){if("__proto__"===o||"constructor"===o)continue;const p=s[o];null!=p&&(c&&c(u,o,p,a)||(Array.isArray(p)&&Array.isArray(u[o])?u[o]=[...p,...u[o]]:isPlainObject(p)&&isPlainObject(u[o])?u[o]=_defu(p,u[o],(a?`${a}.`:"")+o.toString(),c):u[o]=p))}return u}function createDefu(s){return(...o)=>o.reduce(((o,a)=>_defu(o,a,"",s)),{})}const ns=createDefu(),os=createDefu(((s,o,a)=>{if(void 0!==s[o]&&"function"==typeof a)return s[o]=a(s[o]),!0})),as=globalThis.crypto,ls={randomUUID:()=>as.randomUUID(),getRandomValues:s=>as.getRandomValues(s),subtle:as.subtle};var cs={},us=Array.from({length:64});for(let s=0,o="A".charCodeAt(0),a="Z".charCodeAt(0);s+o<=a;s++){const a=String.fromCharCode(s+o);cs[a]=s,us[s]=a}for(let s=0,o="a".charCodeAt(0),a="z".charCodeAt(0);s+o<=a;s++){const a=String.fromCharCode(s+o),c=s+26;cs[a]=c,us[c]=a}for(let s=0;s<10;s++){cs[s.toString(10)]=s+52;const o=s.toString(10),a=s+52;cs[o]=a,us[a]=o}cs["-"]=62,us[62]="-",cs._=63,us[63]="_";var stringToBuffer=s=>(new TextEncoder).encode(s),base64urlDecode=s=>{const o=s+"=".repeat((4-s.length%4)%4);let a=o.length/4*3;o.endsWith("==")?a-=2:o.endsWith("=")&&a--;const c=new ArrayBuffer(a),u=new DataView(c);for(let s=0;s<o.length;s+=4){let a=0,c=0;for(let u=s,p=s+3;u<=p;u++)if("="===o[u])a>>=6;else{if(!(o[u]in cs))throw new TypeError(`Invalid character ${o[u]} in base64 string.`);a|=cs[o[u]]<<6*(p-u),c+=6}const p=s/4*3;a>>=c%8;const w=Math.floor(c/8);for(let s=0;s<w;s++){const o=8*(w-s-1);u.setUint8(p+s,(a&255<<o)>>o)}}return new Uint8Array(c)},base64urlEncode=s=>{const o="string"==typeof s?stringToBuffer(s):s;let a="";for(let s=0;s<o.length;s+=3){let c=0,u=0;for(let a=s,p=Math.min(s+3,o.length);a<p;a++)c|=o[a]<<8*(p-a-1),u+=8;const p=Math.ceil(u/6);c<<=6*p-u;for(let s=1;s<=p;s++){const o=6*(p-s);a+=us[(c&63<<o)>>o]}}return a},ds={encryption:{saltBits:256,algorithm:"aes-256-cbc",iterations:1,minPasswordlength:32},integrity:{saltBits:256,algorithm:"sha256",iterations:1,minPasswordlength:32},ttl:0,timestampSkewSec:60,localtimeOffsetMsec:0},clone=s=>({...s,encryption:{...s.encryption},integrity:{...s.integrity}}),hs={"aes-128-ctr":{keyBits:128,ivBits:128,name:"AES-CTR"},"aes-256-cbc":{keyBits:256,ivBits:128,name:"AES-CBC"},sha256:{keyBits:256,name:"SHA-256"}},fs="Fe26.2",randomBits=(s,o)=>{if(o<1)throw new Error("Invalid random bits count");return((s,o)=>{const a=new Uint8Array(o);return s.getRandomValues(a),a})(s,Math.ceil(o/8))},generateKey=async(s,o,a)=>{var c;if(!(null==o?void 0:o.length))throw new Error("Empty password");if(null==a||"object"!=typeof a)throw new Error("Bad options");if(!(a.algorithm in hs))throw new Error(`Unknown algorithm: ${a.algorithm}`);const u=hs[a.algorithm],p={},w=null!=(c=a.hmac)&&c,v=w?{name:"HMAC",hash:u.name}:{name:u.name},$=w?["sign","verify"]:["encrypt","decrypt"];if("string"==typeof o){if(o.length<a.minPasswordlength)throw new Error(`Password string too short (min ${a.minPasswordlength} characters required)`);let{salt:c=""}=a;if(!c){const{saltBits:o=0}=a;if(!o)throw new Error("Missing salt and saltBits options");const u=randomBits(s,o);c=[...new Uint8Array(u)].map((s=>s.toString(16).padStart(2,"0"))).join("")}const w=await(async(s,o,a,c,u,p)=>{const w=stringToBuffer(o),v=await s.subtle.importKey("raw",w,{name:"PBKDF2"},!1,["deriveBits"]),$={name:"PBKDF2",hash:p,salt:stringToBuffer(a),iterations:c};return await s.subtle.deriveBits($,v,8*u)})(s,o,c,a.iterations,u.keyBits/8,"SHA-1"),C=await s.subtle.importKey("raw",w,v,!1,$);p.key=C,p.salt=c}else{if(o.length<u.keyBits/8)throw new Error("Key buffer (password) too small");p.key=await s.subtle.importKey("raw",o,v,!1,$),p.salt=""}return a.iv?p.iv=a.iv:"ivBits"in u&&(p.iv=randomBits(s,u.ivBits)),p},getEncryptParams=(s,o,a)=>["aes-128-ctr"===s?{name:"AES-CTR",counter:o.iv,length:128}:{name:"AES-CBC",iv:o.iv},o.key,"string"==typeof a?stringToBuffer(a):a],decrypt=async(s,o,a,c)=>{const u=await generateKey(s,o,a),p=await s.subtle.decrypt(...getEncryptParams(a.algorithm,u,c));return w=new Uint8Array(p),(new TextDecoder).decode(w);var w},hmacWithPassword=async(s,o,a,c)=>{const u=await generateKey(s,o,{...a,hmac:!0}),p=stringToBuffer(c),w=await s.subtle.sign({name:"HMAC"},u.key,p);return{digest:base64urlEncode(new Uint8Array(w)),salt:u.salt}},normalizePassword=s=>"string"==typeof s||s instanceof Uint8Array?{encryption:s,integrity:s}:"secret"in s?{id:s.id,encryption:s.secret,integrity:s.secret}:{id:s.id,encryption:s.encryption,integrity:s.integrity},seal=async(s,o,a,c)=>{if(!a)throw new Error("Empty password");const u=clone(c),p=Date.now()+(u.localtimeOffsetMsec||0),w=JSON.stringify(o),v=normalizePassword(a),{id:$="",encryption:C,integrity:q}=v;if($&&!/^\w+$/.test($))throw new Error("Invalid password id");const{encrypted:z,key:j}=await(async(s,o,a,c)=>{const u=await generateKey(s,o,a),p=await s.subtle.encrypt(...getEncryptParams(a.algorithm,u,c));return{encrypted:new Uint8Array(p),key:u}})(s,C,u.encryption,w),L=base64urlEncode(new Uint8Array(z)),Q=base64urlEncode(j.iv),H=u.ttl?p+u.ttl:"",K=`${fs}*${$}*${j.salt}*${Q}*${L}*${H}`,J=await hmacWithPassword(s,q,u.integrity,K);return`${K}*${J.salt}*${J.digest}`};function o$1(s){throw new Error(`${s} is not implemented yet!`)}let ps=class i extends a{__unenv__={};readableEncoding=null;readableEnded=!0;readableFlowing=!1;readableHighWaterMark=0;readableLength=0;readableObjectMode=!1;readableAborted=!1;readableDidRead=!1;closed=!1;errored=null;readable=!1;destroyed=!1;static from(s,o){return new i(o)}constructor(s){super()}_read(s){}read(s){}setEncoding(s){return this}pause(){return this}resume(){return this}isPaused(){return!0}unpipe(s){return this}unshift(s,o){}wrap(s){return this}push(s,o){return!1}_destroy(s,o){this.removeAllListeners()}destroy(s){return this.destroyed=!0,this._destroy(s),this}pipe(s,o){return{}}compose(s,o){throw new Error("Method not implemented.")}[Symbol.asyncDispose](){return this.destroy(),Promise.resolve()}async*[Symbol.asyncIterator](){throw o$1("Readable.asyncIterator")}iterator(s){throw o$1("Readable.iterator")}map(s,o){throw o$1("Readable.map")}filter(s,o){throw o$1("Readable.filter")}forEach(s,o){throw o$1("Readable.forEach")}reduce(s,o,a){throw o$1("Readable.reduce")}find(s,o){throw o$1("Readable.find")}findIndex(s,o){throw o$1("Readable.findIndex")}some(s,o){throw o$1("Readable.some")}toArray(s){throw o$1("Readable.toArray")}every(s,o){throw o$1("Readable.every")}flatMap(s,o){throw o$1("Readable.flatMap")}drop(s,o){throw o$1("Readable.drop")}take(s,o){throw o$1("Readable.take")}asIndexedPairs(s){throw o$1("Readable.asIndexedPairs")}},ms=class extends a{__unenv__={};writable=!0;writableEnded=!1;writableFinished=!1;writableHighWaterMark=0;writableLength=0;writableObjectMode=!1;writableCorked=0;closed=!1;errored=null;writableNeedDrain=!1;destroyed=!1;_data;_encoding="utf8";constructor(s){super()}pipe(s,o){return{}}_write(o,a,c){if(this.writableEnded)c&&c();else{if(void 0===this._data)this._data=o;else{const c="string"==typeof this._data?s.from(this._data,this._encoding||a||"utf8"):this._data,u="string"==typeof o?s.from(o,a||this._encoding||"utf8"):o;this._data=s.concat([c,u])}this._encoding=a,c&&c()}}_writev(s,o){}_destroy(s,o){}_final(s){}write(s,o,a){const c="string"==typeof o?this._encoding:"utf8",u="function"==typeof o?o:"function"==typeof a?a:void 0;return this._write(s,c,u),!0}setDefaultEncoding(s){return this}end(s,o,a){const c="function"==typeof s?s:"function"==typeof o?o:"function"==typeof a?a:void 0;if(this.writableEnded)return c&&c(),this;const u=s===c?void 0:s;if(u){const s=o===c?void 0:o;this.write(u,s,c)}return this.writableEnded=!0,this.writableFinished=!0,this.emit("close"),this.emit("finish"),this}cork(){}uncork(){}destroy(s){return this.destroyed=!0,delete this._data,this.removeAllListeners(),this}compose(s,o){throw new Error("Method not implemented.")}};const gs=class{allowHalfOpen=!0;_destroy;constructor(s=new ps,o=new ms){Object.assign(this,s),Object.assign(this,o),this._destroy=function(...s){return function(...o){for(const a of s)a(...o)}}(s._destroy,o._destroy)}};const ys=(Object.assign(gs.prototype,ps.prototype),Object.assign(gs.prototype,ms.prototype),gs);let bs=class extends ys{__unenv__={};bufferSize=0;bytesRead=0;bytesWritten=0;connecting=!1;destroyed=!1;pending=!1;localAddress="";localPort=0;remoteAddress="";remoteFamily="";remotePort=0;autoSelectFamilyAttemptedAddresses=[];readyState="readOnly";constructor(s){super()}write(s,o,a){return!1}connect(s,o,a){return this}end(s,o,a){return this}setEncoding(s){return this}pause(){return this}resume(){return this}setTimeout(s,o){return this}setNoDelay(s){return this}setKeepAlive(s,o){return this}address(){return{}}unref(){return this}ref(){return this}destroySoon(){this.destroy()}resetAndDestroy(){const s=new Error("ERR_SOCKET_CLOSED");return s.code="ERR_SOCKET_CLOSED",this.destroy(s),this}},ws=class extends ps{aborted=!1;httpVersion="1.1";httpVersionMajor=1;httpVersionMinor=1;complete=!0;connection;socket;headers={};trailers={};method="GET";url="/";statusCode=200;statusMessage="";closed=!1;errored=null;readable=!1;constructor(s){super(),this.socket=this.connection=s||new bs}get rawHeaders(){const s=this.headers,o=[];for(const a in s)if(Array.isArray(s[a]))for(const c of s[a])o.push(a,c);else o.push(a,s[a]);return o}get rawTrailers(){return[]}setTimeout(s,o){return this}get headersDistinct(){return p$1(this.headers)}get trailersDistinct(){return p$1(this.trailers)}};function p$1(s){const o={};for(const[a,c]of Object.entries(s))a&&(o[a]=(Array.isArray(c)?c:[c]).filter(Boolean));return o}let vs=class extends ms{statusCode=200;statusMessage="";upgrading=!1;chunkedEncoding=!1;shouldKeepAlive=!1;useChunkedEncodingByDefault=!1;sendDate=!1;finished=!1;headersSent=!1;strictContentLength=!1;connection=null;socket=null;req;_headers={};constructor(s){super(),this.req=s}assignSocket(s){s._httpMessage=this,this.socket=s,this.connection=s,this.emit("socket",s),this._flush()}_flush(){this.flushHeaders()}detachSocket(s){}writeContinue(s){}writeHead(s,o,a){s&&(this.statusCode=s),"string"==typeof o&&(this.statusMessage=o,o=void 0);const c=a||o;if(c&&!Array.isArray(c))for(const s in c)this.setHeader(s,c[s]);return this.headersSent=!0,this}writeProcessing(){}setTimeout(s,o){return this}appendHeader(s,o){s=s.toLowerCase();const a=this._headers[s],c=[...Array.isArray(a)?a:[a],...Array.isArray(o)?o:[o]].filter(Boolean);return this._headers[s]=c.length>1?c:c[0],this}setHeader(s,o){return this._headers[s.toLowerCase()]=o,this}setHeaders(s){for(const[o,a]of Object.entries(s))this.setHeader(o,a);return this}getHeader(s){return this._headers[s.toLowerCase()]}getHeaders(){return this._headers}getHeaderNames(){return Object.keys(this._headers)}hasHeader(s){return s.toLowerCase()in this._headers}removeHeader(s){delete this._headers[s.toLowerCase()]}addTrailers(s){}flushHeaders(){}writeEarlyHints(s,o){"function"==typeof o&&o()}};const Ss=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function S$2(s={}){if(s instanceof Headers)return s;const o=new Headers;for(const[a,c]of Object.entries(s))if(void 0!==c){if(Array.isArray(c)){for(const s of c)o.append(a,String(s));continue}o.set(a,String(c))}return o}const xs=new Set([101,204,205,304]);async function b(s,o){const a=new ws,c=new vs(a);let u;if(a.url=o.url?.toString()||"/",!a.url.startsWith("/")){const s=new URL(a.url);u=s.host,a.url=s.pathname+s.search+s.hash}a.method=o.method||"GET",a.headers=function(s={}){const o=new Ss,a=Array.isArray(s)||function(s){return"function"==typeof s?.entries}(s)?s:Object.entries(s);for(const[s,c]of a)if(c){if(void 0===o[s]){o[s]=c;continue}o[s]=[...Array.isArray(o[s])?o[s]:[o[s]],...Array.isArray(c)?c:[c]]}return o}(o.headers||{}),a.headers.host||(a.headers.host=o.host||u||"localhost"),a.connection.encrypted=a.connection.encrypted||"https"===o.protocol,a.body=o.body||null,a.__unenv__=o.context,await s(a,c);let p=c._data;(xs.has(c.statusCode)||"HEAD"===a.method.toUpperCase())&&(p=null,delete c._headers["content-length"]);const w={status:c.statusCode,statusText:c.statusMessage,headers:c._headers,body:p};return a.destroy(),c.destroy(),w}function hasProp$1(s,o){try{return o in s}catch{return!1}}let $s=class extends Error{static __h3_error__=!0;statusCode=500;fatal=!1;unhandled=!1;statusMessage;data;cause;constructor(s,o={}){super(s,o),o.cause&&!this.cause&&(this.cause=o.cause)}toJSON(){const s={message:this.message,statusCode:sanitizeStatusCode$1(this.statusCode,500)};return this.statusMessage&&(s.statusMessage=sanitizeStatusMessage$1(this.statusMessage)),void 0!==this.data&&(s.data=this.data),s}};function createError$1(s){if("string"==typeof s)return new $s(s);if(isError$1(s))return s;const o=new $s(s.message??s.statusMessage??"",{cause:s.cause||s});if(hasProp$1(s,"stack"))try{Object.defineProperty(o,"stack",{get:()=>s.stack})}catch{try{o.stack=s.stack}catch{}}if(s.data&&(o.data=s.data),s.statusCode?o.statusCode=sanitizeStatusCode$1(s.statusCode,o.statusCode):s.status&&(o.statusCode=sanitizeStatusCode$1(s.status,o.statusCode)),s.statusMessage?o.statusMessage=s.statusMessage:s.statusText&&(o.statusMessage=s.statusText),o.statusMessage){const s=o.statusMessage;sanitizeStatusMessage$1(o.statusMessage)!==s&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return void 0!==s.fatal&&(o.fatal=s.fatal),void 0!==s.unhandled&&(o.unhandled=s.unhandled),o}function isError$1(s){return!0===s?.constructor?.__h3_error__}const _s=Symbol.for("h3RawBody"),Es=["PATCH","POST","PUT","DELETE"];function readRawBody$1(o,a="utf8"){!function(s,o){if(!function(s,o){if("string"==typeof o){if(s.method===o)return!0}else if(o.includes(s.method))return!0;return!1}(s,o))throw createError$1({statusCode:405,statusMessage:"HTTP method is not allowed."})}(o,Es);const c=o._requestBody||o.web?.request?.body||o.node.req[_s]||o.node.req.rawBody||o.node.req.body;if(c){const o=Promise.resolve(c).then((o=>s.isBuffer(o)?o:"function"==typeof o.pipeTo?new Promise(((a,c)=>{const u=[];o.pipeTo(new WritableStream({write(s){u.push(s)},close(){a(s.concat(u))},abort(s){c(s)}})).catch(c)})):"function"==typeof o.pipe?new Promise(((a,c)=>{const u=[];o.on("data",(s=>{u.push(s)})).on("end",(()=>{a(s.concat(u))})).on("error",c)})):o.constructor===Object?s.from(JSON.stringify(o)):o instanceof URLSearchParams?s.from(o.toString()):o instanceof FormData?new Response(o).bytes().then((o=>s.from(o))):s.from(o)));return a?o.then((s=>s.toString(a))):o}if(!Number.parseInt(o.node.req.headers["content-length"]||"")&&!String(o.node.req.headers["transfer-encoding"]??"").split(",").map((s=>s.trim())).filter(Boolean).includes("chunked"))return Promise.resolve(void 0);const u=o.node.req[_s]=new Promise(((a,c)=>{const u=[];o.node.req.on("error",(s=>{c(s)})).on("data",(s=>{u.push(s)})).on("end",(()=>{a(s.concat(u))}))}));return a?u.then((s=>s.toString(a))):u}function handleCacheHeaders(s,o){const a=["public",...o.cacheControls||[]];let c=!1;if(void 0!==o.maxAge&&a.push("max-age="+ +o.maxAge,"s-maxage="+ +o.maxAge),o.modifiedTime){const a=new Date(o.modifiedTime),u=s.node.req.headers["if-modified-since"];s.node.res.setHeader("last-modified",a.toUTCString()),u&&new Date(u)>=a&&(c=!0)}if(o.etag){s.node.res.setHeader("etag",o.etag);s.node.req.headers["if-none-match"]===o.etag&&(c=!0)}return s.node.res.setHeader("cache-control",a.join(", ")),!!c&&(s.node.res.statusCode=304,s.handled||s.node.res.end(),!0)}const Rs={html:"text/html",json:"application/json"},Ts=/[^\u0009\u0020-\u007E]/g;function sanitizeStatusMessage$1(s=""){return s.replace(Ts,"")}function sanitizeStatusCode$1(s,o=200){return s?("string"==typeof s&&(s=Number.parseInt(s,10)),s<100||s>999?o:s):o}function splitCookiesString$1(s){if(Array.isArray(s))return s.flatMap((s=>splitCookiesString$1(s)));if("string"!=typeof s)return[];const o=[];let a,c,u,p,w,v=0;const skipWhitespace=()=>{for(;v<s.length&&/\s/.test(s.charAt(v));)v+=1;return v<s.length};for(;v<s.length;){for(a=v,w=!1;skipWhitespace();)if(c=s.charAt(v),","===c){for(u=v,v+=1,skipWhitespace(),p=v;v<s.length&&(c=s.charAt(v),"="!==c&&";"!==c&&","!==c);)v+=1;v<s.length&&"="===s.charAt(v)?(w=!0,v=p,o.push(s.slice(a,u)),a=v):v=u+1}else v+=1;(!w||v>=s.length)&&o.push(s.slice(a))}return o}const As=void 0===c?s=>s():c;function send$1(s,o,a){return a&&function(s,o){o&&304!==s.node.res.statusCode&&!s.node.res.getHeader("content-type")&&s.node.res.setHeader("content-type",o)}(s,a),new Promise((a=>{As((()=>{s.handled||s.node.res.end(o),a()}))}))}function setResponseStatus$1(s,o,a){o&&(s.node.res.statusCode=sanitizeStatusCode$1(o,s.node.res.statusCode)),a&&(s.node.res.statusMessage=sanitizeStatusMessage$1(a))}function setResponseHeaders(s,o){for(const[a,c]of Object.entries(o))s.node.res.setHeader(a,c)}const Cs=setResponseHeaders;function sendStream$1(s,o){if(!o||"object"!=typeof o)throw new Error("[h3] Invalid stream provided.");if(s.node.res._data=o,!s.node.res.socket)return s._handled=!0,Promise.resolve();if(hasProp$1(o,"pipeTo")&&"function"==typeof o.pipeTo)return o.pipeTo(new WritableStream({write(o){s.node.res.write(o)}})).then((()=>{s.node.res.end()}));if(hasProp$1(o,"pipe")&&"function"==typeof o.pipe)return new Promise(((a,c)=>{o.pipe(s.node.res),o.on&&(o.on("end",(()=>{s.node.res.end(),a()})),o.on("error",(s=>{c(s)}))),s.node.res.on("close",(()=>{o.abort&&o.abort()}))}));throw new Error("[h3] Invalid or incompatible stream provided.")}function sendWebResponse$1(s,o){for(const[a,c]of o.headers)"set-cookie"===a?s.node.res.appendHeader(a,splitCookiesString$1(c)):s.node.res.setHeader(a,c);if(o.status&&(s.node.res.statusCode=sanitizeStatusCode$1(o.status,s.node.res.statusCode)),o.statusText&&(s.node.res.statusMessage=sanitizeStatusMessage$1(o.statusText)),o.redirected&&s.node.res.setHeader("location",o.url),o.body)return sendStream$1(s,o.body);s.node.res.end()}const ks=new Set(["PATCH","POST","PUT","DELETE"]),qs=new Set(["transfer-encoding","accept-encoding","connection","keep-alive","upgrade","expect","host","accept"]);async function proxyRequest(s,o,a={}){let c,u;ks.has(s.method)&&(a.streamRequest?(c=function(s){if(!Es.includes(s.method))return;const o=s.web?.request?.body||s._requestBody;return o||(_s in s.node.req||"rawBody"in s.node.req||"body"in s.node.req||"__unenv__"in s.node.req?new ReadableStream({async start(o){const a=await readRawBody$1(s,!1);a&&o.enqueue(a),o.close()}}):new ReadableStream({start:o=>{s.node.req.on("data",(s=>{o.enqueue(s)})),s.node.req.on("end",(()=>{o.close()})),s.node.req.on("error",(s=>{o.error(s)}))}}))}(s),u="half"):c=await readRawBody$1(s,!1).catch((()=>{})));const p=a.fetchOptions?.method||s.method,w=function(s,...o){const a=o.filter(Boolean);if(0===a.length)return s;const c=new Headers(s);for(const s of a){const o=Array.isArray(s)?s:"function"==typeof s.entries?s.entries():Object.entries(s);for(const[s,a]of o)void 0!==a&&c.set(s,a)}return c}(getProxyRequestHeaders(s,{host:o.startsWith("/")}),a.fetchOptions?.headers,a.headers);return async function(s,o,a={}){let c;try{c=await _getFetch(a.fetch)(o,{headers:a.headers,ignoreResponseError:!0,...a.fetchOptions})}catch(s){throw createError$1({status:502,statusMessage:"Bad Gateway",cause:s})}s.node.res.statusCode=sanitizeStatusCode$1(c.status,s.node.res.statusCode),s.node.res.statusMessage=sanitizeStatusMessage$1(c.statusText);const u=[];for(const[o,a]of c.headers.entries())"content-encoding"!==o&&"content-length"!==o&&("set-cookie"!==o?s.node.res.setHeader(o,a):u.push(...splitCookiesString$1(a)));u.length>0&&s.node.res.setHeader("set-cookie",u.map((s=>(a.cookieDomainRewrite&&(s=rewriteCookieProperty(s,a.cookieDomainRewrite,"domain")),a.cookiePathRewrite&&(s=rewriteCookieProperty(s,a.cookiePathRewrite,"path")),s))));a.onResponse&&await a.onResponse(s,c);if(void 0!==c._data)return c._data;if(s.handled)return;if(!1===a.sendStream){const o=new Uint8Array(await c.arrayBuffer());return s.node.res.end(o)}if(c.body)for await(const o of c.body)s.node.res.write(o);return s.node.res.end()}(s,o,{...a,fetchOptions:{method:p,body:c,duplex:u,...a.fetchOptions,headers:w}})}function getProxyRequestHeaders(s,o){const a=Object.create(null),c=function(s){const o={};for(const a in s.node.req.headers){const c=s.node.req.headers[a];o[a]=Array.isArray(c)?c.filter(Boolean).join(", "):c}return o}(s);for(const s in c)(!qs.has(s)||"host"===s&&o?.host)&&(a[s]=c[s]);return a}function fetchWithEvent(s,o,a,c){return _getFetch(c?.fetch)(o,{...a,context:a?.context||s.context,headers:{...getProxyRequestHeaders(s,{host:"string"==typeof o&&o.startsWith("/")}),...a?.headers}})}function _getFetch(s){if(s)return s;if(globalThis.fetch)return globalThis.fetch;throw new Error("fetch is not available. Try importing `node-fetch-native/polyfill` for Node.js.")}function rewriteCookieProperty(s,o,a){const c="string"==typeof o?{"*":o}:o;return s.replace(new RegExp(`(;\\s*${a}=)([^;]+)`,"gi"),((s,o,a)=>{let u;if(a in c)u=c[a];else{if(!("*"in c))return s;u=c["*"]}return u?o+u:""}))}let zs=class{__is_event__=!0;node;web;context={};_method;_path;_headers;_requestBody;_handled=!1;_onBeforeResponseCalled;_onAfterResponseCalled;constructor(s,o){this.node={req:s,res:o}}get method(){return this._method||(this._method=(this.node.req.method||"GET").toUpperCase()),this._method}get path(){return this._path||this.node.req.url||"/"}get headers(){return this._headers||(this._headers=function(s){const o=new Headers;for(const[a,c]of Object.entries(s))if(Array.isArray(c))for(const s of c)o.append(a,s);else c&&o.set(a,c);return o}(this.node.req.headers)),this._headers}get handled(){return this._handled||this.node.res.writableEnded||this.node.res.headersSent}respondWith(s){return Promise.resolve(s).then((s=>sendWebResponse$1(this,s)))}toString(){return`[${this.method}] ${this.path}`}toJSON(){return this.toString()}get req(){return this.node.req}get res(){return this.node.res}};function isEvent$1(s){return hasProp$1(s,"__is_event__")}function createEvent(s,o){return new zs(s,o)}function defineEventHandler$1(s){if("function"==typeof s)return s.__is_handler__=!0,s;const o={onRequest:_normalizeArray$1(s.onRequest),onBeforeResponse:_normalizeArray$1(s.onBeforeResponse)},_handler=a=>async function(s,o,a){if(a.onRequest)for(const o of a.onRequest)if(await o(s),s.handled)return;const c=await o(s),u={body:c};if(a.onBeforeResponse)for(const o of a.onBeforeResponse)await o(s,u);return u.body}(a,s.handler,o);return _handler.__is_handler__=!0,_handler.__resolve__=s.handler.__resolve__,_handler.__websocket__=s.websocket,_handler}function _normalizeArray$1(s){return s?Array.isArray(s)?s:[s]:void 0}const Ps=defineEventHandler$1;function isEventHandler(s){return hasProp$1(s,"__is_handler__")}function toEventHandler(s,o,a){return isEventHandler(s)||console.warn("[h3] Implicit event handler conversion is deprecated. Use `eventHandler()` or `fromNodeMiddleware()` to define event handlers.",a&&"/"!==a?`\n     Route: ${a}`:"",`\n     Handler: ${s}`),s}const lazyEventHandler=function(s){let o,a;const resolveHandler=()=>a?Promise.resolve(a):(o||(o=Promise.resolve(s()).then((s=>{const o=s.default||s;if("function"!=typeof o)throw new TypeError("Invalid lazy handler result. It should be a function:",o);return a={handler:toEventHandler(s.default||s)},a}))),o),c=Ps((s=>a?a.handler(s):resolveHandler().then((o=>o.handler(s)))));return c.__resolve__=resolveHandler,c};function createApp(s={}){const o=[],a=function(s,o){const a=o.debug?2:void 0;return Ps((async c=>{c.node.req.originalUrl=c.node.req.originalUrl||c.node.req.url||"/";const u=c._path||c.node.req.url||"/";let p;o.onRequest&&await o.onRequest(c);for(const w of s){if(w.route.length>1){if(!u.startsWith(w.route))continue;p=u.slice(w.route.length)||"/"}else p=u;if(w.match&&!w.match(p,c))continue;c._path=p,c.node.req.url=p;const s=await w.handler(c),v=void 0===s?void 0:await s;if(void 0!==v){const s={body:v};return o.onBeforeResponse&&(c._onBeforeResponseCalled=!0,await o.onBeforeResponse(c,s)),await handleHandlerResponse(c,s.body,a),void(o.onAfterResponse&&(c._onAfterResponseCalled=!0,await o.onAfterResponse(c,s)))}if(c.handled)return void(o.onAfterResponse&&(c._onAfterResponseCalled=!0,await o.onAfterResponse(c,void 0)))}if(!c.handled)throw createError$1({statusCode:404,statusMessage:`Cannot find any path matching ${c.path||"/"}.`});o.onAfterResponse&&(c._onAfterResponseCalled=!0,await o.onAfterResponse(c,void 0))}))}(o,s),c=function(s){return async o=>{let a;for(const c of s){if("/"===c.route&&!c.handler.__resolve__)continue;if(!o.startsWith(c.route))continue;if(a=o.slice(c.route.length)||"/",c.match&&!c.match(a,void 0))continue;let s={route:c.route,handler:c.handler};if(s.handler.__resolve__){const o=await s.handler.__resolve__(a);if(!o)continue;s={...s,...o,route:joinURL(s.route||"/",o.route||"/")}}return s}}}(o);a.__resolve__=c;const u=function(s){let o;return()=>(o||(o=s()),o)}((()=>{return o=c,{...s.websocket,async resolve(s){const a=s.request?.url||s.url||"/",{pathname:c}="string"==typeof a?parseURL(a):a,u=await o(c);return u?.handler?.__websocket__||{}}};var o})),p={use:(s,o,a)=>use(p,s,o,a),resolve:c,handler:a,stack:o,options:s,get websocket(){return u()}};return p}function use(s,o,a,c){if(Array.isArray(o))for(const u of o)use(s,u,a,c);else if(Array.isArray(a))for(const u of a)use(s,o,u,c);else"string"==typeof o?s.stack.push(normalizeLayer({...c,route:o,handler:a})):"function"==typeof o?s.stack.push(normalizeLayer({...a,handler:o})):s.stack.push(normalizeLayer({...o}));return s}function normalizeLayer(s){let o=s.handler;return o.handler&&(o=o.handler),s.lazy?o=lazyEventHandler(o):isEventHandler(o)||(o=toEventHandler(o,0,s.route)),{route:withoutTrailingSlash(s.route),match:s.match,handler:o}}function handleHandlerResponse(o,a,c){if(null===a)return function(s,o){if(s.handled)return;o||200===s.node.res.statusCode||(o=s.node.res.statusCode);const a=sanitizeStatusCode$1(o,204);204===a&&s.node.res.removeHeader("content-length"),s.node.res.writeHead(a),s.node.res.end()}(o);if(a){if(u=a,"undefined"!=typeof Response&&u instanceof Response)return sendWebResponse$1(o,a);if(function(s){if(!s||"object"!=typeof s)return!1;if("function"==typeof s.pipe){if("function"==typeof s._read)return!0;if("function"==typeof s.abort)return!0}return"function"==typeof s.pipeTo}(a))return sendStream$1(o,a);if(a.buffer)return send$1(o,a);if(a.arrayBuffer&&"function"==typeof a.arrayBuffer)return a.arrayBuffer().then((c=>send$1(o,s.from(c),a.type)));if(a instanceof Error)throw createError$1(a);if("function"==typeof a.end)return!0}var u;const p=typeof a;if("string"===p)return send$1(o,a,Rs.html);if("object"===p||"boolean"===p||"number"===p)return send$1(o,JSON.stringify(a,void 0,c),Rs.json);if("bigint"===p)return send$1(o,a.toString(),Rs.json);throw createError$1({statusCode:500,statusMessage:`[h3] Cannot send ${p} as response.`})}const js=["connect","delete","get","head","options","post","put","trace","patch"];function toNodeListener(s){return async function(o,a){const c=createEvent(o,a);try{await s.handler(c)}catch(o){const a=createError$1(o);if(isError$1(o)||(a.unhandled=!0),setResponseStatus$1(c,a.statusCode,a.statusMessage),s.options.onError&&await s.options.onError(a,c),c.handled)return;(a.unhandled||a.fatal)&&console.error("[h3]",a.fatal?"[fatal]":"[unhandled]",a),s.options.onBeforeResponse&&!c._onBeforeResponseCalled&&await s.options.onBeforeResponse(c,{body:a}),await function(s,o,a){if(s.handled)return;const c=isError$1(o)?o:createError$1(o),u={statusCode:c.statusCode,statusMessage:c.statusMessage,stack:[],data:c.data};if(a&&(u.stack=(c.stack||"").split("\n").map((s=>s.trim()))),s.handled)return;setResponseStatus$1(s,Number.parseInt(c.statusCode),c.statusMessage),s.node.res.setHeader("content-type",Rs.json),s.node.res.end(JSON.stringify(u,void 0,2))}(c,a,!!s.options.debug),s.options.onAfterResponse&&!c._onAfterResponseCalled&&await s.options.onAfterResponse(c,{body:a})}}}function flatHooks(s,o={},a){for(const c in s){const u=s[c],p=a?`${a}:${c}`:c;"object"==typeof u&&null!==u?flatHooks(u,o,p):"function"==typeof u&&(o[p]=u)}return o}const Is={run:s=>s()},Os=void 0!==console.createTask?console.createTask:()=>Is;function serialTaskCaller(s,o){const a=o.shift(),c=Os(a);return s.reduce(((s,a)=>s.then((()=>c.run((()=>a(...o)))))),Promise.resolve())}function parallelTaskCaller(s,o){const a=o.shift(),c=Os(a);return Promise.all(s.map((s=>c.run((()=>s(...o))))))}function callEachWith(s,o){for(const a of[...s])a(o)}class Hookable{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(s,o,a={}){if(!s||"function"!=typeof o)return()=>{};const c=s;let u;for(;this._deprecatedHooks[s];)u=this._deprecatedHooks[s],s=u.to;if(u&&!a.allowDeprecated){let s=u.message;s||(s=`${c} hook has been deprecated`+(u.to?`, please use ${u.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(s)||(console.warn(s),this._deprecatedMessages.add(s))}if(!o.name)try{Object.defineProperty(o,"name",{get:()=>"_"+s.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[s]=this._hooks[s]||[],this._hooks[s].push(o),()=>{o&&(this.removeHook(s,o),o=void 0)}}hookOnce(s,o){let a,_function=(...s)=>("function"==typeof a&&a(),a=void 0,_function=void 0,o(...s));return a=this.hook(s,_function),a}removeHook(s,o){if(this._hooks[s]){const a=this._hooks[s].indexOf(o);-1!==a&&this._hooks[s].splice(a,1),0===this._hooks[s].length&&delete this._hooks[s]}}deprecateHook(s,o){this._deprecatedHooks[s]="string"==typeof o?{to:o}:o;const a=this._hooks[s]||[];delete this._hooks[s];for(const o of a)this.hook(s,o)}deprecateHooks(s){Object.assign(this._deprecatedHooks,s);for(const o in s)this.deprecateHook(o,s[o])}addHooks(s){const o=flatHooks(s),a=Object.keys(o).map((s=>this.hook(s,o[s])));return()=>{for(const s of a.splice(0,a.length))s()}}removeHooks(s){const o=flatHooks(s);for(const s in o)this.removeHook(s,o[s])}removeAllHooks(){for(const s in this._hooks)delete this._hooks[s]}callHook(s,...o){return o.unshift(s),this.callHookWith(serialTaskCaller,s,...o)}callHookParallel(s,...o){return o.unshift(s),this.callHookWith(parallelTaskCaller,s,...o)}callHookWith(s,o,...a){const c=this._before||this._after?{name:o,args:a,context:{}}:void 0;this._before&&callEachWith(this._before,c);const u=s(o in this._hooks?[...this._hooks[o]]:[],a);return u instanceof Promise?u.finally((()=>{this._after&&c&&callEachWith(this._after,c)})):(this._after&&c&&callEachWith(this._after,c),u)}beforeEach(s){return this._before=this._before||[],this._before.push(s),()=>{if(void 0!==this._before){const o=this._before.indexOf(s);-1!==o&&this._before.splice(o,1)}}}afterEach(s){return this._after=this._after||[],this._after.push(s),()=>{if(void 0!==this._after){const o=this._after.indexOf(s);-1!==o&&this._after.splice(o,1)}}}}const Ls=globalThis;class FetchError extends Error{constructor(s,o){super(s,o),this.name="FetchError",o?.cause&&!this.cause&&(this.cause=o.cause)}}const Ns=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function isPayloadMethod(s="GET"){return Ns.has(s.toUpperCase())}const Qs=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Bs=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function resolveFetchOptions(s,o,a,c){const u=function(s,o,a){if(!o)return new a(s);const c=new a(o);if(s)for(const[o,u]of Symbol.iterator in s||Array.isArray(s)?s:new a(s))c.set(o,u);return c}(o?.headers??s?.headers,a?.headers,c);let p;return(a?.query||a?.params||o?.params||o?.query)&&(p={...a?.params,...a?.query,...o?.params,...o?.query}),{...a,...o,query:p,params:p,headers:u}}async function callHooks(s,o){if(o)if(Array.isArray(o))for(const a of o)await a(s);else await o(s)}const Ds=new Set([408,409,425,429,500,502,503,504]),Ms=new Set([101,204,205,304]);function createFetch(s={}){const{fetch:o=globalThis.fetch,Headers:a=globalThis.Headers,AbortController:c=globalThis.AbortController}=s;async function onError(s){const o=s.error&&"AbortError"===s.error.name&&!s.options.timeout||!1;if(!1!==s.options.retry&&!o){let o;o="number"==typeof s.options.retry?s.options.retry:isPayloadMethod(s.options.method)?0:1;const a=s.response&&s.response.status||500;if(o>0&&(Array.isArray(s.options.retryStatusCodes)?s.options.retryStatusCodes.includes(a):Ds.has(a))){const a="function"==typeof s.options.retryDelay?s.options.retryDelay(s):s.options.retryDelay||0;return a>0&&await new Promise((s=>setTimeout(s,a))),$fetchRaw(s.request,{...s.options,retry:o-1})}}const a=function(s){const o=s.error?.message||s.error?.toString()||"",a=s.request?.method||s.options?.method||"GET",c=s.request?.url||String(s.request)||"/",u=`[${a}] ${JSON.stringify(c)}`,p=s.response?`${s.response.status} ${s.response.statusText}`:"<no response>",w=new FetchError(`${u}: ${p}${o?` ${o}`:""}`,s.error?{cause:s.error}:void 0);for(const o of["request","options","response"])Object.defineProperty(w,o,{get:()=>s[o]});for(const[o,a]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(w,o,{get:()=>s.response&&s.response[a]});return w}(s);throw Error.captureStackTrace&&Error.captureStackTrace(a,$fetchRaw),a}const $fetchRaw=async function(u,p={}){const w={request:u,options:resolveFetchOptions(u,p,s.defaults,a),response:void 0,error:void 0};let v;if(w.options.method&&(w.options.method=w.options.method.toUpperCase()),w.options.onRequest&&await callHooks(w,w.options.onRequest),"string"==typeof w.request&&(w.options.baseURL&&(w.request=function(s,o){if(isEmptyURL(o)||hasProtocol(s))return s;const a=withoutTrailingSlash(o);return s.startsWith(a)?s:joinURL(a,s)}(w.request,w.options.baseURL)),w.options.query&&(w.request=withQuery(w.request,w.options.query),delete w.options.query),"query"in w.options&&delete w.options.query,"params"in w.options&&delete w.options.params),w.options.body&&isPayloadMethod(w.options.method)&&(!function(s){if(void 0===s)return!1;const o=typeof s;return"string"===o||"number"===o||"boolean"===o||null===o||"object"===o&&(!!Array.isArray(s)||!s.buffer&&(s.constructor&&"Object"===s.constructor.name||"function"==typeof s.toJSON))}(w.options.body)?("pipeTo"in w.options.body&&"function"==typeof w.options.body.pipeTo||"function"==typeof w.options.body.pipe)&&("duplex"in w.options||(w.options.duplex="half")):(w.options.body="string"==typeof w.options.body?w.options.body:JSON.stringify(w.options.body),w.options.headers=new a(w.options.headers||{}),w.options.headers.has("content-type")||w.options.headers.set("content-type","application/json"),w.options.headers.has("accept")||w.options.headers.set("accept","application/json"))),!w.options.signal&&w.options.timeout){const s=new c;v=setTimeout((()=>{const o=new Error("[TimeoutError]: The operation was aborted due to timeout");o.name="TimeoutError",o.code=23,s.abort(o)}),w.options.timeout),w.options.signal=s.signal}try{w.response=await o(w.request,w.options)}catch(s){return w.error=s,w.options.onRequestError&&await callHooks(w,w.options.onRequestError),await onError(w)}finally{v&&clearTimeout(v)}if((w.response.body||w.response._bodyInit)&&!Ms.has(w.response.status)&&"HEAD"!==w.options.method){const s=(w.options.parseResponse?"json":w.options.responseType)||function(s=""){if(!s)return"json";const o=s.split(";").shift()||"";return Bs.test(o)?"json":Qs.has(o)||o.startsWith("text/")?"text":"blob"}(w.response.headers.get("content-type")||"");switch(s){case"json":{const s=await w.response.text(),o=w.options.parseResponse||destr;w.response._data=o(s);break}case"stream":w.response._data=w.response.body||w.response._bodyInit;break;default:w.response._data=await w.response[s]()}}return w.options.onResponse&&await callHooks(w,w.options.onResponse),!w.options.ignoreResponseError&&w.response.status>=400&&w.response.status<600?(w.options.onResponseError&&await callHooks(w,w.options.onResponseError),await onError(w)):w.response},$fetch=async function(s,o){return(await $fetchRaw(s,o))._data};return $fetch.raw=$fetchRaw,$fetch.native=(...s)=>o(...s),$fetch.create=(o={},a={})=>createFetch({...s,...a,defaults:{...s.defaults,...a.defaults,...o}}),$fetch}const Hs=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if(void 0!==Ls)return Ls;throw new Error("unable to locate global object")}(),Fs=Hs.fetch?(...s)=>Hs.fetch(...s):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Us=Hs.Headers,Ks=Hs.AbortController;function asyncCall(s,...o){try{return(a=s(...o))&&"function"==typeof a.then?a:Promise.resolve(a)}catch(s){return Promise.reject(s)}var a}function stringify(s){if(function(s){const o=typeof s;return null===s||"object"!==o&&"function"!==o}(s))return String(s);if(function(s){const o=Object.getPrototypeOf(s);return!o||o.isPrototypeOf(Object)}(s)||Array.isArray(s))return JSON.stringify(s);if("function"==typeof s.toJSON)return stringify(s.toJSON());throw new Error("[unstorage] Cannot stringify value!")}createFetch({fetch:Fs,Headers:Us,AbortController:Ks});const Ws="base64:";function serializeRaw(o){return"string"==typeof o?o:Ws+function(o){if(globalThis.Buffer)return s.from(o).toString("base64");return globalThis.btoa(String.fromCodePoint(...o))}(o)}function deserializeRaw(o){return"string"!=typeof o?o:o.startsWith(Ws)?function(o){if(globalThis.Buffer)return s.from(o,"base64");return Uint8Array.from(globalThis.atob(o),(s=>s.codePointAt(0)))}(o.slice(7)):o}const Vs=["has","hasItem","get","getItem","getItemRaw","set","setItem","setItemRaw","del","remove","removeItem","getMeta","setMeta","removeMeta","getKeys","clear","mount","unmount"];function normalizeKey$1(s){return s&&s.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function joinKeys(...s){return normalizeKey$1(s.join(":"))}function normalizeBaseKey(s){return(s=normalizeKey$1(s))?s+":":""}const memory=()=>{const s=new Map;return{name:"memory",getInstance:()=>s,hasItem:o=>s.has(o),getItem:o=>s.get(o)??null,getItemRaw:o=>s.get(o)??null,setItem(o,a){s.set(o,a)},setItemRaw(o,a){s.set(o,a)},removeItem(o){s.delete(o)},getKeys:()=>[...s.keys()],clear(){s.clear()},dispose(){s.clear()}}};function watch(s,o,a){return s.watch?s.watch(((s,c)=>o(s,a+c))):()=>{}}async function dispose(s){"function"==typeof s.dispose&&await asyncCall(s.dispose)}const Js={},normalizeKey=function(s){return s&&s.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""},Gs={getKeys:()=>Promise.resolve(Object.keys(Js)),hasItem:s=>(s=normalizeKey(s),Promise.resolve(s in Js)),getItem:s=>(s=normalizeKey(s),Promise.resolve(Js[s]?Js[s].import():null)),getMeta:s=>(s=normalizeKey(s),Promise.resolve(Js[s]?Js[s].meta:{}))},Ys=function(s={}){const o={mounts:{"":s.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},getMount=s=>{for(const a of o.mountpoints)if(s.startsWith(a))return{base:a,relativeKey:s.slice(a.length),driver:o.mounts[a]};return{base:"",relativeKey:s,driver:o.mounts[""]}},getMounts=(s,a)=>o.mountpoints.filter((o=>o.startsWith(s)||a&&s.startsWith(o))).map((a=>({relativeBase:s.length>a.length?s.slice(a.length):void 0,mountpoint:a,driver:o.mounts[a]}))),onChange=(s,a)=>{if(o.watching){a=normalizeKey$1(a);for(const c of o.watchListeners)c(s,a)}},stopWatch=async()=>{if(o.watching){for(const s in o.unwatch)await o.unwatch[s]();o.unwatch={},o.watching=!1}},runBatch=(s,o,a)=>{const c=new Map,getBatch=s=>{let o=c.get(s.base);return o||(o={driver:s.driver,base:s.base,items:[]},c.set(s.base,o)),o};for(const a of s){const s="string"==typeof a,c=normalizeKey$1(s?a:a.key),u=s?void 0:a.value,p=s||!a.options?o:{...o,...a.options},w=getMount(c);getBatch(w).items.push({key:c,value:u,relativeKey:w.relativeKey,options:p})}return Promise.all([...c.values()].map((s=>a(s)))).then((s=>s.flat()))},a={hasItem(s,o={}){s=normalizeKey$1(s);const{relativeKey:a,driver:c}=getMount(s);return asyncCall(c.hasItem,a,o)},getItem(s,o={}){s=normalizeKey$1(s);const{relativeKey:a,driver:c}=getMount(s);return asyncCall(c.getItem,a,o).then((s=>destr(s)))},getItems:(s,o={})=>runBatch(s,o,(s=>s.driver.getItems?asyncCall(s.driver.getItems,s.items.map((s=>({key:s.relativeKey,options:s.options}))),o).then((o=>o.map((o=>({key:joinKeys(s.base,o.key),value:destr(o.value)}))))):Promise.all(s.items.map((o=>asyncCall(s.driver.getItem,o.relativeKey,o.options).then((s=>({key:o.key,value:destr(s)})))))))),getItemRaw(s,o={}){s=normalizeKey$1(s);const{relativeKey:a,driver:c}=getMount(s);return c.getItemRaw?asyncCall(c.getItemRaw,a,o):asyncCall(c.getItem,a,o).then((s=>deserializeRaw(s)))},async setItem(s,o,c={}){if(void 0===o)return a.removeItem(s);s=normalizeKey$1(s);const{relativeKey:u,driver:p}=getMount(s);p.setItem&&(await asyncCall(p.setItem,u,stringify(o),c),p.watch||onChange("update",s))},async setItems(s,o){await runBatch(s,o,(async s=>{if(s.driver.setItems)return asyncCall(s.driver.setItems,s.items.map((s=>({key:s.relativeKey,value:stringify(s.value),options:s.options}))),o);s.driver.setItem&&await Promise.all(s.items.map((o=>asyncCall(s.driver.setItem,o.relativeKey,stringify(o.value),o.options))))}))},async setItemRaw(s,o,c={}){if(void 0===o)return a.removeItem(s,c);s=normalizeKey$1(s);const{relativeKey:u,driver:p}=getMount(s);if(p.setItemRaw)await asyncCall(p.setItemRaw,u,o,c);else{if(!p.setItem)return;await asyncCall(p.setItem,u,serializeRaw(o),c)}p.watch||onChange("update",s)},async removeItem(s,o={}){"boolean"==typeof o&&(o={removeMeta:o}),s=normalizeKey$1(s);const{relativeKey:a,driver:c}=getMount(s);c.removeItem&&(await asyncCall(c.removeItem,a,o),(o.removeMeta||o.removeMata)&&await asyncCall(c.removeItem,a+"$",o),c.watch||onChange("remove",s))},async getMeta(s,o={}){"boolean"==typeof o&&(o={nativeOnly:o}),s=normalizeKey$1(s);const{relativeKey:a,driver:c}=getMount(s),u=Object.create(null);if(c.getMeta&&Object.assign(u,await asyncCall(c.getMeta,a,o)),!o.nativeOnly){const s=await asyncCall(c.getItem,a+"$",o).then((s=>destr(s)));s&&"object"==typeof s&&("string"==typeof s.atime&&(s.atime=new Date(s.atime)),"string"==typeof s.mtime&&(s.mtime=new Date(s.mtime)),Object.assign(u,s))}return u},setMeta(s,o,a={}){return this.setItem(s+"$",o,a)},removeMeta(s,o={}){return this.removeItem(s+"$",o)},async getKeys(s,o={}){s=normalizeBaseKey(s);const a=getMounts(s,!0);let c=[];const u=[];let p=!0;for(const s of a){s.driver.flags?.maxDepth||(p=!1);const a=await asyncCall(s.driver.getKeys,s.relativeBase,o);for(const o of a){const a=s.mountpoint+normalizeKey$1(o);c.some((s=>a.startsWith(s)))||u.push(a)}c=[s.mountpoint,...c.filter((o=>!o.startsWith(s.mountpoint)))]}const w=void 0!==o.maxDepth&&!p;return u.filter((a=>(!w||function(s,o){if(void 0===o)return!0;let a=0,c=s.indexOf(":");for(;c>-1;)a++,c=s.indexOf(":",c+1);return a<=o}(a,o.maxDepth))&&function(s,o){return o?s.startsWith(o)&&"$"!==s[s.length-1]:"$"!==s[s.length-1]}(a,s)))},async clear(s,o={}){s=normalizeBaseKey(s),await Promise.all(getMounts(s,!1).map((async s=>{if(s.driver.clear)return asyncCall(s.driver.clear,s.relativeBase,o);if(s.driver.removeItem){const a=await s.driver.getKeys(s.relativeBase||"",o);return Promise.all(a.map((a=>s.driver.removeItem(a,o))))}})))},async dispose(){await Promise.all(Object.values(o.mounts).map((s=>dispose(s))))},watch:async s=>(await(async()=>{if(!o.watching){o.watching=!0;for(const s in o.mounts)o.unwatch[s]=await watch(o.mounts[s],onChange,s)}})(),o.watchListeners.push(s),async()=>{o.watchListeners=o.watchListeners.filter((o=>o!==s)),0===o.watchListeners.length&&await stopWatch()}),async unwatch(){o.watchListeners=[],await stopWatch()},mount(s,c){if((s=normalizeBaseKey(s))&&o.mounts[s])throw new Error(`already mounted at ${s}`);return s&&(o.mountpoints.push(s),o.mountpoints.sort(((s,o)=>o.length-s.length))),o.mounts[s]=c,o.watching&&Promise.resolve(watch(c,onChange,s)).then((a=>{o.unwatch[s]=a})).catch(console.error),a},async unmount(s,a=!0){(s=normalizeBaseKey(s))&&o.mounts[s]&&(o.watching&&s in o.unwatch&&(o.unwatch[s]?.(),delete o.unwatch[s]),a&&await dispose(o.mounts[s]),o.mountpoints=o.mountpoints.filter((o=>o!==s)),delete o.mounts[s])},getMount(s=""){s=normalizeKey$1(s)+":";const o=getMount(s);return{driver:o.driver,base:o.base}},getMounts(s="",o={}){s=normalizeKey$1(s);return getMounts(s,o.parents).map((s=>({driver:s.driver,base:s.mountpoint})))},keys:(s,o={})=>a.getKeys(s,o),get:(s,o={})=>a.getItem(s,o),set:(s,o,c={})=>a.setItem(s,o,c),has:(s,o={})=>a.hasItem(s,o),del:(s,o={})=>a.removeItem(s,o),remove:(s,o={})=>a.removeItem(s,o)};return a}({});function useStorage(s=""){return s?function(s,o){if(!(o=normalizeBaseKey(o)))return s;const a={...s};for(const c of Vs)a[c]=(a="",...u)=>s[c](o+a,...u);return a.getKeys=(a="",...c)=>s.getKeys(o+a,...c).then((s=>s.map((s=>s.slice(o.length))))),a.getItems=async(a,c)=>{const u=a.map((s=>"string"==typeof s?o+s:{...s,key:o+s.key}));return(await s.getItems(u,c)).map((s=>({key:s.key.slice(o.length),value:s.value})))},a.setItems=async(a,c)=>{const u=a.map((s=>({key:o+s.key,value:s.value,options:s.options})));return s.setItems(u,c)},a}(Ys,s):Ys}Ys.mount("/assets",Gs);const Zs=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Xs=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],en=[];class k{_data=new tn;_hash=new tn([...Zs]);_nDataBytes=0;_minBufferSize=0;finalize(s){s&&this._append(s);const o=8*this._nDataBytes,a=8*this._data.sigBytes;return this._data.words[a>>>5]|=128<<24-a%32,this._data.words[14+(a+64>>>9<<4)]=Math.floor(o/4294967296),this._data.words[15+(a+64>>>9<<4)]=o,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}_doProcessBlock(s,o){const a=this._hash.words;let c=a[0],u=a[1],p=a[2],w=a[3],v=a[4],$=a[5],C=a[6],q=a[7];for(let a=0;a<64;a++){if(a<16)en[a]=0|s[o+a];else{const s=en[a-15],o=(s<<25|s>>>7)^(s<<14|s>>>18)^s>>>3,c=en[a-2],u=(c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10;en[a]=o+en[a-7]+u+en[a-16]}const z=c&u^c&p^u&p,j=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),L=q+((v<<26|v>>>6)^(v<<21|v>>>11)^(v<<7|v>>>25))+(v&$^~v&C)+Xs[a]+en[a];q=C,C=$,$=v,v=w+L|0,w=p,p=u,u=c,c=L+(j+z)|0}a[0]=a[0]+c|0,a[1]=a[1]+u|0,a[2]=a[2]+p|0,a[3]=a[3]+w|0,a[4]=a[4]+v|0,a[5]=a[5]+$|0,a[6]=a[6]+C|0,a[7]=a[7]+q|0}_append(s){"string"==typeof s&&(s=tn.fromUtf8(s)),this._data.concat(s),this._nDataBytes+=s.sigBytes}_process(s){let o,a=this._data.sigBytes/64;a=s?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0);const c=16*a,u=Math.min(4*c,this._data.sigBytes);if(c){for(let s=0;s<c;s+=16)this._doProcessBlock(this._data.words,s);o=this._data.words.splice(0,c),this._data.sigBytes-=u}return new tn(o,u)}}let tn=class l{words;sigBytes;constructor(s,o){s=this.words=s||[],this.sigBytes=void 0===o?4*s.length:o}static fromUtf8(s){const o=unescape(encodeURIComponent(s)),a=o.length,c=[];for(let s=0;s<a;s++)c[s>>>2]|=(255&o.charCodeAt(s))<<24-s%4*8;return new l(c,a)}toBase64(){const s=[];for(let o=0;o<this.sigBytes;o+=3){const a=(this.words[o>>>2]>>>24-o%4*8&255)<<16|(this.words[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|this.words[o+2>>>2]>>>24-(o+2)%4*8&255;for(let c=0;c<4&&8*o+6*c<8*this.sigBytes;c++)s.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(a>>>6*(3-c)&63))}return s.join("")}concat(s){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let o=0;o<s.sigBytes;o++){const a=s.words[o>>>2]>>>24-o%4*8&255;this.words[this.sigBytes+o>>>2]|=a<<24-(this.sigBytes+o)%4*8}else for(let o=0;o<s.sigBytes;o+=4)this.words[this.sigBytes+o>>>2]=s.words[o>>>2];this.sigBytes+=s.sigBytes}};const nn=(()=>{class Hasher2{buff="";#n=new Map;write(s){this.buff+=s}dispatch(s){return this[null===s?"null":typeof s](s)}object(o){if(o&&"function"==typeof o.toJSON)return this.object(o.toJSON());const a=Object.prototype.toString.call(o);let c="";const u=a.length;c=u<10?"unknown:["+a+"]":a.slice(8,u-1),c=c.toLowerCase();let p=null;if(void 0!==(p=this.#n.get(o)))return this.dispatch("[CIRCULAR:"+p+"]");if(this.#n.set(o,this.#n.size),void 0!==s&&s.isBuffer&&s.isBuffer(o))return this.write("buffer:"),this.write(o.toString("utf8"));if("object"!==c&&"function"!==c&&"asyncfunction"!==c)this[c]?this[c](o):this.unknown(o,c);else{const s=Object.keys(o).sort(),a=[];this.write("object:"+(s.length+a.length)+":");const dispatchForKey=s=>{this.dispatch(s),this.write(":"),this.dispatch(o[s]),this.write(",")};for(const o of s)dispatchForKey(o);for(const s of a)dispatchForKey(s)}}array(s,o){if(o=void 0!==o&&o,this.write("array:"+s.length+":"),!o||s.length<=1){for(const o of s)this.dispatch(o);return}const a=new Map,c=s.map((s=>{const o=new Hasher2;o.dispatch(s);for(const[s,c]of o.#n)a.set(s,c);return o.toString()}));return this.#n=a,c.sort(),this.array(c,!1)}date(s){return this.write("date:"+s.toJSON())}symbol(s){return this.write("symbol:"+s.toString())}unknown(s,o){if(this.write(o),s)return this.write(":"),s&&"function"==typeof s.entries?this.array([...s.entries()],!0):void 0}error(s){return this.write("error:"+s.toString())}boolean(s){return this.write("bool:"+s)}string(s){this.write("string:"+s.length+":"),this.write(s)}function(s){this.write("fn:"),!function(s){if("function"!=typeof s)return!1;return"[native code] }"===Function.prototype.toString.call(s).slice(-15)}(s)?this.dispatch(s.toString()):this.dispatch("[native]")}number(s){return this.write("number:"+s)}null(){return this.write("Null")}undefined(){return this.write("Undefined")}regexp(s){return this.write("regex:"+s.toString())}arraybuffer(s){return this.write("arraybuffer:"),this.dispatch(new Uint8Array(s))}url(s){return this.write("url:"+s.toString())}map(s){this.write("map:");const o=[...s];return this.array(o,!1)}set(s){this.write("set:");const o=[...s];return this.array(o,!1)}bigint(s){return this.write("bigint:"+s.toString())}}for(const s of["uint8array","uint8clampedarray","unt8array","uint16array","unt16array","uint32array","unt32array","float32array","float64array"])Hasher2.prototype[s]=function(o){return this.write(s+":"),this.array([...o],!1)};return Hasher2})();function hash(s){return function(s){return(new k).finalize(s).toBase64()}("string"==typeof s?s:function(s){const o=new nn;return o.dispatch(s),o.buff}(s)).replace(/[-_]/g,"").slice(0,10)}function defineCachedFunction(s,o={}){o={name:"_",base:"/cache",swr:!0,maxAge:1,...o};const a={},c=o.group||"nitro/functions",u=o.name||s.name||"_",p=o.integrity||hash([s,o]),w=o.validate||(s=>void 0!==s.value);return async(...v)=>{if(await(o.shouldBypassCache?.(...v)))return s(...v);const $=await(o.getKey||getKey)(...v),C=await(o.shouldInvalidateCache?.(...v)),q=await async function(s,v,$,C){const q=[o.base,c,u,s+".json"].filter(Boolean).join(":").replace(/:\/$/,":index");let z=await useStorage().getItem(q).catch((s=>{console.error("[cache] Cache read error.",s),useNitroApp().captureError(s,{event:C,tags:["cache"]})}))||{};if("object"!=typeof z){z={};const s=new Error("Malformed data read from cache.");console.error("[cache]",s),useNitroApp().captureError(s,{event:C,tags:["cache"]})}const j=1e3*(o.maxAge??0);j&&(z.expires=Date.now()+j);const L=$||z.integrity!==p||j&&Date.now()-(z.mtime||0)>j||!1===w(z),Q=L?(async()=>{const c=a[s];c||(void 0!==z.value&&(o.staleMaxAge||0)>=0&&!1===o.swr&&(z.value=void 0,z.integrity=void 0,z.mtime=void 0,z.expires=void 0),a[s]=Promise.resolve(v()));try{z.value=await a[s]}catch(o){throw c||delete a[s],o}if(!c&&(z.mtime=Date.now(),z.integrity=p,delete a[s],!1!==w(z))){let s;o.maxAge&&!o.swr&&(s={ttl:o.maxAge});const a=useStorage().setItem(q,z,s).catch((s=>{console.error("[cache] Cache write error.",s),useNitroApp().captureError(s,{event:C,tags:["cache"]})}));C?.waitUntil&&C.waitUntil(a)}})():Promise.resolve();return void 0===z.value?await Q:L&&C&&C.waitUntil&&C.waitUntil(Q),o.swr&&!1!==w(z)?(Q.catch((s=>{console.error("[cache] SWR handler error.",s),useNitroApp().captureError(s,{event:C,tags:["cache"]})})),z):Q.then((()=>z))}($,(()=>s(...v)),C,v[0]&&isEvent$1(v[0])?v[0]:void 0);let z=q.value;return o.transform&&(z=await o.transform(q,...v)||z),z}}function getKey(...s){return s.length>0?hash(s):""}function escapeKey(s){return String(s).replace(/\W/g,"")}function cloneWithProxy(s,o){return new Proxy(s,{get:(s,a,c)=>a in o?o[a]:Reflect.get(s,a,c),set:(s,a,c,u)=>a in o?(o[a]=c,!0):Reflect.set(s,a,c,u)})}const cachedEventHandler=function(s,o={name:"_",base:"/cache",swr:!0,maxAge:1}){const a=(o.varies||[]).filter(Boolean).map((s=>s.toLowerCase())).sort(),c={...o,getKey:async s=>{const c=await(o.getKey?.(s));if(c)return escapeKey(c);const u=s.node.req.originalUrl||s.node.req.url||s.path;let p;try{p=escapeKey(decodeURI(parseURL(u).pathname)).slice(0,16)||"index"}catch{p="-"}return[`${p}.${hash(u)}`,...a.map((o=>[o,s.node.req.headers[o]])).map((([s,o])=>`${escapeKey(s)}.${hash(o)}`))].join(":")},validate:s=>!!s.value&&(!(s.value.code>=400)&&(void 0!==s.value.body&&("undefined"!==s.value.headers.etag&&"undefined"!==s.value.headers["last-modified"]))),group:o.group||"nitro/handlers",integrity:o.integrity||hash([s,o])},u=function(s,o={}){return defineCachedFunction(s,o)}((async u=>{const p={};for(const s of a){const o=u.node.req.headers[s];void 0!==o&&(p[s]=o)}const w=cloneWithProxy(u.node.req,{headers:p}),v={};let $;const C=createEvent(w,cloneWithProxy(u.node.res,{statusCode:200,writableEnded:!1,writableFinished:!1,headersSent:!1,closed:!1,getHeader:s=>v[s],setHeader(s,o){return v[s]=o,this},getHeaderNames:()=>Object.keys(v),hasHeader:s=>s in v,removeHeader(s){delete v[s]},getHeaders:()=>v,end(s,o,a){return"string"==typeof s&&($=s),"function"==typeof o&&o(),"function"==typeof a&&a(),this},write:(s,o,a)=>("string"==typeof s&&($=s),"function"==typeof o&&o(void 0),"function"==typeof a&&a(),!0),writeHead(s,o){if(this.statusCode=s,o){if(Array.isArray(o)||"string"==typeof o)throw new TypeError("Raw headers  is not supported.");for(const s in o){const a=o[s];void 0!==a&&this.setHeader(s,a)}}return this}}));C.fetch=(s,o)=>fetchWithEvent(C,s,o,{fetch:useNitroApp().localFetch}),C.$fetch=(s,o)=>fetchWithEvent(C,s,o,{fetch:globalThis.$fetch}),C.waitUntil=u.waitUntil,C.context=u.context,C.context.cache={options:c};const q=await s(C)||$,z=C.node.res.getHeaders();z.etag=String(z.Etag||z.etag||`W/"${hash(q)}"`),z["last-modified"]=String(z["Last-Modified"]||z["last-modified"]||(new Date).toUTCString());const j=[];o.swr?(o.maxAge&&j.push(`s-maxage=${o.maxAge}`),o.staleMaxAge?j.push(`stale-while-revalidate=${o.staleMaxAge}`):j.push("stale-while-revalidate")):o.maxAge&&j.push(`max-age=${o.maxAge}`),j.length>0&&(z["cache-control"]=j.join(", "));return{code:C.node.res.statusCode,headers:z,body:q}}),c);return defineEventHandler$1((async a=>{if(o.headersOnly){if(handleCacheHeaders(a,{maxAge:o.maxAge}))return;return s(a)}const c=await u(a);if(a.node.res.headersSent||a.node.res.writableEnded)return c.body;if(!handleCacheHeaders(a,{modifiedTime:new Date(c.headers["last-modified"]),etag:c.headers.etag,maxAge:o.maxAge})){a.node.res.statusCode=c.code;for(const s in c.headers){const o=c.headers[s];"set-cookie"===s?a.node.res.appendHeader(s,splitCookiesString$1(o)):void 0!==o&&a.node.res.setHeader(s,o)}return c.body}}))};function klona(s){if("object"!=typeof s)return s;var o,a,c=Object.prototype.toString.call(s);if("[object Object]"===c){if(s.constructor!==Object&&"function"==typeof s.constructor)for(o in a=new s.constructor,s)s.hasOwnProperty(o)&&a[o]!==s[o]&&(a[o]=klona(s[o]));else for(o in a={},s)"__proto__"===o?Object.defineProperty(a,o,{value:klona(s[o]),configurable:!0,enumerable:!0,writable:!0}):a[o]=klona(s[o]);return a}if("[object Array]"===c){for(o=s.length,a=Array(o);o--;)a[o]=klona(s[o]);return a}return"[object Set]"===c?(a=new Set,s.forEach((function(s){a.add(klona(s))})),a):"[object Map]"===c?(a=new Map,s.forEach((function(s,o){a.set(klona(o),klona(s))})),a):"[object Date]"===c?new Date(+s):"[object RegExp]"===c?((a=new RegExp(s.source,s.flags)).lastIndex=s.lastIndex,a):"[object DataView]"===c?new s.constructor(klona(s.buffer)):"[object ArrayBuffer]"===c?s.slice(0):"Array]"===c.slice(-6)?new s.constructor(s):s}const on=os({}),an=/\d/,ln=["-","_","/","."];function isUppercase(s=""){if(!an.test(s))return s!==s.toLowerCase()}function kebabCase(s,o){return s?(Array.isArray(s)?s:function(s){const o=ln,a=[];if(!s||"string"!=typeof s)return a;let c,u,p="";for(const w of s){const s=o.includes(w);if(!0===s){a.push(p),p="",c=void 0;continue}const v=isUppercase(w);if(!1===u){if(!1===c&&!0===v){a.push(p),p=w,c=v;continue}if(!0===c&&!1===v&&p.length>1){const s=p.at(-1);a.push(p.slice(0,Math.max(0,p.length-1))),p=s+w,c=v;continue}}p+=w,c=v,u=s}return a.push(p),a}(s)).map((s=>s.toLowerCase())).join(o):""}function getEnv(s,o){const a=(c=s,kebabCase(c||"","_")).toUpperCase();var c;return destr(z.env[o.prefix+a]??z.env[o.altPrefix+a])}function _isObject(s){return"object"==typeof s&&!Array.isArray(s)}const cn=/\{\{([^{}]*)\}\}/g;const un={app:{baseURL:"/"},nitro:{routeRules:{"/_build/assets/**":{headers:{"cache-control":"public, immutable, max-age=31536000"}}}}},dn={prefix:"NITRO_",altPrefix:un.nitro.envPrefix??z.env.NITRO_ENV_PREFIX??"_",envExpansion:un.nitro.envExpansion??z.env.NITRO_ENV_EXPANSION??!1},hn=_deepFreeze(function applyEnv(s,o,a=""){for(const c in s){const u=a?`${a}_${c}`:c,p=getEnv(u,o);_isObject(s[c])?_isObject(p)?(s[c]={...s[c],...p},applyEnv(s[c],o,u)):void 0===p?applyEnv(s[c],o,u):s[c]=p??s[c]:s[c]=p??s[c],o.envExpansion&&"string"==typeof s[c]&&(s[c]=s[c].replace(cn,((s,o)=>z.env[o]||s)))}return s}(klona(un),dn));function useRuntimeConfig(s){return hn}function _deepFreeze(s){const o=Object.getOwnPropertyNames(s);for(const a of o){const o=s[a];o&&"object"==typeof o&&_deepFreeze(o)}return Object.freeze(s)}_deepFreeze(klona(on)),new Proxy(Object.create(null),{get:(s,o)=>{console.warn("Please use `useRuntimeConfig()` instead of accessing config directly.");const a=useRuntimeConfig();if(o in a)return a[o]}});const fn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:void 0!==Ls?Ls:{},pn="__unctx__",mn=fn[pn]||(fn[pn]=function(s={}){const o={};return{get:(a,c={})=>(o[a]||(o[a]=function(s={}){let o,a=!1;const checkConflict=s=>{if(o&&o!==s)throw new Error("Context conflict")};let c;if(s.asyncContext){const o=s.AsyncLocalStorage||globalThis.AsyncLocalStorage;o?c=new o:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const _getCurrentInstance=()=>{if(c){const s=c.getStore();if(void 0!==s)return s}return o};return{use:()=>{const s=_getCurrentInstance();if(void 0===s)throw new Error("Context is not available");return s},tryUse:()=>_getCurrentInstance(),set:(s,c)=>{c||checkConflict(s),o=s,a=!0},unset:()=>{o=void 0,a=!1},call:(s,u)=>{checkConflict(s),o=s;try{return c?c.run(s,u):u()}finally{a||(o=void 0)}},async callAsync(s,u){o=s;const onRestore=()=>{o=s},onLeave=()=>o===s?onRestore:void 0;yn.add(onLeave);try{const p=c?c.run(s,u):u();return a||(o=void 0),await p}finally{yn.delete(onLeave)}}}}({...s,...c})),o[a])}}()),getContext=(s,o={})=>mn.get(s,o),gn="__unctx_async_handlers__",yn=fn[gn]||(fn[gn]=new Set),bn=getContext("nitro-app",{asyncContext:!0,AsyncLocalStorage:p}),wn=toRouteMatcher(createRouter$1({routes:useRuntimeConfig().nitro.routeRules}));function createRouteRulesHandler(s){return Ps((o=>{const a=function(s){s.context._nitro=s.context._nitro||{},s.context._nitro.routeRules||(s.context._nitro.routeRules=getRouteRulesForPath(withoutBase(s.path.split("?")[0],useRuntimeConfig().app.baseURL)));return s.context._nitro.routeRules}(o);if(a.headers&&Cs(o,a.headers),a.redirect){let s=a.redirect.to;if(s.endsWith("/**")){let c=o.path;const u=a.redirect._redirectStripBase;u&&(c=withoutBase(c,u)),s=joinURL(s.slice(0,-3),c)}else if(o.path.includes("?")){s=withQuery(s,getQuery(o.path))}return function(s,o,a=302){return s.node.res.statusCode=sanitizeStatusCode$1(a,s.node.res.statusCode),s.node.res.setHeader("location",o),send$1(s,`<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=${o.replace(/"/g,"%22")}"></head></html>`,Rs.html)}(o,s,a.redirect.statusCode)}if(a.proxy){let c=a.proxy.to;if(c.endsWith("/**")){let s=o.path;const u=a.proxy._proxyStripBase;u&&(s=withoutBase(s,u)),c=joinURL(c.slice(0,-3),s)}else if(o.path.includes("?")){c=withQuery(c,getQuery(o.path))}return proxyRequest(o,c,{fetch:s.localFetch,...a.proxy})}}))}function getRouteRulesForPath(s){return ns({},...wn.matchAll(s).reverse())}const vn=/post|put|patch/i;function joinHeaders(s){return Array.isArray(s)?s.join(", "):String(s)}function normalizeCookieHeader(s=""){return splitCookiesString$1(joinHeaders(s))}function normalizeCookieHeaders(s){const o=new Headers;for(const[a,c]of s)if("set-cookie"===a)for(const s of normalizeCookieHeader(c))o.append("set-cookie",s);else o.set(a,joinHeaders(c));return o}function defaultHandler(s,o,a){const c=s.unhandled||s.fatal,u=s.statusCode||500,p=s.statusMessage||"Server Error",w=function(s,o={}){const a=function(s,o={}){if(o.xForwardedHost){const o=s.node.req.headers["x-forwarded-host"];if(o)return o}return s.node.req.headers.host||"localhost"}(s,o),c=function(s,o={}){return!1!==o.xForwardedProto&&"https"===s.node.req.headers["x-forwarded-proto"]||s.node.req.connection?.encrypted?"https":"http"}(s,o),u=(s.node.req.originalUrl||s.path).replace(/^[/\\]+/g,"/");return new URL(u,`${c}://${a}`)}(o,{xForwardedHost:!0,xForwardedProto:!0});if(404===u){const s="/";if(/^\/[^/]/.test(s)&&!w.pathname.startsWith(s)){return{status:302,statusText:"Found",headers:{location:`${s}${w.pathname.slice(1)}${w.search}`},body:"Redirecting..."}}}if(c&&!a?.silent){const a=[s.unhandled&&"[unhandled]",s.fatal&&"[fatal]"].filter(Boolean).join(" ");console.error(`[request error] ${a} [${o.method}] ${w}\n`,s)}const v={"content-type":"application/json","x-content-type-options":"nosniff","x-frame-options":"DENY","referrer-policy":"no-referrer","content-security-policy":"script-src 'none'; frame-ancestors 'none';"};setResponseStatus$1(o,u,p),404!==u&&function(s,o){return s.node.res.getHeader(o)}(o,"cache-control")||(v["cache-control"]="no-cache");return{status:u,statusText:p,headers:v,body:{error:!0,url:w.href,statusCode:u,statusMessage:p,message:c?"Server Error":s.message,data:c?void 0:s.data}}}const Sn=[function(s,o){const a=defaultHandler(s,o);return setResponseHeaders(o,a.headers),setResponseStatus$1(o,a.status,a.statusText),send$1(o,JSON.stringify(a.body,null,2))}];const xn={name:"vinxi",routers:[{name:"public",type:"static",base:"/",dir:"./public",root:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle",order:0,outDir:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/.vinxi/build/public"},{name:"ssr",type:"http",link:{client:"client"},handler:"src/entry-server.tsx",extensions:["js","jsx","ts","tsx"],target:"server",root:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle",base:"/",outDir:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/.vinxi/build/ssr",order:1},{name:"client",type:"client",base:"/_build",handler:"src/entry-client.tsx",extensions:["js","jsx","ts","tsx"],target:"browser",root:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle",outDir:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/.vinxi/build/client",order:2},{name:"server-fns",type:"http",base:"/_server",handler:"node_modules/@solidjs/start/dist/runtime/server-handler.js",target:"server",root:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle",outDir:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/.vinxi/build/server-fns",order:3}],server:{compressPublicAssets:{brotli:!0},routeRules:{"/_build/assets/**":{headers:{"cache-control":"public, immutable, max-age=31536000"}}},experimental:{asyncContext:!0},preset:"cloudflare_pages",compatibilityDate:"2025-04-02",cloudflare:{deployConfig:!0,nodeCompat:!0,wrangler:{compatibility_date:"2025-04-02"}},rollupConfig:{external:["__STATIC_CONTENT_MANIFEST","async_hooks"]}},root:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle"},En={ssr:{"_index-B64JFNGz.js":{file:"assets/index-B64JFNGz.js",name:"index"},"src/routes/[...404].tsx?pick=default&pick=$css":{file:"_...404_.js",name:"_...404_",src:"src/routes/[...404].tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0},"src/routes/index.tsx?pick=default&pick=$css":{file:"index.js",name:"index",src:"src/routes/index.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_index-B64JFNGz.js"]},"src/routes/login.tsx?pick=default&pick=$css":{file:"login.js",name:"login",src:"src/routes/login.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_index-B64JFNGz.js"]},"virtual:$vinxi/handler/ssr":{file:"ssr.js",name:"ssr",src:"virtual:$vinxi/handler/ssr",isEntry:!0,imports:["_index-B64JFNGz.js"],dynamicImports:["src/routes/[...404].tsx?pick=default&pick=$css","src/routes/[...404].tsx?pick=default&pick=$css","src/routes/index.tsx?pick=default&pick=$css","src/routes/index.tsx?pick=default&pick=$css","src/routes/login.tsx?pick=default&pick=$css","src/routes/login.tsx?pick=default&pick=$css"],css:["assets/ssr-rN2XJZw8.css"]}},client:{"_index-DSajY67n.js":{file:"assets/index-DSajY67n.js",name:"index",imports:["_web-KYKOfUcb.js"]},"_web-KYKOfUcb.js":{file:"assets/web-KYKOfUcb.js",name:"web"},"src/routes/[...404].tsx?pick=default&pick=$css":{file:"assets/_...404_-dua6DiWa.js",name:"_...404_",src:"src/routes/[...404].tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_web-KYKOfUcb.js"]},"src/routes/index.tsx?pick=default&pick=$css":{file:"assets/index-Js0Seij8.js",name:"index",src:"src/routes/index.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_web-KYKOfUcb.js","_index-DSajY67n.js"]},"src/routes/login.tsx?pick=default&pick=$css":{file:"assets/login-Cs7fDAsq.js",name:"login",src:"src/routes/login.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_web-KYKOfUcb.js","_index-DSajY67n.js"]},"virtual:$vinxi/handler/client":{file:"assets/client-Dc-Tua0f.js",name:"client",src:"virtual:$vinxi/handler/client",isEntry:!0,imports:["_web-KYKOfUcb.js","_index-DSajY67n.js"],dynamicImports:["src/routes/[...404].tsx?pick=default&pick=$css","src/routes/index.tsx?pick=default&pick=$css","src/routes/login.tsx?pick=default&pick=$css"],css:["assets/client-rN2XJZw8.css"]}},"server-fns":{"_index-DcGoOrg_.js":{file:"assets/index-DcGoOrg_.js",name:"index"},"_server-fns-CD-uTy4t.js":{file:"assets/server-fns-CD-uTy4t.js",name:"server-fns",imports:["_index-DcGoOrg_.js"],dynamicImports:["src/routes/[...404].tsx?pick=default&pick=$css","src/routes/[...404].tsx?pick=default&pick=$css","src/routes/index.tsx?pick=default&pick=$css","src/routes/index.tsx?pick=default&pick=$css","src/routes/login.tsx?pick=default&pick=$css","src/routes/login.tsx?pick=default&pick=$css","src/api/server.ts?tsr-directive-use-server=","src/api/server.ts?tsr-directive-use-server=","src/api/server.ts?tsr-directive-use-server=","src/app.tsx"]},"src/api/server.ts?tsr-directive-use-server=":{file:"assets/server-B-YuvM1W.js",name:"server",src:"src/api/server.ts?tsr-directive-use-server=",isDynamicEntry:!0,imports:["_index-DcGoOrg_.js"]},"src/app.tsx":{file:"assets/app-B2XfqFCO.js",name:"app",src:"src/app.tsx",isDynamicEntry:!0,imports:["_server-fns-CD-uTy4t.js","_index-DcGoOrg_.js"],css:["assets/app-rN2XJZw8.css"]},"src/routes/[...404].tsx?pick=default&pick=$css":{file:"_...404_.js",name:"_...404_",src:"src/routes/[...404].tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0},"src/routes/index.tsx?pick=default&pick=$css":{file:"index.js",name:"index",src:"src/routes/index.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_index-DcGoOrg_.js"]},"src/routes/login.tsx?pick=default&pick=$css":{file:"login.js",name:"login",src:"src/routes/login.tsx?pick=default&pick=$css",isEntry:!0,isDynamicEntry:!0,imports:["_index-DcGoOrg_.js"]},"virtual:$vinxi/handler/server-fns":{file:"server-fns.js",name:"server-fns",src:"virtual:$vinxi/handler/server-fns",isEntry:!0,imports:["_server-fns-CD-uTy4t.js","_index-DcGoOrg_.js"]}}},Rn={ssr:{},client:{},"server-fns":{}};const Cn="Invariant Violation",{setPrototypeOf:kn=function(s,o){return s.__proto__=o,s}}=Object;class InvariantError extends Error{framesToPop=1;name=Cn;constructor(s=Cn){super("number"==typeof s?`${Cn}: ${s} (see https://github.com/apollographql/invariant-packages)`:s),kn(this,InvariantError.prototype)}}function invariant(s,o){if(!s)throw new InvariantError(o)}const zn=/^[A-Za-z]:\//;const Pn=/^[/\\]{2}/,jn=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/,In=/^[A-Za-z]:$/,normalize=function(s){if(0===s.length)return".";s=function(s=""){return s?s.replace(/\\/g,"/").replace(zn,(s=>s.toUpperCase())):s}(s);const o=s.match(Pn),a=isAbsolute(s),c="/"===s[s.length-1];return 0===(s=function(s,o){let a="",c=0,u=-1,p=0,w=null;for(let v=0;v<=s.length;++v){if(v<s.length)w=s[v];else{if("/"===w)break;w="/"}if("/"===w){if(u===v-1||1===p);else if(2===p){if(a.length<2||2!==c||"."!==a[a.length-1]||"."!==a[a.length-2]){if(a.length>2){const s=a.lastIndexOf("/");-1===s?(a="",c=0):(a=a.slice(0,s),c=a.length-1-a.lastIndexOf("/")),u=v,p=0;continue}if(a.length>0){a="",c=0,u=v,p=0;continue}}o&&(a+=a.length>0?"/..":"..",c=2)}else a.length>0?a+=`/${s.slice(u+1,v)}`:a=s.slice(u+1,v),c=v-u-1;u=v,p=0}else"."===w&&-1!==p?++p:p=-1}return a}(s,!a)).length?a?"/":c?"./":".":(c&&(s+="/"),In.test(s)&&(s+="/"),o?a?`//${s}`:`//./${s}`:a&&!isAbsolute(s)?`/${s}`:s)},join=function(...s){if(0===s.length)return".";let o;for(const a of s)a&&a.length>0&&(void 0===o?o=a:o+=`/${a}`);return void 0===o?".":normalize(o.replace(/\/\/+/g,"/"))};const isAbsolute=function(s){return jn.test(s)};function virtualId(s){return`virtual:${s}`}function handlerModule(s){return s.handler?.endsWith(".html")?isAbsolute(s.handler)?s.handler:join(s.root,s.handler):`$vinxi/handler/${s.name}`}function findAssetsInViteManifest(s,o,a=new Map,c=[]){if(c.includes(o))return[];const u=a.get(o);if(u)return u;const p=s[o];if(!p)return[];const w=[...p.assets?.filter(Boolean)||[],...p.css?.filter(Boolean)||[]];if(p.imports){c.push(o);for(let o=0,u=p.imports.length;o<u;o++)w.push(...findAssetsInViteManifest(s,p.imports[o],a,c));c.pop()}w.push(p.file);const v=Array.from(new Set(w));return a.set(o,v),v}function createHtmlTagsForAssets(s,o,a){return a.filter((s=>s.endsWith(".css")||s.endsWith(".js")||s.endsWith(".mjs"))).map((a=>({tag:"link",attrs:{href:joinURL(o.config.server.baseURL??"/",s.base,a),key:join(o.config.server.baseURL??"",s.base,a),...a.endsWith(".css")?{rel:"stylesheet",fetchPriority:"high"}:{rel:"modulepreload"}}})))}const On={};const Ln=[function(s){const o=function(s){return{config:{...s,buildManifest:En,routeManifest:Rn},getRouter:o=>s.routers.find((s=>s.name===o))}}(xn);globalThis.app=o},function(s){globalThis.$handle=o=>s.h3App.handler(o)},function(){globalThis.MANIFEST=function(s){const o=new Proxy({},{get(o,a){invariant("string"==typeof a,"Bundler name expected");const c=s.getRouter(a),u=s.config.buildManifest[a];return invariant("static"!==c.type,"manifest not available for static router"),{handler:c.handler,async assets(){let s={};s[c.handler]=await this.inputs[c.handler].assets();for(const o of await(c.internals.routes?.getRoutes())??[])s[o.filePath]=await this.inputs[o.filePath].assets();return s},routes:async()=>await(c.internals.routes?.getRoutes())??[],async json(){let s={};for(const o of Object.keys(this.inputs))s[o]={output:this.inputs[o].output.path,assets:await this.inputs[o].assets()};return s},chunks:new Proxy({},{get(s,o){invariant("string"==typeof o,"Chunk expected");const a=join(c.outDir,c.base,o+".mjs");return{import:()=>globalThis.$$chunks[o+".mjs"]?globalThis.$$chunks[o+".mjs"]:import(w(a).href),output:{path:a}}}}),inputs:new Proxy({},{ownKeys:s=>Object.keys(u).filter((s=>u[s].isEntry)).map((s=>s)),getOwnPropertyDescriptor:s=>({enumerable:!0,configurable:!0}),get(o,a){if(invariant("string"==typeof a,"Input expected"),"server"===c.target){const o=a===c.handler?virtualId(handlerModule(c)):a;return{assets:()=>createHtmlTagsForAssets(c,s,findAssetsInViteManifest(u,o)),output:{path:join(c.outDir,c.base,u[o].file)}}}if("browser"===c.target){const o=a!==c.handler||a.endsWith(".html")?a:virtualId(handlerModule(c));return{import:()=>import(joinURL(s.config.server.baseURL??"",c.base,u[o].file)),assets:()=>createHtmlTagsForAssets(c,s,findAssetsInViteManifest(u,o)),output:{path:joinURL(s.config.server.baseURL??"",c.base,u[o].file)}}}}})}}});return o}(globalThis.app)},function(){globalThis.$$chunks=On}];var Nn,Qn=((Nn=Qn||{})[Nn.AggregateError=1]="AggregateError",Nn[Nn.ArrowFunction=2]="ArrowFunction",Nn[Nn.ErrorPrototypeStack=4]="ErrorPrototypeStack",Nn[Nn.ObjectAssign=8]="ObjectAssign",Nn[Nn.BigIntTypedArray=16]="BigIntTypedArray",Nn);function Nr(s){switch(s){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"\t":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function d(s){let o,a="",c=0;for(let u=0,p=s.length;u<p;u++)o=Nr(s[u]),o&&(a+=s.slice(c,u)+o,c=u+1);return 0===c?a=s:a+=s.slice(c),a}function br(s){switch(s){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return"\n";case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"\t";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return s}}function N$3(s){return s.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,br)}var Bn="__SEROVAL_REFS__",Dn="$R",Mn=`self.${Dn}`;function xr(s){return null==s?`${Mn}=${Mn}||[]`:`(${Mn}=${Mn}||{})["${d(s)}"]=[]`}function f$1(s,o){if(!s)throw o}var Un=new Map,Kn=new Map;function je$1(s){return Un.has(s)}function Je$1(s){return f$1(function(s){return Kn.has(s)}(s),new wi(s)),Kn.get(s)}function Ye$1(s,o){for(let a=0,c=o.length;a<c;a++){let c=o[a];s.has(c)||(s.add(c),c.extends&&Ye$1(s,c.extends))}}function m$1(s){if(s){let o=new Set;return Ye$1(o,s),[...o]}}"undefined"!=typeof globalThis?Object.defineProperty(globalThis,Bn,{value:Kn,configurable:!0,writable:!1,enumerable:!1}):"undefined"!=typeof self?Object.defineProperty(self,Bn,{value:Kn,configurable:!0,writable:!1,enumerable:!1}):void 0!==Ls&&Object.defineProperty(Ls,Bn,{value:Kn,configurable:!0,writable:!1,enumerable:!1});var Wn={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},Vn={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},Jn={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},Gn={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},Yn={2:!0,3:!1,1:void 0,0:null,4:-0,5:Number.POSITIVE_INFINITY,6:Number.NEGATIVE_INFINITY,7:Number.NaN},Zn={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},Xn={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError},ei=void 0;function u$1(s,o,a,c,u,p,w,v,$,C,q,z){return{t:s,i:o,s:a,l:c,c:u,m:p,p:w,e:v,a:$,f:C,b:q,o:z}}function x$1(s){return u$1(2,ei,s,ei,ei,ei,ei,ei,ei,ei,ei,ei)}var ti=x$1(2),ri=x$1(3),si=x$1(1),ni=x$1(0),ii=x$1(4),oi=x$1(5),ai=x$1(6),li=x$1(7);function me$2(s){return s instanceof EvalError?1:s instanceof RangeError?2:s instanceof ReferenceError?3:s instanceof SyntaxError?4:s instanceof TypeError?5:s instanceof URIError?6:0}function j$2(s,o){let a=function(s){let o=Zn[me$2(s)];return s.name!==o?{name:s.name}:s.constructor.name!==o?{name:s.constructor.name}:{}}(s),c=Object.getOwnPropertyNames(s);for(let u,p=0,w=c.length;p<w;p++)u=c[p],"name"!==u&&"message"!==u&&("stack"===u?4&o&&(a=a||{},a[u]=s[u]):(a=a||{},a[u]=s[u]));return a}function fe$2(s){return Object.isFrozen(s)?3:Object.isSealed(s)?2:Object.isExtensible(s)?0:1}function w$2(s){return u$1(1,ei,d(s),ei,ei,ei,ei,ei,ei,ei,ei,ei)}function sr(s){return u$1(4,s,ei,ei,ei,ei,ei,ei,ei,ei,ei,ei)}function nr(s,o){return u$1(18,s,d(function(s){return f$1(je$1(s),new bi(s)),Un.get(s)}(o)),ei,ei,ei,ei,ei,ei,ei,ei,ei)}function _$4(s,o,a){return u$1(25,s,a,ei,d(o),ei,ei,ei,ei,ei,ei,ei)}function M(s,o){return u$1(28,ei,ei,ei,ei,ei,ei,ei,[s,o],ei,ei,ei)}function U$1(s,o){return u$1(30,ei,ei,ei,ei,ei,ei,ei,[s,o],ei,ei,ei)}function L$2(s,o,a){return u$1(31,s,ei,ei,ei,ei,ei,ei,a,o,ei,ei)}var{toString:ci}=Object.prototype;var ui=class extends Error{constructor(s,o){super(function(s,o){return o instanceof Error?`Seroval caught an error during the ${s} process.\n  \n${o.name}\n${o.message}\n\n- For more information, please check the "cause" property of this error.\n- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${s} process.\n\n"${ci.call(o)}"\n\nFor more information, please check the "cause" property of this error.`}(s,o)),this.cause=o}},di=class extends ui{constructor(s){super("parsing",s)}},hi=class extends ui{constructor(s){super("serialization",s)}},fi=class extends ui{constructor(s){super("deserialization",s)}},pi=class extends Error{constructor(s){super(`The value ${ci.call(s)} of type "${typeof s}" cannot be parsed/serialized.\n      \nThere are few workarounds for this problem:\n- Transform the value in a way that it can be serialized.\n- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=s}},mi=class extends Error{constructor(s){super('Unsupported node type "'+s.t+'".')}},gi=class extends Error{constructor(s){super('Missing plugin for tag "'+s+'".')}},yi=class extends Error{constructor(s){super('Missing "'+s+'" instance.')}},bi=class extends Error{constructor(s){super('Missing reference for the value "'+ci.call(s)+'" of type "'+typeof s+'"'),this.value=s}},wi=class extends Error{constructor(s){super('Missing reference for id "'+d(s)+'"')}},vi=class extends Error{constructor(s){super('Unknown TypedArray "'+s+'"')}},Si=class{constructor(s,o){this.value=s,this.replacement=o}};function z$3(s,o,a){return 2&s?(1===o.length?o[0]:"("+o.join(",")+")")+"=>"+(a.startsWith("{")?"("+a+")":a):"function("+o.join(",")+"){return "+a+"}"}function S(s,o,a){return 2&s?(1===o.length?o[0]:"("+o.join(",")+")")+"=>{"+a+"}":"function("+o.join(",")+"){"+a+"}"}var xi={},$i={},_i={0:{},1:{},2:{},3:{},4:{}};function cr(s,o){switch(o){case 0:return"[]";case 1:return function(s){return z$3(s,["r"],"(r.p=new Promise("+S(s,["s","f"],"r.s=s,r.f=f")+"))")}(s);case 2:return function(s){return S(s,["r","d"],"r.s(d),r.p.s=1,r.p.v=d")}(s);case 3:return function(s){return S(s,["r","d"],"r.f(d),r.p.s=2,r.p.v=d")}(s);case 4:return function(s){return z$3(s,["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+S(s,["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+S(s,["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],(!a&&x===z-1)?o[s?"return":"throw"](c):o.next(c))')+",e="+z$3(s,["o","t"],"(a&&(l[t=p++]=o),n(o),"+S(s,[],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+z$3(s,["o"],"e(o)")+",next:"+S(s,["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+S(s,["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+S(s,["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})")}(s);default:return""}}function re$3(){let s,o;return{promise:new Promise(((a,c)=>{s=a,o=c})),resolve(o){s(o)},reject(s){o(s)}}}function K$4(){let s=new Set,o=[],a=!0,c=!0;return{__SEROVAL_STREAM__:!0,on(u){a&&s.add(u);for(let s=0,p=o.length;s<p;s++){let w=o[s];s!==p-1||a?u.next(w):c?u.return(w):u.throw(w)}return()=>{a&&s.delete(u)}},next(c){a&&(o.push(c),function(o){for(let a of s.keys())a.next(o)}(c))},throw(u){a&&(o.push(u),function(o){for(let a of s.keys())a.throw(o)}(u),a=!1,c=!1,s.clear())},return(u){a&&(o.push(u),function(o){for(let a of s.keys())a.return(o)}(u),a=!1,c=!0,s.clear())}}}function ur(s){return()=>{let o=[],a=[],c=0,u=-1,p=!1;function i(){for(let s=0,o=a.length;s<o;s++)a[s].resolve({done:!0,value:void 0})}return s.on({next(s){let c=a.shift();c&&c.resolve({done:!1,value:s}),o.push(s)},throw(s){let c=a.shift();c&&c.reject(s),i(),u=o.length,o.push(s),p=!0},return(s){let c=a.shift();c&&c.resolve({done:!0,value:s}),i(),u=o.length,o.push(s)}}),{[Symbol.asyncIterator](){return this},async next(){if(-1===u){let s=c++;if(s>=o.length){let s=re$3();return a.push(s),await s.promise}return{done:!1,value:o[s]}}return c>u?{done:!0,value:void 0}:function(){let s=c++,a=o[s];if(s!==u)return{done:!1,value:a};if(p)throw a;return{done:!0,value:a}}()}}}}function J$4(s){let o=[],a=-1,c=-1,u=s[Symbol.iterator]();for(;;)try{let s=u.next();if(o.push(s.value),s.done){c=o.length-1;break}}catch(s){a=o.length,o.push(s)}return{v:o,t:a,d:c}}var Ei=class{constructor(s){this.marked=new Set,this.plugins=s.plugins,this.features=31^(s.disabledFeatures||0),this.refs=s.refs||new Map}markRef(s){this.marked.add(s)}isMarked(s){return this.marked.has(s)}createIndex(s){let o=this.refs.size;return this.refs.set(s,o),o}getIndexedValue(s){let o=this.refs.get(s);return null!=o?(this.markRef(o),{type:1,value:sr(o)}):{type:0,value:this.createIndex(s)}}getReference(s){let o=this.getIndexedValue(s);return 1===o.type?o:je$1(s)?{type:2,value:nr(o.value,s)}:o}parseWellKnownSymbol(s){let o=this.getReference(s);return 0!==o.type?o.value:(f$1(s in Vn,new pi(s)),function(s,o){return u$1(17,s,Vn[o],ei,ei,ei,ei,ei,ei,ei,ei,ei)}(o.value,s))}parseSpecialReference(s){let o=this.getIndexedValue(_i[s]);return 1===o.type?o.value:u$1(26,o.value,s,ei,ei,ei,ei,ei,ei,ei,ei,ei)}parseIteratorFactory(){let s=this.getIndexedValue(xi);return 1===s.type?s.value:u$1(27,s.value,ei,ei,ei,ei,ei,ei,ei,this.parseWellKnownSymbol(Symbol.iterator),ei,ei)}parseAsyncIteratorFactory(){let s=this.getIndexedValue($i);return 1===s.type?s.value:u$1(29,s.value,ei,ei,ei,ei,ei,ei,[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],ei,ei,ei)}createObjectNode(s,o,a,c){return u$1(a?11:10,s,ei,ei,ei,ei,c,ei,ei,ei,ei,fe$2(o))}createMapNode(s,o,a,c){return u$1(8,s,ei,ei,ei,ei,ei,{k:o,v:a,s:c},ei,this.parseSpecialReference(0),ei,ei)}createPromiseConstructorNode(s,o){return u$1(22,s,o,ei,ei,ei,ei,ei,ei,this.parseSpecialReference(1),ei,ei)}};function mr(s,o){switch(o){case 3:return Object.freeze(s);case 1:return Object.preventExtensions(s);case 2:return Object.seal(s);default:return s}}var Ri=class{constructor(s){this.plugins=s.plugins,this.refs=s.refs||new Map}deserializeReference(s){return this.assignIndexedValue(s.i,Je$1(N$3(s.s)))}deserializeArray(s){let o,a=s.l,c=this.assignIndexedValue(s.i,new Array(a));for(let u=0;u<a;u++)o=s.a[u],o&&(c[u]=this.deserialize(o));return mr(c,s.o),c}deserializeProperties(s,o){let a=s.s;if(a){let c=s.k,u=s.v;for(let s,p=0;p<a;p++)s=c[p],"string"==typeof s?o[N$3(s)]=this.deserialize(u[p]):o[this.deserialize(s)]=this.deserialize(u[p])}return o}deserializeObject(s){let o=this.assignIndexedValue(s.i,10===s.t?{}:Object.create(null));return this.deserializeProperties(s.p,o),mr(o,s.o),o}deserializeDate(s){return this.assignIndexedValue(s.i,new Date(s.s))}deserializeRegExp(s){return this.assignIndexedValue(s.i,new RegExp(N$3(s.c),s.m))}deserializeSet(s){let o=this.assignIndexedValue(s.i,new Set),a=s.a;for(let c=0,u=s.l;c<u;c++)o.add(this.deserialize(a[c]));return o}deserializeMap(s){let o=this.assignIndexedValue(s.i,new Map),a=s.e.k,c=s.e.v;for(let u=0,p=s.e.s;u<p;u++)o.set(this.deserialize(a[u]),this.deserialize(c[u]));return o}deserializeArrayBuffer(s){let o=new Uint8Array(s.s);return this.assignIndexedValue(s.i,o.buffer)}deserializeTypedArray(s){let o=function(s){switch(s){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new vi(s)}}(s.c),a=this.deserialize(s.f);return this.assignIndexedValue(s.i,new o(a,s.b,s.l))}deserializeDataView(s){let o=this.deserialize(s.f);return this.assignIndexedValue(s.i,new DataView(o,s.b,s.l))}deserializeDictionary(s,o){if(s.p){let a=this.deserializeProperties(s.p,{});Object.assign(o,a)}return o}deserializeAggregateError(s){let o=this.assignIndexedValue(s.i,new AggregateError([],N$3(s.m)));return this.deserializeDictionary(s,o)}deserializeError(s){let o=Xn[s.s],a=this.assignIndexedValue(s.i,new o(N$3(s.m)));return this.deserializeDictionary(s,a)}deserializePromise(s){let o=re$3(),a=this.assignIndexedValue(s.i,o),c=this.deserialize(s.f);return s.s?o.resolve(c):o.reject(c),a.promise}deserializeBoxed(s){return this.assignIndexedValue(s.i,Object(this.deserialize(s.f)))}deserializePlugin(s){let o=this.plugins;if(o){let a=N$3(s.c);for(let c=0,u=o.length;c<u;c++){let u=o[c];if(u.tag===a)return this.assignIndexedValue(s.i,u.deserialize(s.s,this,{id:s.i}))}}throw new gi(s.c)}deserializePromiseConstructor(s){return this.assignIndexedValue(s.i,re$3()).promise}deserializePromiseResolve(s){let o=this.refs.get(s.i);f$1(o,new yi("Promise")),o.resolve(this.deserialize(s.a[1]))}deserializePromiseReject(s){let o=this.refs.get(s.i);f$1(o,new yi("Promise")),o.reject(this.deserialize(s.a[1]))}deserializeIteratorFactoryInstance(s){return this.deserialize(s.a[0]),function(s){return()=>{let o=0;return{[Symbol.iterator](){return this},next(){if(o>s.d)return{done:!0,value:ei};let a=o++,c=s.v[a];if(a===s.t)throw c;return{done:a===s.d,value:c}}}}}(this.deserialize(s.a[1]))}deserializeAsyncIteratorFactoryInstance(s){return this.deserialize(s.a[0]),ur(this.deserialize(s.a[1]))}deserializeStreamConstructor(s){let o=this.assignIndexedValue(s.i,K$4()),a=s.a.length;if(a)for(let o=0;o<a;o++)this.deserialize(s.a[o]);return o}deserializeStreamNext(s){let o=this.refs.get(s.i);f$1(o,new yi("Stream")),o.next(this.deserialize(s.f))}deserializeStreamThrow(s){let o=this.refs.get(s.i);f$1(o,new yi("Stream")),o.throw(this.deserialize(s.f))}deserializeStreamReturn(s){let o=this.refs.get(s.i);f$1(o,new yi("Stream")),o.return(this.deserialize(s.f))}deserializeIteratorFactory(s){this.deserialize(s.f)}deserializeAsyncIteratorFactory(s){this.deserialize(s.a[1])}deserialize(s){try{switch(s.t){case 2:return Yn[s.s];case 0:return s.s;case 1:return N$3(s.s);case 3:return BigInt(s.s);case 4:return this.refs.get(s.i);case 18:return this.deserializeReference(s);case 9:return this.deserializeArray(s);case 10:case 11:return this.deserializeObject(s);case 5:return this.deserializeDate(s);case 6:return this.deserializeRegExp(s);case 7:return this.deserializeSet(s);case 8:return this.deserializeMap(s);case 19:return this.deserializeArrayBuffer(s);case 16:case 15:return this.deserializeTypedArray(s);case 20:return this.deserializeDataView(s);case 14:return this.deserializeAggregateError(s);case 13:return this.deserializeError(s);case 12:return this.deserializePromise(s);case 17:return Jn[s.s];case 21:return this.deserializeBoxed(s);case 25:return this.deserializePlugin(s);case 22:return this.deserializePromiseConstructor(s);case 23:return this.deserializePromiseResolve(s);case 24:return this.deserializePromiseReject(s);case 28:return this.deserializeIteratorFactoryInstance(s);case 30:return this.deserializeAsyncIteratorFactoryInstance(s);case 31:return this.deserializeStreamConstructor(s);case 32:return this.deserializeStreamNext(s);case 33:return this.deserializeStreamThrow(s);case 34:return this.deserializeStreamReturn(s);case 27:return this.deserializeIteratorFactory(s);case 29:return this.deserializeAsyncIteratorFactory(s);default:throw new mi(s)}}catch(s){throw new fi(s)}}},Ti=/^[$A-Z_][0-9A-Z_$]*$/i;function Le(s){let o=s[0];return("$"===o||"_"===o||o>="A"&&o<="Z"||o>="a"&&o<="z")&&Ti.test(s)}function se$3(s){switch(s.t){case 0:return s.s+"="+s.v;case 2:return s.s+".set("+s.k+","+s.v+")";case 1:return s.s+".add("+s.v+")";case 3:return s.s+".delete("+s.k+")"}}function fr(s){if(s.length){let o="",a=function(s){let o=[],a=s[0];for(let c,u=1,p=s.length,w=a;u<p;u++)c=s[u],0===c.t&&c.v===w.v?a={t:0,s:c.s,k:ei,v:se$3(a)}:2===c.t&&c.s===w.s?a={t:2,s:se$3(a),k:c.k,v:c.v}:1===c.t&&c.s===w.s?a={t:1,s:se$3(a),k:ei,v:c.v}:3===c.t&&c.s===w.s?a={t:3,s:se$3(a),k:c.k,v:ei}:(o.push(a),a=c),w=c;return o.push(a),o}(s);for(let s=0,c=a.length;s<c;s++)o+=se$3(a[s])+",";return o}return ei}var Ai={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:ei},Ci=class{constructor(s){this.stack=[],this.flags=[],this.assignments=[],this.plugins=s.plugins,this.features=s.features,this.marked=new Set(s.markedRefs)}createFunction(s,o){return z$3(this.features,s,o)}createEffectfulFunction(s,o){return S(this.features,s,o)}markRef(s){this.marked.add(s)}isMarked(s){return this.marked.has(s)}pushObjectFlag(s,o){0!==s&&(this.markRef(o),this.flags.push({type:s,value:this.getRefParam(o)}))}resolveFlags(){let s="";for(let o=0,a=this.flags,c=a.length;o<c;o++){let c=a[o];s+=Ai[c.type]+"("+c.value+"),"}return s}resolvePatches(){let s=fr(this.assignments),o=this.resolveFlags();return s?o?s+o:s:o}createAssignment(s,o){this.assignments.push({t:0,s:s,k:ei,v:o})}createAddAssignment(s,o){this.assignments.push({t:1,s:this.getRefParam(s),k:ei,v:o})}createSetAssignment(s,o,a){this.assignments.push({t:2,s:this.getRefParam(s),k:o,v:a})}createDeleteAssignment(s,o){this.assignments.push({t:3,s:this.getRefParam(s),k:o,v:ei})}createArrayAssign(s,o,a){this.createAssignment(this.getRefParam(s)+"["+o+"]",a)}createObjectAssign(s,o,a){this.createAssignment(this.getRefParam(s)+"."+o,a)}isIndexedValueInStack(s){return 4===s.t&&this.stack.includes(s.i)}serializeReference(s){return this.assignIndexedValue(s.i,Bn+'.get("'+s.s+'")')}serializeArrayItem(s,o,a){return o?this.isIndexedValueInStack(o)?(this.markRef(s),this.createArrayAssign(s,a,this.getRefParam(o.i)),""):this.serialize(o):""}serializeArray(s){let o=s.i;if(s.l){this.stack.push(o);let a=s.a,c=this.serializeArrayItem(o,a[0],0),u=""===c;for(let p,w=1,v=s.l;w<v;w++)p=this.serializeArrayItem(o,a[w],w),c+=","+p,u=""===p;return this.stack.pop(),this.pushObjectFlag(s.o,s.i),this.assignIndexedValue(o,"["+c+(u?",]":"]"))}return this.assignIndexedValue(o,"[]")}serializeProperty(s,o,a){if("string"==typeof o){let c=Number(o),u=c>=0&&c.toString()===o||Le(o);if(this.isIndexedValueInStack(a)){let p=this.getRefParam(a.i);return this.markRef(s.i),u&&c!=c?this.createObjectAssign(s.i,o,p):this.createArrayAssign(s.i,u?o:'"'+o+'"',p),""}return(u?o:'"'+o+'"')+":"+this.serialize(a)}return"["+this.serialize(o)+"]:"+this.serialize(a)}serializeProperties(s,o){let a=o.s;if(a){let c=o.k,u=o.v;this.stack.push(s.i);let p=this.serializeProperty(s,c[0],u[0]);for(let o=1,w=p;o<a;o++)w=this.serializeProperty(s,c[o],u[o]),p+=(w&&p&&",")+w;return this.stack.pop(),"{"+p+"}"}return"{}"}serializeObject(s){return this.pushObjectFlag(s.o,s.i),this.assignIndexedValue(s.i,this.serializeProperties(s,s.p))}serializeWithObjectAssign(s,o,a){let c=this.serializeProperties(s,o);return"{}"!==c?"Object.assign("+a+","+c+")":a}serializeStringKeyAssignment(s,o,a,c){let u=this.serialize(c),p=Number(a),w=p>=0&&p.toString()===a||Le(a);if(this.isIndexedValueInStack(c))w&&p!=p?this.createObjectAssign(s.i,a,u):this.createArrayAssign(s.i,w?a:'"'+a+'"',u);else{let c=this.assignments;this.assignments=o,w&&p!=p?this.createObjectAssign(s.i,a,u):this.createArrayAssign(s.i,w?a:'"'+a+'"',u),this.assignments=c}}serializeAssignment(s,o,a,c){if("string"==typeof a)this.serializeStringKeyAssignment(s,o,a,c);else{let u=this.stack;this.stack=[];let p=this.serialize(c);this.stack=u;let w=this.assignments;this.assignments=o,this.createArrayAssign(s.i,this.serialize(a),p),this.assignments=w}}serializeAssignments(s,o){let a=o.s;if(a){let c=[],u=o.k,p=o.v;this.stack.push(s.i);for(let o=0;o<a;o++)this.serializeAssignment(s,c,u[o],p[o]);return this.stack.pop(),fr(c)}return ei}serializeDictionary(s,o){if(s.p)if(8&this.features)o=this.serializeWithObjectAssign(s,s.p,o);else{this.markRef(s.i);let a=this.serializeAssignments(s,s.p);if(a)return"("+this.assignIndexedValue(s.i,o)+","+a+this.getRefParam(s.i)+")"}return this.assignIndexedValue(s.i,o)}serializeNullConstructor(s){return this.pushObjectFlag(s.o,s.i),this.serializeDictionary(s,"Object.create(null)")}serializeDate(s){return this.assignIndexedValue(s.i,'new Date("'+s.s+'")')}serializeRegExp(s){return this.assignIndexedValue(s.i,"/"+s.c+"/"+s.m)}serializeSetItem(s,o){return this.isIndexedValueInStack(o)?(this.markRef(s),this.createAddAssignment(s,this.getRefParam(o.i)),""):this.serialize(o)}serializeSet(s){let o="new Set",a=s.l,c=s.i;if(a){let u=s.a;this.stack.push(c);let p=this.serializeSetItem(c,u[0]);for(let s=1,o=p;s<a;s++)o=this.serializeSetItem(c,u[s]),p+=(o&&p&&",")+o;this.stack.pop(),p&&(o+="(["+p+"])")}return this.assignIndexedValue(c,o)}serializeMapEntry(s,o,a,c){if(this.isIndexedValueInStack(o)){let u=this.getRefParam(o.i);if(this.markRef(s),this.isIndexedValueInStack(a)){let o=this.getRefParam(a.i);return this.createSetAssignment(s,u,o),""}if(4!==a.t&&null!=a.i&&this.isMarked(a.i)){let o="("+this.serialize(a)+",["+c+","+c+"])";return this.createSetAssignment(s,u,this.getRefParam(a.i)),this.createDeleteAssignment(s,c),o}let p=this.stack;return this.stack=[],this.createSetAssignment(s,u,this.serialize(a)),this.stack=p,""}if(this.isIndexedValueInStack(a)){let u=this.getRefParam(a.i);if(this.markRef(s),4!==o.t&&null!=o.i&&this.isMarked(o.i)){let a="("+this.serialize(o)+",["+c+","+c+"])";return this.createSetAssignment(s,this.getRefParam(o.i),u),this.createDeleteAssignment(s,c),a}let p=this.stack;return this.stack=[],this.createSetAssignment(s,this.serialize(o),u),this.stack=p,""}return"["+this.serialize(o)+","+this.serialize(a)+"]"}serializeMap(s){let o="new Map",a=s.e.s,c=s.i,u=s.f,p=this.getRefParam(u.i);if(a){let u=s.e.k,w=s.e.v;this.stack.push(c);let v=this.serializeMapEntry(c,u[0],w[0],p);for(let s=1,o=v;s<a;s++)o=this.serializeMapEntry(c,u[s],w[s],p),v+=(o&&v&&",")+o;this.stack.pop(),v&&(o+="(["+v+"])")}return 26===u.t&&(this.markRef(u.i),o="("+this.serialize(u)+","+o+")"),this.assignIndexedValue(c,o)}serializeArrayBuffer(s){let o="new Uint8Array(",a=s.s,c=a.length;if(c){o+="["+a[0];for(let s=1;s<c;s++)o+=","+a[s];o+="]"}return this.assignIndexedValue(s.i,o+").buffer")}serializeTypedArray(s){return this.assignIndexedValue(s.i,"new "+s.c+"("+this.serialize(s.f)+","+s.b+","+s.l+")")}serializeDataView(s){return this.assignIndexedValue(s.i,"new DataView("+this.serialize(s.f)+","+s.b+","+s.l+")")}serializeAggregateError(s){let o=s.i;this.stack.push(o);let a=this.serializeDictionary(s,'new AggregateError([],"'+s.m+'")');return this.stack.pop(),a}serializeError(s){return this.serializeDictionary(s,"new "+Zn[s.s]+'("'+s.m+'")')}serializePromise(s){let o,a=s.f,c=s.i,u=s.s?"Promise.resolve":"Promise.reject";if(this.isIndexedValueInStack(a)){let c=this.getRefParam(a.i);o=u+(s.s?"().then("+this.createFunction([],c)+")":"().catch("+this.createEffectfulFunction([],"throw "+c)+")")}else{this.stack.push(c);let s=this.serialize(a);this.stack.pop(),o=u+"("+s+")"}return this.assignIndexedValue(c,o)}serializeWellKnownSymbol(s){return this.assignIndexedValue(s.i,Wn[s.s])}serializeBoxed(s){return this.assignIndexedValue(s.i,"Object("+this.serialize(s.f)+")")}serializePlugin(s){let o=this.plugins;if(o)for(let a=0,c=o.length;a<c;a++){let c=o[a];if(c.tag===s.c)return this.assignIndexedValue(s.i,c.serialize(s.s,this,{id:s.i}))}throw new gi(s.c)}getConstructor(s){let o=this.serialize(s);return o===this.getRefParam(s.i)?o:"("+o+")"}serializePromiseConstructor(s){let o=this.assignIndexedValue(s.s,"{p:0,s:0,f:0}");return this.assignIndexedValue(s.i,this.getConstructor(s.f)+"("+o+")")}serializePromiseResolve(s){return this.getConstructor(s.a[0])+"("+this.getRefParam(s.i)+","+this.serialize(s.a[1])+")"}serializePromiseReject(s){return this.getConstructor(s.a[0])+"("+this.getRefParam(s.i)+","+this.serialize(s.a[1])+")"}serializeSpecialReference(s){return this.assignIndexedValue(s.i,cr(this.features,s.s))}serializeIteratorFactory(s){let o="",a=!1;return 4!==s.f.t&&(this.markRef(s.f.i),o="("+this.serialize(s.f)+",",a=!0),o+=this.assignIndexedValue(s.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(s.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),a&&(o+=")"),o}serializeIteratorFactoryInstance(s){return this.getConstructor(s.a[0])+"("+this.serialize(s.a[1])+")"}serializeAsyncIteratorFactory(s){let o=s.a[0],a=s.a[1],c="";4!==o.t&&(this.markRef(o.i),c+="("+this.serialize(o)),4!==a.t&&(this.markRef(a.i),c+=(c?",":"(")+this.serialize(a)),c&&(c+=",");let u=this.assignIndexedValue(s.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(a.i)+"]:"+this.createFunction([],"t.p")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?("+this.getRefParam(o.i)+"(t={p:0,s:0,f:0}),p.push(t),t.p):{done:!1,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return c?c+u+")":u}serializeAsyncIteratorFactoryInstance(s){return this.getConstructor(s.a[0])+"("+this.serialize(s.a[1])+")"}serializeStreamConstructor(s){let o=this.assignIndexedValue(s.i,this.getConstructor(s.f)+"()"),a=s.a.length;if(a){let c=this.serialize(s.a[0]);for(let o=1;o<a;o++)c+=","+this.serialize(s.a[o]);return"("+o+","+c+","+this.getRefParam(s.i)+")"}return o}serializeStreamNext(s){return this.getRefParam(s.i)+".next("+this.serialize(s.f)+")"}serializeStreamThrow(s){return this.getRefParam(s.i)+".throw("+this.serialize(s.f)+")"}serializeStreamReturn(s){return this.getRefParam(s.i)+".return("+this.serialize(s.f)+")"}serialize(s){try{switch(s.t){case 2:return Gn[s.s];case 0:return""+s.s;case 1:return'"'+s.s+'"';case 3:return s.s+"n";case 4:return this.getRefParam(s.i);case 18:return this.serializeReference(s);case 9:return this.serializeArray(s);case 10:return this.serializeObject(s);case 11:return this.serializeNullConstructor(s);case 5:return this.serializeDate(s);case 6:return this.serializeRegExp(s);case 7:return this.serializeSet(s);case 8:return this.serializeMap(s);case 19:return this.serializeArrayBuffer(s);case 16:case 15:return this.serializeTypedArray(s);case 20:return this.serializeDataView(s);case 14:return this.serializeAggregateError(s);case 13:return this.serializeError(s);case 12:return this.serializePromise(s);case 17:return this.serializeWellKnownSymbol(s);case 21:return this.serializeBoxed(s);case 22:return this.serializePromiseConstructor(s);case 23:return this.serializePromiseResolve(s);case 24:return this.serializePromiseReject(s);case 25:return this.serializePlugin(s);case 26:return this.serializeSpecialReference(s);case 27:return this.serializeIteratorFactory(s);case 28:return this.serializeIteratorFactoryInstance(s);case 29:return this.serializeAsyncIteratorFactory(s);case 30:return this.serializeAsyncIteratorFactoryInstance(s);case 31:return this.serializeStreamConstructor(s);case 32:return this.serializeStreamNext(s);case 33:return this.serializeStreamThrow(s);case 34:return this.serializeStreamReturn(s);default:throw new mi(s)}}catch(s){throw new hi(s)}}},ki=class extends Ci{constructor(s){super(s),this.mode="cross",this.scopeId=s.scopeId}getRefParam(s){return"$R["+s+"]"}assignIndexedValue(s,o){return this.getRefParam(s)+"="+o}serializeTop(s){let o=this.serialize(s),a=s.i;if(null==a)return o;let c=this.resolvePatches(),u=this.getRefParam(a),p=null==this.scopeId?"":Dn,w=c?"("+o+","+c+u+")":o;if(""===p)return 10!==s.t||c?w:"("+w+")";let v=null==this.scopeId?"()":'($R["'+d(this.scopeId)+'"])';return"("+this.createFunction([p],w)+")"+v}},qi=class extends Ei{parseItems(s){let o=[];for(let a=0,c=s.length;a<c;a++)a in s&&(o[a]=this.parseTop(s[a]));return o}parseArray(s,o){return function(s,o,a){return u$1(9,s,ei,o.length,ei,ei,ei,ei,a,ei,ei,fe$2(o))}(s,o,this.parseItems(o))}parseProperties(s){let o=Object.entries(s),a=[],c=[];for(let s=0,u=o.length;s<u;s++)a.push(d(o[s][0])),c.push(this.parseTop(o[s][1]));let u=Symbol.iterator;return u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(M(this.parseIteratorFactory(),this.parseTop(J$4(s))))),u=Symbol.asyncIterator,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(U$1(this.parseAsyncIteratorFactory(),this.parseTop(K$4())))),u=Symbol.toStringTag,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(w$2(s[u]))),u=Symbol.isConcatSpreadable,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(s[u]?ti:ri)),{k:a,v:c,s:a.length}}parsePlainObject(s,o,a){return this.createObjectNode(s,o,a,this.parseProperties(o))}parseBoxed(s,o){return function(s,o){return u$1(21,s,ei,ei,ei,ei,ei,ei,ei,o,ei,ei)}(s,this.parseTop(o.valueOf()))}parseTypedArray(s,o){return function(s,o,a){return u$1(15,s,ei,o.length,o.constructor.name,ei,ei,ei,ei,a,o.byteOffset,ei)}(s,o,this.parseTop(o.buffer))}parseBigIntTypedArray(s,o){return function(s,o,a){return u$1(16,s,ei,o.length,o.constructor.name,ei,ei,ei,ei,a,o.byteOffset,ei)}(s,o,this.parseTop(o.buffer))}parseDataView(s,o){return function(s,o,a){return u$1(20,s,ei,o.byteLength,ei,ei,ei,ei,ei,a,o.byteOffset,ei)}(s,o,this.parseTop(o.buffer))}parseError(s,o){let a=j$2(o,this.features);return function(s,o,a){return u$1(13,s,me$2(o),ei,ei,d(o.message),a,ei,ei,ei,ei,ei)}(s,o,a?this.parseProperties(a):ei)}parseAggregateError(s,o){let a=j$2(o,this.features);return function(s,o,a){return u$1(14,s,me$2(o),ei,ei,d(o.message),a,ei,ei,ei,ei,ei)}(s,o,a?this.parseProperties(a):ei)}parseMap(s,o){let a=[],c=[];for(let[s,u]of o.entries())a.push(this.parseTop(s)),c.push(this.parseTop(u));return this.createMapNode(s,a,c,o.size)}parseSet(s,o){let a=[];for(let s of o.keys())a.push(this.parseTop(s));return function(s,o,a){return u$1(7,s,ei,o,ei,ei,ei,ei,a,ei,ei,ei)}(s,o.size,a)}parsePlugin(s,o){let a=this.plugins;if(a)for(let c=0,u=a.length;c<u;c++){let u=a[c];if(u.parse.sync&&u.test(o))return _$4(s,u.tag,u.parse.sync(o,this,{id:s}))}}parseStream(s,o){return L$2(s,this.parseSpecialReference(4),[])}parsePromise(s,o){return this.createPromiseConstructorNode(s,this.createIndex({}))}parseObject(s,o){if(Array.isArray(o))return this.parseArray(s,o);if(function(s){return"__SEROVAL_STREAM__"in s}(o))return this.parseStream(s,o);let a=o.constructor;if(a===Si)return this.parseTop(o.replacement);let c=this.parsePlugin(s,o);if(c)return c;switch(a){case Object:return this.parsePlainObject(s,o,!1);case void 0:return this.parsePlainObject(s,o,!0);case Date:return function(s,o){let a=o.valueOf();return u$1(5,s,a!=a?"":o.toISOString(),ei,ei,ei,ei,ei,ei,ei,ei,ei)}(s,o);case RegExp:return function(s,o){return u$1(6,s,ei,ei,d(o.source),o.flags,ei,ei,ei,ei,ei,ei)}(s,o);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(s,o);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(s,o);case ArrayBuffer:return function(s,o){let a=new Uint8Array(o),c=a.length,u=new Array(c);for(let s=0;s<c;s++)u[s]=a[s];return u$1(19,s,u,ei,ei,ei,ei,ei,ei,ei,ei,ei)}(s,o);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(s,o);case DataView:return this.parseDataView(s,o);case Map:return this.parseMap(s,o);case Set:return this.parseSet(s,o)}if(a===Promise||o instanceof Promise)return this.parsePromise(s,o);let u=this.features;if(16&u)switch(a){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(s,o)}if(1&u&&"undefined"!=typeof AggregateError&&(a===AggregateError||o instanceof AggregateError))return this.parseAggregateError(s,o);if(o instanceof Error)return this.parseError(s,o);if(Symbol.iterator in o||Symbol.asyncIterator in o)return this.parsePlainObject(s,o,!!a);throw new pi(o)}parseFunction(s){let o=this.getReference(s);if(0!==o.type)return o.value;let a=this.parsePlugin(o.value,s);if(a)return a;throw new pi(s)}parseTop(s){switch(typeof s){case"boolean":return s?ti:ri;case"undefined":return si;case"string":return w$2(s);case"number":return function(s){switch(s){case Number.POSITIVE_INFINITY:return oi;case Number.NEGATIVE_INFINITY:return ai}return s!=s?li:Object.is(s,-0)?ii:u$1(0,ei,s,ei,ei,ei,ei,ei,ei,ei,ei,ei)}(s);case"bigint":return function(s){return u$1(3,ei,""+s,ei,ei,ei,ei,ei,ei,ei,ei,ei)}(s);case"object":if(s){let o=this.getReference(s);return 0===o.type?this.parseObject(o.value,s):o.value}return ni;case"symbol":return this.parseWellKnownSymbol(s);case"function":return this.parseFunction(s);default:throw new pi(s)}}parse(s){try{return this.parseTop(s)}catch(s){throw s instanceof di?s:new di(s)}}},zi=class extends qi{constructor(s){super(s),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=s.onParse,this.onErrorCallback=s.onError,this.onDoneCallback=s.onDone}onParseInternal(s,o){try{this.onParseCallback(s,o)}catch(s){this.onError(s)}}flush(){for(let s=0,o=this.buffer.length;s<o;s++)this.onParseInternal(this.buffer[s],!1)}onParse(s){this.initial?this.buffer.push(s):this.onParseInternal(s,!1)}onError(s){if(!this.onErrorCallback)throw s;this.onErrorCallback(s)}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(s){let o=Object.entries(s),a=[],c=[];for(let s=0,u=o.length;s<u;s++)a.push(d(o[s][0])),c.push(this.parseTop(o[s][1]));let u=Symbol.iterator;return u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(M(this.parseIteratorFactory(),this.parseTop(J$4(s))))),u=Symbol.asyncIterator,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(U$1(this.parseAsyncIteratorFactory(),this.parseTop(function(s){let o=K$4(),a=s[Symbol.asyncIterator]();return async function t(){try{let s=await a.next();s.done?o.return(s.value):(o.next(s.value),await t())}catch(s){o.throw(s)}}().catch((()=>{})),o}(s))))),u=Symbol.toStringTag,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(w$2(s[u]))),u=Symbol.isConcatSpreadable,u in s&&(a.push(this.parseWellKnownSymbol(u)),c.push(s[u]?ti:ri)),{k:a,v:c,s:a.length}}handlePromiseSuccess(s,o){let a=this.parseWithError(o);a&&this.onParse(u$1(23,s,ei,ei,ei,ei,ei,ei,[this.parseSpecialReference(2),a],ei,ei,ei)),this.popPendingState()}handlePromiseFailure(s,o){if(this.alive){let a=this.parseWithError(o);a&&this.onParse(u$1(24,s,ei,ei,ei,ei,ei,ei,[this.parseSpecialReference(3),a],ei,ei,ei))}this.popPendingState()}parsePromise(s,o){let a=this.createIndex({});return o.then(this.handlePromiseSuccess.bind(this,a),this.handlePromiseFailure.bind(this,a)),this.pushPendingState(),this.createPromiseConstructorNode(s,a)}parsePlugin(s,o){let a=this.plugins;if(a)for(let c=0,u=a.length;c<u;c++){let u=a[c];if(u.parse.stream&&u.test(o))return _$4(s,u.tag,u.parse.stream(o,this,{id:s}))}return ei}parseStream(s,o){let a=L$2(s,this.parseSpecialReference(4),[]);return this.pushPendingState(),o.on({next:o=>{if(this.alive){let a=this.parseWithError(o);a&&this.onParse(function(s,o){return u$1(32,s,ei,ei,ei,ei,ei,ei,ei,o,ei,ei)}(s,a))}},throw:o=>{if(this.alive){let a=this.parseWithError(o);a&&this.onParse(function(s,o){return u$1(33,s,ei,ei,ei,ei,ei,ei,ei,o,ei,ei)}(s,a))}this.popPendingState()},return:o=>{if(this.alive){let a=this.parseWithError(o);a&&this.onParse(function(s,o){return u$1(34,s,ei,ei,ei,ei,ei,ei,ei,o,ei,ei)}(s,a))}this.popPendingState()}}),a}parseWithError(s){try{return this.parseTop(s)}catch(s){return this.onError(s),ei}}start(s){let o=this.parseWithError(s);o&&(this.onParseInternal(o,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},Pi=class extends zi{constructor(){super(...arguments),this.mode="cross"}};function gr(s,o){let a=m$1(o.plugins),c=new Pi({plugins:a,refs:o.refs,disabledFeatures:o.disabledFeatures,onParse(s,u){let p,w=new ki({plugins:a,features:c.features,scopeId:o.scopeId,markedRefs:c.marked});try{p=w.serializeTop(s)}catch(s){return void(o.onError&&o.onError(s))}o.onSerialize(p,u)},onError:o.onError,onDone:o.onDone});return c.start(s),c.destroy.bind(c)}var ji=class extends Ri{constructor(s){super(s),this.mode="vanilla",this.marked=new Set(s.markedRefs)}assignIndexedValue(s,o){return this.marked.has(s)&&this.refs.set(s,o),o}};function Lo(s,o={}){let a=m$1(o.plugins);return new ji({plugins:a,markedRefs:s.m}).deserialize(s.t)}var Ii=class{constructor(s){this.options=s,this.alive=!0,this.flushed=!1,this.done=!1,this.pending=0,this.cleanups=[],this.refs=new Map,this.keys=new Set,this.ids=0,this.plugins=m$1(s.plugins)}write(s,o){this.alive&&!this.flushed&&(this.pending++,this.keys.add(s),this.cleanups.push(gr(o,{plugins:this.plugins,scopeId:this.options.scopeId,refs:this.refs,disabledFeatures:this.options.disabledFeatures,onError:this.options.onError,onSerialize:(o,a)=>{this.alive&&this.options.onData(a?this.options.globalIdentifier+'["'+d(s)+'"]='+o:o)},onDone:()=>{this.alive&&(this.pending--,this.pending<=0&&this.flushed&&!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0))}})))}getNextID(){for(;this.keys.has(""+this.ids);)this.ids++;return""+this.ids}push(s){let o=this.getNextID();return this.write(o,s),o}flush(){this.alive&&(this.flushed=!0,this.pending<=0&&!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0))}close(){if(this.alive){for(let s=0,o=this.cleanups.length;s<o;s++)this.cleanups[s]();!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0),this.alive=!1}}};function h(s){s(this.reason)}function A$1(s){this.addEventListener("abort",h.bind(this,s),{once:!0})}function E(s){return new Promise(A$1.bind(s))}var Oi=class{constructor(){this.controller=new AbortController}},Li={tag:"seroval-plugins/web/AbortSignalController",test:s=>s instanceof Oi,parse:{stream(){}},serialize:s=>"new AbortController",deserialize:s=>new Oi},Ni=class{constructor(s,o){this.controller=s,this.reason=o}},Qi={extends:[Li],tag:"seroval-plugins/web/AbortSignalAbort",test:s=>s instanceof Ni,parse:{stream:(s,o)=>({controller:o.parse(s.controller),reason:o.parse(s.reason)})},serialize:(s,o)=>o.serialize(s.controller)+".abort("+o.serialize(s.reason)+")",deserialize(s,o){let a=o.deserialize(s.controller),c=o.deserialize(s.reason);return a.controller.abort(c),new Ni(a,c)}},Bi={tag:"seroval-plugins/web/AbortSignal",extends:[Qi],test:s=>"undefined"!=typeof AbortSignal&&s instanceof AbortSignal,parse:{sync:(s,o)=>s.aborted?{type:1,reason:o.parse(s.reason)}:{type:0},async async(s,o){if(s.aborted)return{type:1,reason:await o.parse(s.reason)};let a=await E(s);return{type:1,reason:await o.parse(a)}},stream(s,o){if(s.aborted)return{type:1,reason:o.parse(s.reason)};let a=new Oi;return o.pushPendingState(),s.addEventListener("abort",(()=>{let c=o.parseWithError(new Ni(a,s.reason));c&&o.onParse(c),o.popPendingState()}),{once:!0}),{type:2,controller:o.parse(a)}}},serialize:(s,o)=>0===s.type?"(new AbortController).signal":1===s.type?"AbortSignal.abort("+o.serialize(s.reason)+")":"("+o.serialize(s.controller)+").signal",deserialize:(s,o)=>0===s.type?(new AbortController).signal:1===s.type?AbortSignal.abort(o.deserialize(s.reason)):o.deserialize(s.controller).controller.signal},Di=Bi;function f(s){return{detail:s.detail,bubbles:s.bubbles,cancelable:s.cancelable,composed:s.composed}}var Mi={tag:"seroval-plugins/web/CustomEvent",test:s=>"undefined"!=typeof CustomEvent&&s instanceof CustomEvent,parse:{sync:(s,o)=>({type:o.parse(s.type),options:o.parse(f(s))}),async:async(s,o)=>({type:await o.parse(s.type),options:await o.parse(f(s))}),stream:(s,o)=>({type:o.parse(s.type),options:o.parse(f(s))})},serialize:(s,o)=>"new CustomEvent("+o.serialize(s.type)+","+o.serialize(s.options)+")",deserialize:(s,o)=>new CustomEvent(o.deserialize(s.type),o.deserialize(s.options))},Hi=Mi,Fi={tag:"seroval-plugins/web/DOMException",test:s=>"undefined"!=typeof DOMException&&s instanceof DOMException,parse:{sync:(s,o)=>({name:o.parse(s.name),message:o.parse(s.message)}),async:async(s,o)=>({name:await o.parse(s.name),message:await o.parse(s.message)}),stream:(s,o)=>({name:o.parse(s.name),message:o.parse(s.message)})},serialize:(s,o)=>"new DOMException("+o.serialize(s.message)+","+o.serialize(s.name)+")",deserialize:(s,o)=>new DOMException(o.deserialize(s.message),o.deserialize(s.name))},Ui=Fi;function m(s){return{bubbles:s.bubbles,cancelable:s.cancelable,composed:s.composed}}var Ki={tag:"seroval-plugins/web/Event",test:s=>"undefined"!=typeof Event&&s instanceof Event,parse:{sync:(s,o)=>({type:o.parse(s.type),options:o.parse(m(s))}),async:async(s,o)=>({type:await o.parse(s.type),options:await o.parse(m(s))}),stream:(s,o)=>({type:o.parse(s.type),options:o.parse(m(s))})},serialize:(s,o)=>"new Event("+o.serialize(s.type)+","+o.serialize(s.options)+")",deserialize:(s,o)=>new Event(o.deserialize(s.type),o.deserialize(s.options))},Wi=Ki,Vi={tag:"seroval-plugins/web/File",test:s=>"undefined"!=typeof File&&s instanceof File,parse:{async:async(s,o)=>({name:await o.parse(s.name),options:await o.parse({type:s.type,lastModified:s.lastModified}),buffer:await o.parse(await s.arrayBuffer())})},serialize:(s,o)=>"new File(["+o.serialize(s.buffer)+"],"+o.serialize(s.name)+","+o.serialize(s.options)+")",deserialize:(s,o)=>new File([o.deserialize(s.buffer)],o.deserialize(s.name),o.deserialize(s.options))},Ji=Vi;function g(s){let o=[];return s.forEach(((s,a)=>{o.push([a,s])})),o}var Gi={},Yi={tag:"seroval-plugins/web/FormDataFactory",test:s=>s===Gi,parse:{sync(){},async:async()=>await Promise.resolve(void 0),stream(){}},serialize:(s,o)=>o.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f"),deserialize:()=>Gi},Zi={tag:"seroval-plugins/web/FormData",extends:[Ji,Yi],test:s=>"undefined"!=typeof FormData&&s instanceof FormData,parse:{sync:(s,o)=>({factory:o.parse(Gi),entries:o.parse(g(s))}),async:async(s,o)=>({factory:await o.parse(Gi),entries:await o.parse(g(s))}),stream:(s,o)=>({factory:o.parse(Gi),entries:o.parse(g(s))})},serialize:(s,o)=>"("+o.serialize(s.factory)+")("+o.serialize(s.entries)+")",deserialize(s,o){let a=new FormData,c=o.deserialize(s.entries);for(let s=0,o=c.length;s<o;s++){let o=c[s];a.append(o[0],o[1])}return a}},Xi=Zi;function y$1(s){let o=[];return s.forEach(((s,a)=>{o.push([a,s])})),o}var eo={tag:"seroval-plugins/web/Headers",test:s=>"undefined"!=typeof Headers&&s instanceof Headers,parse:{sync:(s,o)=>o.parse(y$1(s)),async:async(s,o)=>await o.parse(y$1(s)),stream:(s,o)=>o.parse(y$1(s))},serialize:(s,o)=>"new Headers("+o.serialize(s)+")",deserialize:(s,o)=>new Headers(o.deserialize(s))},to=eo,ro={},so={tag:"seroval-plugins/web/ReadableStreamFactory",test:s=>s===ro,parse:{sync(){},async:async()=>await Promise.resolve(void 0),stream(){}},serialize:(s,o)=>o.createFunction(["d"],"new ReadableStream({start:"+o.createEffectfulFunction(["c"],"d.on({next:"+o.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+o.createEffectfulFunction(["v"],"c.error(v)")+",return:"+o.createEffectfulFunction([],"c.close()")+"})")+"})"),deserialize:()=>ro};function w$1(s){let o=K$4(),a=s.getReader();return async function t(){try{let s=await a.read();s.done?o.return(s.value):(o.next(s.value),await t())}catch(s){o.throw(s)}}().catch((()=>{})),o}var no={tag:"seroval/plugins/web/ReadableStream",extends:[so],test:s=>"undefined"!=typeof ReadableStream&&s instanceof ReadableStream,parse:{sync:(s,o)=>({factory:o.parse(ro),stream:o.parse(K$4())}),async:async(s,o)=>({factory:await o.parse(ro),stream:await o.parse(w$1(s))}),stream:(s,o)=>({factory:o.parse(ro),stream:o.parse(w$1(s))})},serialize:(s,o)=>"("+o.serialize(s.factory)+")("+o.serialize(s.stream)+")",deserialize(s,o){let a=o.deserialize(s.stream);return new ReadableStream({start(s){a.on({next(o){s.enqueue(o)},throw(o){s.error(o)},return(){s.close()}})}})}},io=no;function P$2(s,o){return{body:o,cache:s.cache,credentials:s.credentials,headers:s.headers,integrity:s.integrity,keepalive:s.keepalive,method:s.method,mode:s.mode,redirect:s.redirect,referrer:s.referrer,referrerPolicy:s.referrerPolicy}}var oo={tag:"seroval-plugins/web/Request",extends:[io,to],test:s=>"undefined"!=typeof Request&&s instanceof Request,parse:{async:async(s,o)=>({url:await o.parse(s.url),options:await o.parse(P$2(s,s.body?await s.clone().arrayBuffer():null))}),stream:(s,o)=>({url:o.parse(s.url),options:o.parse(P$2(s,s.clone().body))})},serialize:(s,o)=>"new Request("+o.serialize(s.url)+","+o.serialize(s.options)+")",deserialize:(s,o)=>new Request(o.deserialize(s.url),o.deserialize(s.options))},ao=oo;function N$2(s){return{headers:s.headers,status:s.status,statusText:s.statusText}}var lo={tag:"seroval-plugins/web/Response",extends:[io,to],test:s=>"undefined"!=typeof Response&&s instanceof Response,parse:{async:async(s,o)=>({body:await o.parse(s.body?await s.clone().arrayBuffer():null),options:await o.parse(N$2(s))}),stream:(s,o)=>({body:o.parse(s.clone().body),options:o.parse(N$2(s))})},serialize:(s,o)=>"new Response("+o.serialize(s.body)+","+o.serialize(s.options)+")",deserialize:(s,o)=>new Response(o.deserialize(s.body),o.deserialize(s.options))},co=lo,uo={tag:"seroval-plugins/web/URL",test:s=>"undefined"!=typeof URL&&s instanceof URL,parse:{sync:(s,o)=>o.parse(s.href),async:async(s,o)=>await o.parse(s.href),stream:(s,o)=>o.parse(s.href)},serialize:(s,o)=>"new URL("+o.serialize(s)+")",deserialize:(s,o)=>new URL(o.deserialize(s))},ho=uo,fo={tag:"seroval-plugins/web/URLSearchParams",test:s=>"undefined"!=typeof URLSearchParams&&s instanceof URLSearchParams,parse:{sync:(s,o)=>o.parse(s.toString()),async:async(s,o)=>await o.parse(s.toString()),stream:(s,o)=>o.parse(s.toString())},serialize:(s,o)=>"new URLSearchParams("+o.serialize(s)+")",deserialize:(s,o)=>new URLSearchParams(o.deserialize(s))},po=fo;const mo=Symbol("solid-track"),go=Symbol("error");function castError(s){return s instanceof Error?s:new Error("string"==typeof s?s:"Unknown error",{cause:s})}function handleError(s,o=bo){const a=o&&o.context&&o.context[go],c=castError(s);if(!a)throw c;try{for(const s of a)s(c)}catch(s){handleError(s,o&&o.owner||null)}}const yo={context:null,owner:null,owned:null,cleanups:null};let bo=null;function createOwner(){const s={owner:bo,context:bo?bo.context:null,owned:null,cleanups:null};return bo&&(bo.owned?bo.owned.push(s):bo.owned=[s]),s}function createRoot(s,o){const a=bo,c=a,u=0===s.length?yo:{context:c?c.context:null,owner:c,owned:null,cleanups:null};let p;bo=u;try{p=s(0===s.length?()=>{}:()=>cleanNode(u))}catch(s){handleError(s)}finally{bo=a}return p}function createSignal(s,o){return[()=>s,o=>s="function"==typeof o?o(s):o]}const createRenderEffect=function(s,o){bo=createOwner();try{s(o)}catch(s){handleError(s)}finally{bo=bo.owner}};function createMemo(s,o){let a;bo=createOwner();try{a=s(o)}catch(s){handleError(s)}finally{bo=bo.owner}return()=>a}function batch(s){return s()}const wo=batch;function on$2(s,o,a={}){const c=Array.isArray(s),u=a.defer;return()=>{if(u)return;let a;if(c){a=[];for(let o=0;o<s.length;o++)a.push(s[o]())}else a=s();return o(a)}}function cleanNode(s){if(s.owned){for(let o=0;o<s.owned.length;o++)cleanNode(s.owned[o]);s.owned=null}if(s.cleanups){for(let o=0;o<s.cleanups.length;o++)s.cleanups[o]();s.cleanups=null}}function catchError(s,o){const a=createOwner();a.context={...a.context,[go]:[o]},bo=a;try{return s()}catch(s){handleError(s)}finally{bo=bo.owner}}function createContext(s){const o=Symbol("context");return{id:o,Provider:createProvider(o),defaultValue:s}}function useContext(s){return bo&&bo.context&&void 0!==bo.context[s.id]?bo.context[s.id]:s.defaultValue}function getOwner(){return bo}function children(s){const o=createMemo((()=>resolveChildren(s())));return o.toArray=()=>{const s=o();return Array.isArray(s)?s:null!=s?[s]:[]},o}function runWithOwner(s,o){const a=bo;bo=s;try{return o()}catch(s){handleError(s)}finally{bo=a}}function resolveChildren(s){if("function"==typeof s&&!s.length)return resolveChildren(s());if(Array.isArray(s)){const o=[];for(let a=0;a<s.length;a++){const c=resolveChildren(s[a]);Array.isArray(c)?o.push.apply(o,c):o.push(c)}return o}return s}function createProvider(s){return function(o){return createMemo((()=>(bo.context={...bo.context,[s]:o.value},children((()=>o.children)))))}}function escape$1(s,o){const a=typeof s;if("string"!==a){if("function"===a)return escape$1(s());if(Array.isArray(s)){for(let o=0;o<s.length;o++)s[o]=escape$1(s[o]);return s}return s}const c="&lt;";let u=s.indexOf("<"),p=s.indexOf("&");if(u<0&&p<0)return s;let w=0,v="";for(;u>=0&&p>=0;)u<p?(w<u&&(v+=s.substring(w,u)),v+=c,w=u+1,u=s.indexOf("<",w)):(w<p&&(v+=s.substring(w,p)),v+="&amp;",w=p+1,p=s.indexOf("&",w));if(u>=0)do{w<u&&(v+=s.substring(w,u)),v+=c,w=u+1,u=s.indexOf("<",w)}while(u>=0);else for(;p>=0;)w<p&&(v+=s.substring(w,p)),v+="&amp;",w=p+1,p=s.indexOf("&",w);return w<s.length?v+s.substring(w):v}function resolveSSRNode$1(s){const o=typeof s;if("string"===o)return s;if(null==s||"boolean"===o)return"";if(Array.isArray(s)){let o={},a="";for(let c=0,u=s.length;c<u;c++)"object"!=typeof o&&"object"!=typeof s[c]&&(a+="\x3c!--!$--\x3e"),a+=resolveSSRNode$1(o=s[c]);return a}return"object"===o?s.t:"function"===o?resolveSSRNode$1(s()):String(s)}const vo={context:void 0,getContextId(){if(!this.context)throw new Error("getContextId cannot be used under non-hydrating context");return getContextId(this.context.count)},getNextContextId(){if(!this.context)throw new Error("getNextContextId cannot be used under non-hydrating context");return getContextId(this.context.count++)}};function getContextId(s){const o=String(s),a=o.length-1;return vo.context.id+(a?String.fromCharCode(96+a):"")+o}function setHydrateContext(s){vo.context=s}function createComponent(s,o){if(vo.context&&!vo.context.noHydrate){const a=vo.context;setHydrateContext(vo.context?{...vo.context,id:vo.getNextContextId(),count:0}:void 0);const c=s(o||{});return setHydrateContext(a),c}return s(o||{})}function mergeProps(...s){const o={};for(let a=0;a<s.length;a++){let c=s[a];if("function"==typeof c&&(c=c()),c){const a=Object.getOwnPropertyDescriptors(c);for(const c in a)c in o||Object.defineProperty(o,c,{enumerable:!0,get(){for(let o=s.length-1;o>=0;o--){let a,u=s[o];if("function"==typeof u&&(u=u()),a=(u||{})[c],void 0!==a)return a}}})}}return o}function Show(s){let o;return s.when?"function"==typeof(o=s.children)?o(s.keyed?s.when:()=>s.when):o:s.fallback||""}function ErrorBoundary(s){let o,a,c,u=!0;const p=vo.context,w=vo.getContextId();function displayFallback(){cleanNode(c),p.serialize(w,o),setHydrateContext({...p,count:0});const a=s.fallback;return"function"==typeof a&&a.length?a(o,(()=>{})):a}return createMemo((()=>(c=bo,catchError((()=>a=s.children),(s=>{o=s,!u&&p.replace("e"+w,displayFallback),u=!0}))))),o?displayFallback():(u=!1,{t:`\x3c!--!$e${w}--\x3e${resolveSSRNode$1(escape$1(a))}\x3c!--!$/e${w}--\x3e`})}const So=createContext();let xo=null;function createResource(s,o,a={}){"function"!=typeof o&&(a=o||{},o=s,s=!0);const c=new Set,u=vo.getNextContextId();let p,w,v={},$=a.storage?a.storage(a.initialValue)[0]():a.initialValue;if(vo.context.async&&"initial"!==a.ssrLoadFrom&&(v=vo.context.resources[u]||(vo.context.resources[u]={}),v.ref))return v.data||v.ref[0].loading||v.ref[0].error||v.ref[1].refetch(),v.ref;const read=()=>{if(w)throw w;const s="initial"!==a.ssrLoadFrom&&vo.context.async&&"data"in vo.context.resources[u];if(!s&&xo&&xo.push(u),!s&&read.loading){const s=useContext(So);s&&(s.resources.set(u,read),c.add(s))}return s?vo.context.resources[u].data:$};function load(){const v=vo.context;if(!v.async)return read.loading=!!("function"==typeof s?s():s);if(v.resources&&u in v.resources&&"data"in v.resources[u])return void($=v.resources[u].data);let C;try{if(xo=[],C="function"==typeof s?s():s,xo.length)return}finally{xo=null}if(!p){if(null==C||!1===C)return;p=o(C,{value:$})}return null!=p&&"object"==typeof p&&"then"in p?(read.loading=!0,read.state="pending",p=p.then((s=>(read.loading=!1,read.state="ready",v.resources[u].data=s,p=null,notifySuspense(c),s))).catch((s=>{throw read.loading=!1,read.state="errored",read.error=w=castError(s),p=null,notifySuspense(c),w})),v.serialize&&v.serialize(u,p,a.deferStream),p):(v.resources[u].data=p,v.serialize&&v.serialize(u,p),p=null,v.resources[u].data)}return read.loading=!1,read.error=void 0,read.state="initialValue"in a?"ready":"unresolved",Object.defineProperty(read,"latest",{get:()=>read()}),"initial"!==a.ssrLoadFrom&&load(),v.ref=[read,{refetch:load,mutate:s=>$=s}]}function lazy(s){let o,load=a=>(o||(o=s(),o.then((s=>o.resolved=s.default)),a&&(vo.context.lazy[a]=o)),o);const a=new Set,wrap=s=>{const c=vo.context.id;let u=vo.context.lazy[c];if(u?o=u:load(c),o.resolved)return o.resolved(s);const p=useContext(So),w={loading:!0,error:void 0};return p&&(p.resources.set(c,w),a.add(p)),vo.context.async&&vo.context.block(o.then((()=>{w.loading=!1,notifySuspense(a)}))),""};return wrap.preload=load,wrap}function suspenseComplete(s){for(const o of s.resources.values())if(o.loading)return!1;return!0}function notifySuspense(s){for(const o of s)suspenseComplete(o)&&(o.completed(),s.delete(o))}function startTransition(s){s()}function Suspense(s){let o;const a=vo.context,c=vo.getContextId(),u=createOwner(),p=a.suspense[c]||(a.suspense[c]={resources:new Map,completed:()=>{const s=runSuspense();suspenseComplete(p)&&o(resolveSSRNode$1(escape$1(s)))}});function suspenseError(s){o&&o(void 0,s)||runWithOwner(u.owner,(()=>{throw s}))}function runSuspense(){return setHydrateContext({...a,count:0}),cleanNode(u),runWithOwner(u,(()=>createComponent(So.Provider,{value:p,get children(){return catchError((()=>s.children),suspenseError)}})))}const w=runSuspense();return suspenseComplete(p)?(delete a.suspense[c],w):(o=a.async?a.registerFragment(c):void 0,catchError((()=>{if(a.async){setHydrateContext({...a,count:0,id:a.id+"0F",noHydrate:!0});const o={t:`<template id="pl-${c}"></template>${resolveSSRNode$1(escape$1(s.fallback))}\x3c!--pl-${c}--\x3e`};return setHydrateContext(a),o}return setHydrateContext({...a,count:0,id:a.id+"0F"}),a.serialize(c,"$$f"),s.fallback}),suspenseError))}const $o=new Set(["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"]),_o=new Set(["innerHTML","textContent","innerText","children"]),Eo=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Ro=Qn.AggregateError|Qn.BigIntTypedArray;function createSerializer({onData:s,onDone:o,scopeId:a,onError:c}){return new Ii({scopeId:a,plugins:[Di,Hi,Ui,Wi,Xi,to,io,ao,co,po,ho],globalIdentifier:"_$HY.r",disabledFeatures:Ro,onData:s,onDone:o,onError:c})}function getLocalHeaderScript(s){return xr(s)+";"}const To=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;function renderToString(s,o={}){const{renderId:a}=o;let c="";const u=createSerializer({scopeId:a,onData(s){c||(c=getLocalHeaderScript(a)),c+=s+";"},onError:o.onError});vo.context={id:a||"",count:0,suspense:{},lazy:{},assets:[],nonce:o.nonce,serialize(s,o){!vo.context.noHydrate&&u.write(s,o)},roots:0,nextRoot(){return this.renderId+"i-"+this.roots++}};let p=createRoot((o=>(setTimeout(o),resolveSSRNode(escape(s())))));return vo.context.noHydrate=!0,u.close(),p=injectAssets(vo.context.assets,p),c.length&&(p=injectScripts(p,c,o.nonce)),p}function HydrationScript(s){const{nonce:o}=vo.context;return ssr(function({eventNames:s=["click","input"],nonce:o}={}){return`<script${o?` nonce="${o}"`:""}>window._$HY||(e=>{let t=e=>e&&e.hasAttribute&&(e.hasAttribute("data-hk")?e:t(e.host&&e.host.nodeType?e.host:e.parentNode));["${s.join('", "')}"].forEach((o=>document.addEventListener(o,(o=>{if(!e.events)return;let s=t(o.composedPath&&o.composedPath()[0]||o.target);s&&!e.completed.has(s)&&e.events.push([s,o])}))))})(_$HY={events:[],completed:new WeakSet,r:{},fe(){}});<\/script>\x3c!--xs--\x3e`}({nonce:o,...s}))}function ssr(s,...o){if(o.length){let a="";for(let c=0;c<o.length;c++){a+=s[c];const u=o[c];void 0!==u&&(a+=resolveSSRNode(u))}s=a+s[o.length]}return{t:s}}function ssrClassList(s){if(!s)return"";let o=Object.keys(s),a="";for(let c=0,u=o.length;c<u;c++){const u=o[c],p=!!s[u];u&&"undefined"!==u&&p&&(c&&(a+=" "),a+=escape(u))}return a}function ssrStyle(s){if(!s)return"";if("string"==typeof s)return escape(s,!0);let o="";const a=Object.keys(s);for(let c=0;c<a.length;c++){const u=a[c],p=s[u];null!=p&&(c&&(o+=";"),o+=`${u}:${escape(p,!0)}`)}return o}function ssrElement(s,o,a,c){null==o?o={}:"function"==typeof o&&(o=o());const u=To.test(s),p=Object.keys(o);let w,v=`<${s}${ssrHydrationKey()} `;for(let c=0;c<p.length;c++){const $=p[c];if(_o.has($)){void 0!==a||u||(a="script"===s||"style"===s||"innerHTML"===$?o[$]:escape(o[$]));continue}const C=o[$];if("style"===$)v+=`style="${ssrStyle(C)}"`;else if("class"===$||"className"===$||"classList"===$){if(w)continue;let s;v+=`class="${escape(((s=o.class)?s+" ":"")+((s=o.className)?s+" ":""),!0)+ssrClassList(o.classList)}"`,w=!0}else if($o.has($)){if(!C)continue;v+=$}else{if(null==C||"ref"===$||"on"===$.slice(0,2)||"prop:"===$.slice(0,5))continue;if("bool:"===$.slice(0,5)){if(!C)continue;v+=escape($.slice(5))}else"attr:"===$.slice(0,5)?v+=`${escape($.slice(5))}="${escape(C,!0)}"`:v+=`${Eo[$]||escape($)}="${escape(C,!0)}"`}c!==p.length-1&&(v+=" ")}return u?{t:v+"/>"}:("function"==typeof a&&(a=a()),{t:v+`>${resolveSSRNode(a,!0)}</${s}>`})}function ssrAttribute(s,o,a){return a?o?" "+s:"":null!=o?` ${s}="${o}"`:""}function ssrHydrationKey(){const s=function(){const s=vo.context;return s&&!s.noHydrate&&vo.getNextContextId()}();return s?` data-hk=${s}`:""}function escape(s,o){const a=typeof s;if("string"!==a){if(!o&&"function"===a)return escape(s());if(!o&&Array.isArray(s)){for(let o=0;o<s.length;o++)s[o]=escape(s[o]);return s}return o&&"boolean"===a?String(s):s}const c=o?'"':"<",u=o?"&quot;":"&lt;";let p=s.indexOf(c),w=s.indexOf("&");if(p<0&&w<0)return s;let v=0,$="";for(;p>=0&&w>=0;)p<w?(v<p&&($+=s.substring(v,p)),$+=u,v=p+1,p=s.indexOf(c,v)):(v<w&&($+=s.substring(v,w)),$+="&amp;",v=w+1,w=s.indexOf("&",v));if(p>=0)do{v<p&&($+=s.substring(v,p)),$+=u,v=p+1,p=s.indexOf(c,v)}while(p>=0);else for(;w>=0;)v<w&&($+=s.substring(v,w)),$+="&amp;",v=w+1,w=s.indexOf("&",v);return v<s.length?$+s.substring(v):$}function resolveSSRNode(s,o){const a=typeof s;if("string"===a)return s;if(null==s||"boolean"===a)return"";if(Array.isArray(s)){let a={},c="";for(let u=0,p=s.length;u<p;u++)o||"object"==typeof a||"object"==typeof s[u]||(c+="\x3c!--!$--\x3e"),c+=resolveSSRNode(a=s[u]);return c}return"object"===a?s.t:"function"===a?resolveSSRNode(s()):String(s)}function Hydration(s){if(!vo.context.noHydrate)return s.children;const o=vo.context;vo.context={...o,count:0,id:vo.getNextContextId(),noHydrate:!1};const a=s.children;return vo.context=o,a}function NoHydration(s){return vo.context&&(vo.context.noHydrate=!0),s.children}function queue(s){return Promise.resolve().then(s)}function allSettled(s){let o=s.length;return Promise.allSettled(s).then((()=>{if(s.length!==o)return allSettled(s)}))}function injectAssets(s,o){if(!s||!s.length)return o;let a="";for(let o=0,c=s.length;o<c;o++)a+=s[o]();const c=o.indexOf("</head>");return-1===c?o:o.slice(0,c)+a+o.slice(c)}function injectScripts(s,o,a){const c=`<script${a?` nonce="${a}"`:""}>${o}<\/script>`,u=s.indexOf("\x3c!--xs--\x3e");return u>-1?s.slice(0,u)+c+s.slice(u):s+c}const Ao=Symbol();function getRequestEvent(){return globalThis[Ao]?globalThis[Ao].getStore()||vo.context&&vo.context.event||console.log("RequestEvent is missing. This is most likely due to accessing `getRequestEvent` non-managed async scope in a partially polyfilled environment. Try moving it above all `await` calls."):void 0}function provideRequestEvent(s,o){return(globalThis[Ao]=globalThis[Ao]||new p).run(s,o)}function parse(s,o){if("string"!=typeof s)throw new TypeError("argument str must be a string");const a={},c={},u=c.decode||decode;let p=0;for(;p<s.length;){const o=s.indexOf("=",p);if(-1===o)break;let w=s.indexOf(";",p);if(-1===w)w=s.length;else if(w<o){p=s.lastIndexOf(";",o-1)+1;continue}const v=s.slice(p,o).trim();if(!c?.filter||c?.filter(v)){if(void 0===a[v]){let c=s.slice(o+1,w).trim();34===c.codePointAt(0)&&(c=c.slice(1,-1)),a[v]=tryDecode(c,u)}p=w+1}else p=w+1}return a}function decode(s){return s.includes("%")?decodeURIComponent(s):s}function tryDecode(s,o){try{return o(s)}catch{return s}}const Co=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function serialize(s,o,a){const c=a||{},u=c.encode||encodeURIComponent;if("function"!=typeof u)throw new TypeError("option encode is invalid");if(!Co.test(s))throw new TypeError("argument name is invalid");const p=u(o);if(p&&!Co.test(p))throw new TypeError("argument val is invalid");let w=s+"="+p;if(void 0!==c.maxAge&&null!==c.maxAge){const s=c.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");w+="; Max-Age="+Math.floor(s)}if(c.domain){if(!Co.test(c.domain))throw new TypeError("option domain is invalid");w+="; Domain="+c.domain}if(c.path){if(!Co.test(c.path))throw new TypeError("option path is invalid");w+="; Path="+c.path}if(c.expires){if(v=c.expires,!("[object Date]"===Object.prototype.toString.call(v)||v instanceof Date)||Number.isNaN(c.expires.valueOf()))throw new TypeError("option expires is invalid");w+="; Expires="+c.expires.toUTCString()}var v;if(c.httpOnly&&(w+="; HttpOnly"),c.secure&&(w+="; Secure"),c.priority){switch("string"==typeof c.priority?c.priority.toLowerCase():c.priority){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(c.sameSite){switch("string"==typeof c.sameSite?c.sameSite.toLowerCase():c.sameSite){case!0:w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"strict":w+="; SameSite=Strict";break;case"none":w+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return c.partitioned&&(w+="; Partitioned"),w}function parseSetCookie(s,o){const a=(s||"").split(";").filter((s=>"string"==typeof s&&!!s.trim())),c=function(s){let o="",a="";const c=s.split("=");c.length>1?(o=c.shift(),a=c.join("=")):a=s;return{name:o,value:a}}(a.shift()||""),u=c.name;let p=c.value;try{p=!1===o?.decode?p:(o?.decode||decodeURIComponent)(p)}catch{}const w={name:u,value:p};for(const s of a){const o=s.split("="),a=(o.shift()||"").trimStart().toLowerCase(),c=o.join("=");switch(a){case"expires":w.expires=new Date(c);break;case"max-age":w.maxAge=Number.parseInt(c,10);break;case"secure":w.secure=!0;break;case"httponly":w.httpOnly=!0;break;case"samesite":w.sameSite=c;break;default:w[a]=c}}return w}function hasProp(s,o){try{return o in s}catch{return!1}}class H3Error extends Error{static __h3_error__=!0;statusCode=500;fatal=!1;unhandled=!1;statusMessage;data;cause;constructor(s,o={}){super(s,o),o.cause&&!this.cause&&(this.cause=o.cause)}toJSON(){const s={message:this.message,statusCode:sanitizeStatusCode(this.statusCode,500)};return this.statusMessage&&(s.statusMessage=sanitizeStatusMessage(this.statusMessage)),void 0!==this.data&&(s.data=this.data),s}}function assertMethod(s,o,a){if(!function(s,o){if("string"==typeof o){if(s.method===o)return!0}else if(o.includes(s.method))return!0;return!1}(s,o))throw function(s){if("string"==typeof s)return new H3Error(s);if(function(s){return!0===s?.constructor?.__h3_error__}(s))return s;const o=new H3Error(s.message??s.statusMessage??"",{cause:s.cause||s});if(hasProp(s,"stack"))try{Object.defineProperty(o,"stack",{get:()=>s.stack})}catch{try{o.stack=s.stack}catch{}}if(s.data&&(o.data=s.data),s.statusCode?o.statusCode=sanitizeStatusCode(s.statusCode,o.statusCode):s.status&&(o.statusCode=sanitizeStatusCode(s.status,o.statusCode)),s.statusMessage?o.statusMessage=s.statusMessage:s.statusText&&(o.statusMessage=s.statusText),o.statusMessage){const s=o.statusMessage;sanitizeStatusMessage(o.statusMessage)!==s&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return void 0!==s.fatal&&(o.fatal=s.fatal),void 0!==s.unhandled&&(o.unhandled=s.unhandled),o}({statusCode:405,statusMessage:"HTTP method is not allowed."})}function getRequestHeader(s,o){const a=function(s){const o={};for(const a in s.node.req.headers){const c=s.node.req.headers[a];o[a]=Array.isArray(c)?c.filter(Boolean).join(", "):c}return o}(s);return a[o.toLowerCase()]}function getRequestURL(s,o={}){const a=function(s,o={}){if(o.xForwardedHost){const o=s.node.req.headers["x-forwarded-host"];if(o)return o}return s.node.req.headers.host||"localhost"}(s,o),c=function(s,o={}){return!1!==o.xForwardedProto&&"https"===s.node.req.headers["x-forwarded-proto"]||s.node.req.connection?.encrypted?"https":"http"}(s,o),u=(s.node.req.originalUrl||s.path).replace(/^[/\\]+/g,"/");return new URL(u,`${c}://${a}`)}function getRequestIP(s,o={}){if(s.context.clientAddress)return s.context.clientAddress;if(o.xForwardedFor){const o=getRequestHeader(s,"x-forwarded-for")?.split(",").shift()?.trim();if(o)return o}return s.node.req.socket.remoteAddress?s.node.req.socket.remoteAddress:void 0}const ko=Symbol.for("h3RawBody"),qo=["PATCH","POST","PUT","DELETE"];function getRequestWebStream(o){if(!qo.includes(o.method))return;const a=o.web?.request?.body||o._requestBody;if(a)return a;return ko in o.node.req||"rawBody"in o.node.req||"body"in o.node.req||"__unenv__"in o.node.req?new ReadableStream({async start(a){const c=await function(o,a="utf8"){assertMethod(o,qo);const c=o._requestBody||o.web?.request?.body||o.node.req[ko]||o.node.req.rawBody||o.node.req.body;if(c){const o=Promise.resolve(c).then((o=>s.isBuffer(o)?o:"function"==typeof o.pipeTo?new Promise(((a,c)=>{const u=[];o.pipeTo(new WritableStream({write(s){u.push(s)},close(){a(s.concat(u))},abort(s){c(s)}})).catch(c)})):"function"==typeof o.pipe?new Promise(((a,c)=>{const u=[];o.on("data",(s=>{u.push(s)})).on("end",(()=>{a(s.concat(u))})).on("error",c)})):o.constructor===Object?s.from(JSON.stringify(o)):o instanceof URLSearchParams?s.from(o.toString()):o instanceof FormData?new Response(o).bytes().then((o=>s.from(o))):s.from(o)));return a?o.then((s=>s.toString(a))):o}if(!Number.parseInt(o.node.req.headers["content-length"]||"")&&!String(o.node.req.headers["transfer-encoding"]??"").split(",").map((s=>s.trim())).filter(Boolean).includes("chunked"))return Promise.resolve(void 0);const u=o.node.req[ko]=new Promise(((a,c)=>{const u=[];o.node.req.on("error",(s=>{c(s)})).on("data",(s=>{u.push(s)})).on("end",(()=>{a(s.concat(u))}))}));return a?u.then((s=>s.toString(a))):u}(o,!1);c&&a.enqueue(c),a.close()}}):new ReadableStream({start:s=>{o.node.req.on("data",(o=>{s.enqueue(o)})),o.node.req.on("end",(()=>{s.close()})),o.node.req.on("error",(o=>{s.error(o)}))}})}const zo="text/html",Po=/[^\u0009\u0020-\u007E]/g;function sanitizeStatusMessage(s=""){return s.replace(Po,"")}function sanitizeStatusCode(s,o=200){return s?("string"==typeof s&&(s=Number.parseInt(s,10)),s<100||s>999?o:s):o}function getDistinctCookieKey(s,o){return[s,o.domain||"",o.path||"/"].join(";")}function parseCookies(s){return parse(s.node.req.headers.cookie||"")}function getCookie(s,o){return parseCookies(s)[o]}function setCookie(s,o,a,c={}){c.path||(c={path:"/",...c});const u=serialize(o,a,c),p=splitCookiesString(s.node.res.getHeader("set-cookie"));if(0===p.length)return void s.node.res.setHeader("set-cookie",u);const w=getDistinctCookieKey(o,c);s.node.res.removeHeader("set-cookie");for(const o of p){const a=parseSetCookie(o);getDistinctCookieKey(a.name,a)!==w&&s.node.res.appendHeader("set-cookie",o)}s.node.res.appendHeader("set-cookie",u)}function splitCookiesString(s){if(Array.isArray(s))return s.flatMap((s=>splitCookiesString(s)));if("string"!=typeof s)return[];const o=[];let a,c,u,p,w,v=0;const skipWhitespace=()=>{for(;v<s.length&&/\s/.test(s.charAt(v));)v+=1;return v<s.length};for(;v<s.length;){for(a=v,w=!1;skipWhitespace();)if(c=s.charAt(v),","===c){for(u=v,v+=1,skipWhitespace(),p=v;v<s.length&&(c=s.charAt(v),"="!==c&&";"!==c&&","!==c);)v+=1;v<s.length&&"="===s.charAt(v)?(w=!0,v=p,o.push(s.slice(a,u)),a=v):v=u+1}else v+=1;(!w||v>=s.length)&&o.push(s.slice(a))}return o}const jo=void 0===c?s=>s():c;function setResponseStatus(s,o,a){o&&(s.node.res.statusCode=sanitizeStatusCode(o,s.node.res.statusCode)),a&&(s.node.res.statusMessage=sanitizeStatusMessage(a))}function getResponseStatus(s){return s.node.res.statusCode}function getResponseStatusText(s){return s.node.res.statusMessage}function getResponseHeaders(s){return s.node.res.getHeaders()}function getResponseHeader(s,o){return s.node.res.getHeader(o)}function setResponseHeader(s,o,a){s.node.res.setHeader(o,a)}const Io=setResponseHeader;function appendResponseHeader(s,o,a){let c=s.node.res.getHeader(o);c?(Array.isArray(c)||(c=[c.toString()]),s.node.res.setHeader(o,[...c,a])):s.node.res.setHeader(o,a)}function removeResponseHeader(s,o){return s.node.res.removeHeader(o)}function sendWebResponse(s,o){for(const[a,c]of o.headers)"set-cookie"===a?s.node.res.appendHeader(a,splitCookiesString(c)):s.node.res.setHeader(a,c);if(o.status&&(s.node.res.statusCode=sanitizeStatusCode(o.status,s.node.res.statusCode)),o.statusText&&(s.node.res.statusMessage=sanitizeStatusMessage(o.statusText)),o.redirected&&s.node.res.setHeader("location",o.url),o.body)return function(s,o){if(!o||"object"!=typeof o)throw new Error("[h3] Invalid stream provided.");if(s.node.res._data=o,!s.node.res.socket)return s._handled=!0,Promise.resolve();if(hasProp(o,"pipeTo")&&"function"==typeof o.pipeTo)return o.pipeTo(new WritableStream({write(o){s.node.res.write(o)}})).then((()=>{s.node.res.end()}));if(hasProp(o,"pipe")&&"function"==typeof o.pipe)return new Promise(((a,c)=>{o.pipe(s.node.res),o.on&&(o.on("end",(()=>{s.node.res.end(),a()})),o.on("error",(s=>{c(s)}))),s.node.res.on("close",(()=>{o.abort&&o.abort()}))}));throw new Error("[h3] Invalid or incompatible stream provided.")}(s,o.body);s.node.res.end()}const Oo=Symbol("getSession"),No="h3",Qo={path:"/",secure:!0,httpOnly:!0};async function useSession(s,o){const a=o.name||No;await getSession(s,o);const c={get id(){return s.context.sessions?.[a]?.id},get data(){return s.context.sessions?.[a]?.data||{}},update:async a=>{if(!isEvent(s))throw new Error("[h3] Cannot update read-only session.");return await updateSession(s,o,a),c},clear:()=>{if(!isEvent(s))throw new Error("[h3] Cannot clear read-only session.");return function(s,o){const a=o.name||No;s.context.sessions?.[a]&&delete s.context.sessions[a];setCookie(s,a,"",{...Qo,...o.cookie}),Promise.resolve()}(s,o),Promise.resolve(c)}};return c}async function getSession(s,o){const a=o.name||No;s.context.sessions||(s.context.sessions=Object.create(null));const c=s.context.sessions[a];if(c)return c[Oo]||c;const u={id:"",createdAt:0,data:Object.create(null)};let p;if(s.context.sessions[a]=u,!1!==o.sessionHeader){const c="string"==typeof o.sessionHeader?o.sessionHeader.toLowerCase():`x-${a.toLowerCase()}-session`,u=_getReqHeader(s,c);"string"==typeof u&&(p=u)}if(!p){const o=_getReqHeader(s,"cookie");o&&(p=parse(o+"")[a])}if(p){const c=async function(s,o,a){const c=await(async(s,o,a,c)=>{if(!a)throw new Error("Empty password");const u=clone(c),p=Date.now()+(u.localtimeOffsetMsec||0),w=o.split("*");if(8!==w.length)throw new Error("Incorrect number of sealed components");const v=w[0];let $=w[1];const C=w[2],q=w[3],z=w[4],j=w[5],L=w[6],Q=w[7],H=`${v}*${$}*${C}*${q}*${z}*${j}`;if(fs!==v)throw new Error("Wrong mac prefix");if(j){if(!/^\d+$/.test(j))throw new Error("Invalid expiration");if(Number.parseInt(j,10)<=p-1e3*u.timestampSkewSec)throw new Error("Expired seal")}let K="";if($=$||"default","string"==typeof a||a instanceof Uint8Array)K=a;else{if(!($ in a))throw new Error(`Cannot find password: ${$}`);K=a[$]}K=normalizePassword(K);const J=u.integrity;if(J.salt=L,!((s,o)=>{let a=s.length===o.length?0:1;a&&(o=s);for(let c=0;c<s.length;c+=1)a|=s.charCodeAt(c)^o.charCodeAt(c);return 0===a})((await hmacWithPassword(s,K.integrity,J,H)).digest,Q))throw new Error("Bad hmac value");const Z=base64urlDecode(z),X=u.encryption;X.salt=C,X.iv=base64urlDecode(q);const te=await decrypt(s,K.encryption,X,Z);return te?JSON.parse(te):null})(o.crypto||ls,a,o.password,{...ds,ttl:o.maxAge?1e3*o.maxAge:0,...o.seal});if(o.maxAge){if(Date.now()-(c.createdAt||Number.NEGATIVE_INFINITY)>1e3*o.maxAge)throw new Error("Session expired!")}return c}(0,o,p).catch((()=>{})).then((o=>(Object.assign(u,o),delete s.context.sessions[a][Oo],u)));s.context.sessions[a][Oo]=c,await c}if(!u.id){if(!isEvent(s))throw new Error("Cannot initialize a new session. Make sure using `useSession(event)` in main handler.");u.id=o.generateId?.()??(o.crypto||ls).randomUUID(),u.createdAt=Date.now(),await updateSession(s,o)}return u}function _getReqHeader(s,o){return s.node?s.node?.req.headers[o]:s.request?s.request.headers?.get(o):s.headers?s.headers.get(o):void 0}async function updateSession(s,o,a){const c=o.name||No,u=s.context.sessions?.[c]||await getSession(s,o);if("function"==typeof a&&(a=a(u.data)),a&&Object.assign(u.data,a),!1!==o.cookie){const a=await async function(s,o){const a=o.name||No,c=s.context.sessions?.[a]||await getSession(s,o),u=await seal(o.crypto||ls,c,o.password,{...ds,ttl:o.maxAge?1e3*o.maxAge:0,...o.seal});return u}(s,o);setCookie(s,c,a,{...Qo,expires:o.maxAge?new Date(u.createdAt+1e3*o.maxAge):void 0,...o.cookie})}return u}class H3Event{__is_event__=!0;node;web;context={};_method;_path;_headers;_requestBody;_handled=!1;_onBeforeResponseCalled;_onAfterResponseCalled;constructor(s,o){this.node={req:s,res:o}}get method(){return this._method||(this._method=(this.node.req.method||"GET").toUpperCase()),this._method}get path(){return this._path||this.node.req.url||"/"}get headers(){return this._headers||(this._headers=function(s){const o=new Headers;for(const[a,c]of Object.entries(s))if(Array.isArray(c))for(const s of c)o.append(a,s);else c&&o.set(a,c);return o}(this.node.req.headers)),this._headers}get handled(){return this._handled||this.node.res.writableEnded||this.node.res.headersSent}respondWith(s){return Promise.resolve(s).then((s=>sendWebResponse(this,s)))}toString(){return`[${this.method}] ${this.path}`}toJSON(){return this.toString()}get req(){return this.node.req}get res(){return this.node.res}}function isEvent(s){return hasProp(s,"__is_event__")}function _normalizeArray(s){return s?Array.isArray(s)?s:[s]:void 0}const eventHandler=function(s){if("function"==typeof s)return s.__is_handler__=!0,s;const o={onRequest:_normalizeArray(s.onRequest),onBeforeResponse:_normalizeArray(s.onBeforeResponse)},_handler=a=>async function(s,o,a){if(a.onRequest)for(const o of a.onRequest)if(await o(s),s.handled)return;const c=await o(s),u={body:c};if(a.onBeforeResponse)for(const o of a.onBeforeResponse)await o(s,u);return u.body}(a,s.handler,o);return _handler.__is_handler__=!0,_handler.__resolve__=s.handler.__resolve__,_handler.__websocket__=s.websocket,_handler},Bo=Symbol.for("drizzle:entityKind");function is(s,o){if(!s||"object"!=typeof s)return!1;if(s instanceof o)return!0;if(!Object.prototype.hasOwnProperty.call(o,Bo))throw new Error(`Class "${o.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let a=s.constructor;if(a)for(;a;){if(Bo in a&&a[Bo]===o[Bo])return!0;a=Object.getPrototypeOf(a)}return!1}class Column{constructor(s,o){this.table=s,this.config=o,this.name=o.name,this.notNull=o.notNull,this.default=o.default,this.defaultFn=o.defaultFn,this.onUpdateFn=o.onUpdateFn,this.hasDefault=o.hasDefault,this.primary=o.primaryKey,this.isUnique=o.isUnique,this.uniqueName=o.uniqueName,this.uniqueType=o.uniqueType,this.dataType=o.dataType,this.columnType=o.columnType}static[Bo]="Column";name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(s){return s}mapToDriverValue(s){return s}}class ColumnBuilder{static[Bo]="ColumnBuilder";config;constructor(s,o,a){this.config={name:s,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:o,columnType:a}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(s){return this.config.default=s,this.config.hasDefault=!0,this}$defaultFn(s){return this.config.defaultFn=s,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(s){return this.config.onUpdateFn=s,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}}const Do=Symbol.for("drizzle:Name"),Mo=Symbol.for("drizzle:Schema"),Ho=Symbol.for("drizzle:Columns"),Fo=Symbol.for("drizzle:ExtraConfigColumns"),Uo=Symbol.for("drizzle:OriginalName"),Ko=Symbol.for("drizzle:BaseName"),Wo=Symbol.for("drizzle:IsAlias"),Vo=Symbol.for("drizzle:ExtraConfigBuilder");class Table{static[Bo]="Table";static Symbol={Name:Do,Schema:Mo,OriginalName:Uo,Columns:Ho,ExtraConfigColumns:Fo,BaseName:Ko,IsAlias:Wo,ExtraConfigBuilder:Vo};[Do];[Uo];[Mo];[Ho];[Fo];[Ko];[Wo]=!1;[Vo]=void 0;constructor(s,o,a){this[Do]=this[Uo]=s,this[Mo]=o,this[Ko]=a}}function getTableName(s){return s[Do]}function getTableUniqueName(s){return`${s[Mo]??"public"}.${s[Do]}`}const Jo=Symbol.for("drizzle:PgInlineForeignKeys");class PgTable extends Table{static[Bo]="PgTable";static Symbol=Object.assign({},Table.Symbol,{InlineForeignKeys:Jo});[Jo]=[];[Table.Symbol.ExtraConfigBuilder]=void 0}const Go=Symbol.for("drizzle:isPgEnum");class Subquery{static[Bo]="Subquery";constructor(s,o,a,c=!1){this._={brand:"Subquery",sql:s,selectedFields:o,alias:a,isWith:c}}}class WithSubquery extends Subquery{static[Bo]="WithSubquery"}const Yo={startActiveSpan:(s,o)=>o()},Zo=Symbol.for("drizzle:ViewBaseConfig");function isSQLWrapper(s){return null!=s&&"function"==typeof s.getSQL}class StringChunk{static[Bo]="StringChunk";value;constructor(s){this.value=Array.isArray(s)?s:[s]}getSQL(){return new SQL([this])}}class SQL{constructor(s){this.queryChunks=s}static[Bo]="SQL";decoder=Xo;shouldInlineParams=!1;append(s){return this.queryChunks.push(...s.queryChunks),this}toQuery(s){return Yo.startActiveSpan("drizzle.buildSQL",(o=>{const a=this.buildQueryFromSourceParams(this.queryChunks,s);return o?.setAttributes({"drizzle.query.text":a.sql,"drizzle.query.params":JSON.stringify(a.params)}),a}))}buildQueryFromSourceParams(s,o){const a=Object.assign({},o,{inlineParams:o.inlineParams||this.shouldInlineParams,paramStartIndex:o.paramStartIndex||{value:0}}),{escapeName:c,escapeParam:u,prepareTyping:p,inlineParams:w,paramStartIndex:v}=a;return function(s){const o={sql:"",params:[]};for(const a of s)o.sql+=a.sql,o.params.push(...a.params),a.typings?.length&&(o.typings||(o.typings=[]),o.typings.push(...a.typings));return o}(s.map((s=>{if(is(s,StringChunk))return{sql:s.value.join(""),params:[]};if(is(s,Name))return{sql:c(s.value),params:[]};if(void 0===s)return{sql:"",params:[]};if(Array.isArray(s)){const o=[new StringChunk("(")];for(const[a,c]of s.entries())o.push(c),a<s.length-1&&o.push(new StringChunk(", "));return o.push(new StringChunk(")")),this.buildQueryFromSourceParams(o,a)}if(is(s,SQL))return this.buildQueryFromSourceParams(s.queryChunks,{...a,inlineParams:w||s.shouldInlineParams});if(is(s,Table)){const o=s[Table.Symbol.Schema],a=s[Table.Symbol.Name];return{sql:void 0===o?c(a):c(o)+"."+c(a),params:[]}}if(is(s,Column))return"indexes"===o.invokeSource?{sql:c(s.name),params:[]}:{sql:c(s.table[Table.Symbol.Name])+"."+c(s.name),params:[]};if(is(s,View)){const o=s[Zo].schema,a=s[Zo].name;return{sql:void 0===o?c(a):c(o)+"."+c(a),params:[]}}if(is(s,Param)){const o=null===s.value?null:s.encoder.mapToDriverValue(s.value);if(is(o,SQL))return this.buildQueryFromSourceParams([o],a);if(w)return{sql:this.mapInlineParam(o,a),params:[]};let c;return p&&(c=[p(s.encoder)]),{sql:u(v.value++,o),params:[o],typings:c}}return is(s,Placeholder)?{sql:u(v.value++,s),params:[s],typings:["none"]}:is(s,SQL.Aliased)&&void 0!==s.fieldAlias?{sql:c(s.fieldAlias),params:[]}:is(s,Subquery)?s._.isWith?{sql:c(s._.alias),params:[]}:this.buildQueryFromSourceParams([new StringChunk("("),s._.sql,new StringChunk(") "),new Name(s._.alias)],a):($=s)&&"function"==typeof $&&Go in $&&!0===$[Go]?s.schema?{sql:c(s.schema)+"."+c(s.enumName),params:[]}:{sql:c(s.enumName),params:[]}:isSQLWrapper(s)?s.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([s.getSQL()],a):this.buildQueryFromSourceParams([new StringChunk("("),s.getSQL(),new StringChunk(")")],a):w?{sql:this.mapInlineParam(s,a),params:[]}:{sql:u(v.value++,s),params:[s]};var $})))}mapInlineParam(s,{escapeString:o}){if(null===s)return"null";if("number"==typeof s||"boolean"==typeof s)return s.toString();if("string"==typeof s)return o(s);if("object"==typeof s){const a=s.toString();return o("[object Object]"===a?JSON.stringify(s):a)}throw new Error("Unexpected param value: "+s)}getSQL(){return this}as(s){return void 0===s?this:new SQL.Aliased(this,s)}mapWith(s){return this.decoder="function"==typeof s?{mapFromDriverValue:s}:s,this}inlineParams(){return this.shouldInlineParams=!0,this}if(s){return s?this:void 0}}class Name{constructor(s){this.value=s}static[Bo]="Name";brand;getSQL(){return new SQL([this])}}const Xo={mapFromDriverValue:s=>s},ea={mapToDriverValue:s=>s};class Param{constructor(s,o=ea){this.value=s,this.encoder=o}static[Bo]="Param";brand;getSQL(){return new SQL([this])}}function sql(s,...o){const a=[];(o.length>0||s.length>0&&""!==s[0])&&a.push(new StringChunk(s[0]));for(const[c,u]of o.entries())a.push(u,new StringChunk(s[c+1]));return new SQL(a)}var ta;(ta=sql||(sql={})).empty=function(){return new SQL([])},ta.fromList=function(s){return new SQL(s)},ta.raw=function(s){return new SQL([new StringChunk(s)])},ta.join=function(s,o){const a=[];for(const[c,u]of s.entries())c>0&&void 0!==o&&a.push(o),a.push(u);return new SQL(a)},ta.identifier=function(s){return new Name(s)},ta.placeholder=function(s){return new Placeholder(s)},ta.param=function(s,o){return new Param(s,o)},(s=>{class Aliased{constructor(s,o){this.sql=s,this.fieldAlias=o}static[Bo]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new Aliased(this.sql,this.fieldAlias)}}s.Aliased=Aliased})(SQL||(SQL={}));class Placeholder{constructor(s){this.name=s}static[Bo]="Placeholder";getSQL(){return new SQL([this])}}function fillPlaceholders(s,o){return s.map((s=>{if(is(s,Placeholder)){if(!(s.name in o))throw new Error(`No value for placeholder "${s.name}" was provided`);return o[s.name]}return s}))}class View{static[Bo]="View";[Zo];constructor({name:s,schema:o,selectedFields:a,query:c}){this[Zo]={name:s,originalName:s,schema:o,selectedFields:a,query:c,isExisting:!c,isAlias:!1}}getSQL(){return new SQL([this])}}Column.prototype.getSQL=function(){return new SQL([this])},Table.prototype.getSQL=function(){return new SQL([this])},Subquery.prototype.getSQL=function(){return new SQL([this])};class ColumnAliasProxyHandler{constructor(s){this.table=s}static[Bo]="ColumnAliasProxyHandler";get(s,o){return"table"===o?this.table:s[o]}}class TableAliasProxyHandler{constructor(s,o){this.alias=s,this.replaceOriginalName=o}static[Bo]="TableAliasProxyHandler";get(s,o){if(o===Table.Symbol.IsAlias)return!0;if(o===Table.Symbol.Name)return this.alias;if(this.replaceOriginalName&&o===Table.Symbol.OriginalName)return this.alias;if(o===Zo)return{...s[Zo],name:this.alias,isAlias:!0};if(o===Table.Symbol.Columns){const o=s[Table.Symbol.Columns];if(!o)return o;const a={};return Object.keys(o).map((c=>{a[c]=new Proxy(o[c],new ColumnAliasProxyHandler(new Proxy(s,this)))})),a}const a=s[o];return is(a,Column)?new Proxy(a,new ColumnAliasProxyHandler(new Proxy(s,this))):a}}function aliasedTable(s,o){return new Proxy(s,new TableAliasProxyHandler(o,!1))}function aliasedTableColumn(s,o){return new Proxy(s,new ColumnAliasProxyHandler(new Proxy(s.table,new TableAliasProxyHandler(o,!1))))}function mapColumnsInAliasedSQLToAlias(s,o){return new SQL.Aliased(mapColumnsInSQLToAlias(s.sql,o),s.fieldAlias)}function mapColumnsInSQLToAlias(s,o){return sql.join(s.queryChunks.map((s=>is(s,Column)?aliasedTableColumn(s,o):is(s,SQL)?mapColumnsInSQLToAlias(s,o):is(s,SQL.Aliased)?mapColumnsInAliasedSQLToAlias(s,o):s)))}class DrizzleError extends Error{static[Bo]="DrizzleError";constructor({message:s,cause:o}){super(s),this.name="DrizzleError",this.cause=o}}class TransactionRollbackError extends DrizzleError{static[Bo]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}function bindIfParam(s,o){return!function(s){return"object"==typeof s&&null!==s&&"mapToDriverValue"in s&&"function"==typeof s.mapToDriverValue}(o)||isSQLWrapper(s)||is(s,Param)||is(s,Placeholder)||is(s,Column)||is(s,Table)||is(s,View)?s:new Param(s,o)}const eq=(s,o)=>sql`${s} = ${bindIfParam(o,s)}`,ne=(s,o)=>sql`${s} <> ${bindIfParam(o,s)}`;function and(...s){const o=s.filter((s=>void 0!==s));if(0!==o.length)return 1===o.length?new SQL(o):new SQL([new StringChunk("("),sql.join(o,new StringChunk(" and ")),new StringChunk(")")])}function or(...s){const o=s.filter((s=>void 0!==s));if(0!==o.length)return 1===o.length?new SQL(o):new SQL([new StringChunk("("),sql.join(o,new StringChunk(" or ")),new StringChunk(")")])}function not(s){return sql`not ${s}`}const gt$1=(s,o)=>sql`${s} > ${bindIfParam(o,s)}`,gte=(s,o)=>sql`${s} >= ${bindIfParam(o,s)}`,lt$1=(s,o)=>sql`${s} < ${bindIfParam(o,s)}`,lte=(s,o)=>sql`${s} <= ${bindIfParam(o,s)}`;function inArray(s,o){if(Array.isArray(o)){if(0===o.length)throw new Error("inArray requires at least one value");return sql`${s} in ${o.map((o=>bindIfParam(o,s)))}`}return sql`${s} in ${bindIfParam(o,s)}`}function notInArray(s,o){if(Array.isArray(o)){if(0===o.length)throw new Error("notInArray requires at least one value");return sql`${s} not in ${o.map((o=>bindIfParam(o,s)))}`}return sql`${s} not in ${bindIfParam(o,s)}`}function isNull(s){return sql`${s} is null`}function isNotNull(s){return sql`${s} is not null`}function exists(s){return sql`exists ${s}`}function notExists(s){return sql`not exists ${s}`}function between(s,o,a){return sql`${s} between ${bindIfParam(o,s)} and ${bindIfParam(a,s)}`}function notBetween(s,o,a){return sql`${s} not between ${bindIfParam(o,s)} and ${bindIfParam(a,s)}`}function like(s,o){return sql`${s} like ${o}`}function notLike(s,o){return sql`${s} not like ${o}`}function ilike(s,o){return sql`${s} ilike ${o}`}function notIlike(s,o){return sql`${s} not ilike ${o}`}function asc(s){return sql`${s} asc`}function desc(s){return sql`${s} desc`}class ConsoleLogWriter{static[Bo]="ConsoleLogWriter";write(s){console.log(s)}}class DefaultLogger{static[Bo]="DefaultLogger";writer;constructor(s){this.writer=s?.writer??new ConsoleLogWriter}logQuery(s,o){const a=o.map((s=>{try{return JSON.stringify(s)}catch{return String(s)}})),c=a.length?` -- params: [${a.join(", ")}]`:"";this.writer.write(`Query: ${s}${c}`)}}class NoopLogger{static[Bo]="NoopLogger";logQuery(){}}class QueryPromise{static[Bo]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(s){return this.then(void 0,s)}finally(s){return this.then((o=>(s?.(),o)),(o=>{throw s?.(),o}))}then(s,o){return this.execute().then(s,o)}}class PrimaryKeyBuilder{static[Bo]="PgPrimaryKeyBuilder";columns;name;constructor(s,o){this.columns=s,this.name=o}build(s){return new PrimaryKey(s,this.columns,this.name)}}class PrimaryKey{constructor(s,o,a){this.table=s,this.columns=o,this.name=a}static[Bo]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[PgTable.Symbol.Name]}_${this.columns.map((s=>s.name)).join("_")}_pk`}}class Relation{constructor(s,o,a){this.sourceTable=s,this.referencedTable=o,this.relationName=a,this.referencedTableName=o[Table.Symbol.Name]}static[Bo]="Relation";referencedTableName;fieldName}class Relations{constructor(s,o){this.table=s,this.config=o}static[Bo]="Relations"}class One extends Relation{constructor(s,o,a,c){super(s,o,a?.relationName),this.config=a,this.isNullable=c}static[Bo]="One";withFieldName(s){const o=new One(this.sourceTable,this.referencedTable,this.config,this.isNullable);return o.fieldName=s,o}}class Many extends Relation{constructor(s,o,a){super(s,o,a?.relationName),this.config=a}static[Bo]="Many";withFieldName(s){const o=new Many(this.sourceTable,this.referencedTable,this.config);return o.fieldName=s,o}}function createOne(s){return function(o,a){return new One(s,o,a,a?.fields.reduce(((s,o)=>s&&o.notNull),!0)??!1)}}function createMany(s){return function(o,a){return new Many(s,o,a)}}function normalizeRelation(s,o,a){if(is(a,One)&&a.config)return{fields:a.config.fields,references:a.config.references};const c=o[getTableUniqueName(a.referencedTable)];if(!c)throw new Error(`Table "${a.referencedTable[Table.Symbol.Name]}" not found in schema`);const u=s[c];if(!u)throw new Error(`Table "${c}" not found in schema`);const p=a.sourceTable,w=o[getTableUniqueName(p)];if(!w)throw new Error(`Table "${p[Table.Symbol.Name]}" not found in schema`);const v=[];for(const s of Object.values(u.relations))(a.relationName&&a!==s&&s.relationName===a.relationName||!a.relationName&&s.referencedTable===a.sourceTable)&&v.push(s);if(v.length>1)throw a.relationName?new Error(`There are multiple relations with name "${a.relationName}" in table "${c}"`):new Error(`There are multiple relations between "${c}" and "${a.sourceTable[Table.Symbol.Name]}". Please specify relation name`);if(v[0]&&is(v[0],One)&&v[0].config)return{fields:v[0].config.references,references:v[0].config.fields};throw new Error(`There is not enough information to infer relation "${w}.${a.fieldName}"`)}function createTableRelationsHelpers(s){return{one:createOne(s),many:createMany(s)}}function mapRelationalRow(s,o,a,c,u=s=>s){const p={};for(const[w,v]of c.entries())if(v.isJson){const c=o.relations[v.tsKey],$=a[w],C="string"==typeof $?JSON.parse($):$;p[v.tsKey]=is(c,One)?C&&mapRelationalRow(s,s[v.relationTableTsKey],C,v.selection,u):C.map((o=>mapRelationalRow(s,s[v.relationTableTsKey],o,v.selection,u)))}else{const s=u(a[w]),o=v.field;let c;c=is(o,Column)?o:is(o,SQL)?o.decoder:o.sql.decoder,p[v.tsKey]=null===s?null:c.mapFromDriverValue(s)}return p}function mapResultRow(s,o,a){const c={},u=s.reduce(((s,{path:u,field:p},w)=>{let v;v=is(p,Column)?p:is(p,SQL)?p.decoder:p.sql.decoder;let $=s;for(const[s,C]of u.entries())if(s<u.length-1)C in $||($[C]={}),$=$[C];else{const s=o[w],q=$[C]=null===s?null:v.mapFromDriverValue(s);if(a&&is(p,Column)&&2===u.length){const s=u[0];s in c?"string"==typeof c[s]&&c[s]!==getTableName(p.table)&&(c[s]=!1):c[s]=null===q&&getTableName(p.table)}}return s}),{});if(a&&Object.keys(c).length>0)for(const[s,o]of Object.entries(c))"string"!=typeof o||a[o]||(u[s]=null);return u}function orderSelectedFields(s,o){return Object.entries(s).reduce(((s,[a,c])=>{if("string"!=typeof a)return s;const u=o?[...o,a]:[a];return is(c,Column)||is(c,SQL)||is(c,SQL.Aliased)?s.push({path:u,field:c}):is(c,Table)?s.push(...orderSelectedFields(c[Table.Symbol.Columns],u)):s.push(...orderSelectedFields(c,u)),s}),[])}function haveSameKeys(s,o){const a=Object.keys(s),c=Object.keys(o);if(a.length!==c.length)return!1;for(const[s,o]of a.entries())if(o!==c[s])return!1;return!0}function mapUpdateSet(s,o){const a=Object.entries(o).filter((([,s])=>void 0!==s)).map((([o,a])=>is(a,SQL)?[o,a]:[o,new Param(a,s[Table.Symbol.Columns][o])]));if(0===a.length)throw new Error("No values to set");return Object.fromEntries(a)}function getTableLikeName(s){return is(s,Subquery)?s._.alias:is(s,View)?s[Zo].name:is(s,SQL)?void 0:s[Table.Symbol.IsAlias]?s[Table.Symbol.Name]:s[Table.Symbol.BaseName]}class SelectionProxyHandler{static[Bo]="SelectionProxyHandler";config;constructor(s){this.config={...s}}get(s,o){if("_"===o)return{...s._,selectedFields:new Proxy(s._.selectedFields,this)};if(o===Zo)return{...s[Zo],selectedFields:new Proxy(s[Zo].selectedFields,this)};if("symbol"==typeof o)return s[o];const a=(is(s,Subquery)?s._.selectedFields:is(s,View)?s[Zo].selectedFields:s)[o];if(is(a,SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!a.isSelectionField)return a.sql;const s=a.clone();return s.isSelectionField=!0,s}if(is(a,SQL)){if("sql"===this.config.sqlBehavior)return a;throw new Error(`You tried to reference "${o}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return is(a,Column)?this.config.alias?new Proxy(a,new ColumnAliasProxyHandler(new Proxy(a.table,new TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1)))):a:"object"!=typeof a||null===a?a:new Proxy(a,new SelectionProxyHandler(this.config))}}const ra=Symbol.for("drizzle:SQLiteInlineForeignKeys");class SQLiteTable extends Table{static[Bo]="SQLiteTable";static Symbol=Object.assign({},Table.Symbol,{InlineForeignKeys:ra});[Table.Symbol.Columns];[ra]=[];[Table.Symbol.ExtraConfigBuilder]=void 0}const sqliteTable=(s,o,a)=>function(s,o,a,c,u=s){const p=new SQLiteTable(s,c,u),w=Object.fromEntries(Object.entries(o).map((([s,o])=>{const a=o,c=a.build(p);return p[ra].push(...a.buildForeignKeys(c,p)),[s,c]}))),v=Object.assign(p,w);return v[Table.Symbol.Columns]=w,v[Table.Symbol.ExtraConfigColumns]=w,v}(s,o);class SQLiteDeleteBase extends QueryPromise{constructor(s,o,a,c){super(),this.table=s,this.session=o,this.dialect=a,this.config={table:s,withList:c}}static[Bo]="SQLiteDelete";config;where(s){return this.config.where=s,this}returning(s=this.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(s),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:s,...o}=this.dialect.sqlToQuery(this.getSQL());return o}_prepare(s=!0){return this.session[s?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=s=>this._prepare().run(s);all=s=>this._prepare().all(s);get=s=>this._prepare().get(s);values=s=>this._prepare().values(s);async execute(s){return this._prepare().execute(s)}$dynamic(){return this}}class SQLiteInsertBuilder{constructor(s,o,a,c){this.table=s,this.session=o,this.dialect=a,this.withList=c}static[Bo]="SQLiteInsertBuilder";values(s){if(0===(s=Array.isArray(s)?s:[s]).length)throw new Error("values() must be called with at least one value");const o=s.map((s=>{const o={},a=this.table[Table.Symbol.Columns];for(const c of Object.keys(s)){const u=s[c];o[c]=is(u,SQL)?u:new Param(u,a[c])}return o}));return new SQLiteInsertBase(this.table,o,this.session,this.dialect,this.withList)}}class SQLiteInsertBase extends QueryPromise{constructor(s,o,a,c,u){super(),this.session=a,this.dialect=c,this.config={table:s,values:o,withList:u}}static[Bo]="SQLiteInsert";config;returning(s=this.config.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(s),this}onConflictDoNothing(s={}){if(void 0===s.target)this.config.onConflict=sql`do nothing`;else{const o=Array.isArray(s.target)?sql`${s.target}`:sql`${[s.target]}`,a=s.where?sql` where ${s.where}`:sql``;this.config.onConflict=sql`${o} do nothing${a}`}return this}onConflictDoUpdate(s){if(s.where&&(s.targetWhere||s.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');const o=s.where?sql` where ${s.where}`:void 0,a=s.targetWhere?sql` where ${s.targetWhere}`:void 0,c=s.setWhere?sql` where ${s.setWhere}`:void 0,u=Array.isArray(s.target)?sql`${s.target}`:sql`${[s.target]}`,p=this.dialect.buildUpdateSet(this.config.table,mapUpdateSet(this.config.table,s.set));return this.config.onConflict=sql`${u}${a} do update set ${p}${o}${c}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:s,...o}=this.dialect.sqlToQuery(this.getSQL());return o}_prepare(s=!0){return this.session[s?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=s=>this._prepare().run(s);all=s=>this._prepare().all(s);get=s=>this._prepare().get(s);values=s=>this._prepare().values(s);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class ForeignKeyBuilder{static[Bo]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(s,o){this.reference=()=>{const{name:o,columns:a,foreignColumns:c}=s();return{name:o,columns:a,foreignTable:c[0].table,foreignColumns:c}},o&&(this._onUpdate=o.onUpdate,this._onDelete=o.onDelete)}onUpdate(s){return this._onUpdate=s,this}onDelete(s){return this._onDelete=s,this}build(s){return new ForeignKey(s,this)}}class ForeignKey{constructor(s,o){this.table=s,this.reference=o.reference,this.onUpdate=o._onUpdate,this.onDelete=o._onDelete}static[Bo]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){const{name:s,columns:o,foreignColumns:a}=this.reference(),c=o.map((s=>s.name)),u=a.map((s=>s.name)),p=[this.table[SQLiteTable.Symbol.Name],...c,a[0].table[SQLiteTable.Symbol.Name],...u];return s??`${p.join("_")}_fk`}}class SQLiteColumnBuilder extends ColumnBuilder{static[Bo]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(s,o={}){return this.foreignKeyConfigs.push({ref:s,actions:o}),this}unique(s){return this.config.isUnique=!0,this.config.uniqueName=s,this}buildForeignKeys(s,o){return this.foreignKeyConfigs.map((({ref:a,actions:c})=>((a,c)=>{const u=new ForeignKeyBuilder((()=>{const o=a();return{columns:[s],foreignColumns:[o]}}));return c.onUpdate&&u.onUpdate(c.onUpdate),c.onDelete&&u.onDelete(c.onDelete),u.build(o)})(a,c)))}}class SQLiteColumn extends Column{constructor(s,o){o.uniqueName||(o.uniqueName=function(s,o){return`${s[SQLiteTable.Symbol.Name]}_${o.join("_")}_unique`}(s,[o.name])),super(s,o),this.table=s}static[Bo]="SQLiteColumn"}class SQLiteBaseIntegerBuilder extends SQLiteColumnBuilder{static[Bo]="SQLiteBaseIntegerBuilder";constructor(s,o,a){super(s,o,a),this.config.autoIncrement=!1}primaryKey(s){return s?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class SQLiteBaseInteger extends SQLiteColumn{static[Bo]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class SQLiteIntegerBuilder extends SQLiteBaseIntegerBuilder{static[Bo]="SQLiteIntegerBuilder";constructor(s){super(s,"number","SQLiteInteger")}build(s){return new SQLiteInteger(s,this.config)}}class SQLiteInteger extends SQLiteBaseInteger{static[Bo]="SQLiteInteger"}class SQLiteTimestampBuilder extends SQLiteBaseIntegerBuilder{static[Bo]="SQLiteTimestampBuilder";constructor(s,o){super(s,"date","SQLiteTimestamp"),this.config.mode=o}defaultNow(){return this.default(sql`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(s){return new SQLiteTimestamp(s,this.config)}}class SQLiteTimestamp extends SQLiteBaseInteger{static[Bo]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(s){return"timestamp"===this.config.mode?new Date(1e3*s):new Date(s)}mapToDriverValue(s){const o=s.getTime();return"timestamp"===this.config.mode?Math.floor(o/1e3):o}}class SQLiteBooleanBuilder extends SQLiteBaseIntegerBuilder{static[Bo]="SQLiteBooleanBuilder";constructor(s,o){super(s,"boolean","SQLiteBoolean"),this.config.mode=o}build(s){return new SQLiteBoolean(s,this.config)}}class SQLiteBoolean extends SQLiteBaseInteger{static[Bo]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(s){return 1===Number(s)}mapToDriverValue(s){return s?1:0}}function integer(s,o){return"timestamp"===o?.mode||"timestamp_ms"===o?.mode?new SQLiteTimestampBuilder(s,o.mode):"boolean"===o?.mode?new SQLiteBooleanBuilder(s,o.mode):new SQLiteIntegerBuilder(s)}class SQLiteTextBuilder extends SQLiteColumnBuilder{static[Bo]="SQLiteTextBuilder";constructor(s,o){super(s,"string","SQLiteText"),this.config.enumValues=o.enum,this.config.length=o.length}build(s){return new SQLiteText(s,this.config)}}class SQLiteText extends SQLiteColumn{static[Bo]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(s,o){super(s,o)}getSQLType(){return"text"+(this.config.length?`(${this.config.length})`:"")}}class SQLiteTextJsonBuilder extends SQLiteColumnBuilder{static[Bo]="SQLiteTextJsonBuilder";constructor(s){super(s,"json","SQLiteTextJson")}build(s){return new SQLiteTextJson(s,this.config)}}class SQLiteTextJson extends SQLiteColumn{static[Bo]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(s){return JSON.parse(s)}mapToDriverValue(s){return JSON.stringify(s)}}function text(s,o={}){return"json"===o.mode?new SQLiteTextJsonBuilder(s):new SQLiteTextBuilder(s,o)}class SQLiteViewBase extends View{static[Bo]="SQLiteViewBase"}class SQLiteDialect{static[Bo]="SQLiteDialect";escapeName(s){return`"${s}"`}escapeParam(s){return"?"}escapeString(s){return`'${s.replace(/'/g,"''")}'`}buildWithCTE(s){if(!s?.length)return;const o=[sql`with `];for(const[a,c]of s.entries())o.push(sql`${sql.identifier(c._.alias)} as (${c._.sql})`),a<s.length-1&&o.push(sql`, `);return o.push(sql` `),sql.join(o)}buildDeleteQuery({table:s,where:o,returning:a,withList:c}){return sql`${this.buildWithCTE(c)}delete from ${s}${o?sql` where ${o}`:void 0}${a?sql` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0}`}buildUpdateSet(s,o){const a=s[Table.Symbol.Columns],c=Object.keys(a).filter((s=>void 0!==o[s]||void 0!==a[s]?.onUpdateFn)),u=c.length;return sql.join(c.flatMap(((s,c)=>{const p=a[s],w=o[s]??sql.param(p.onUpdateFn(),p),v=sql`${sql.identifier(p.name)} = ${w}`;return c<u-1?[v,sql.raw(", ")]:[v]})))}buildUpdateQuery({table:s,set:o,where:a,returning:c,withList:u}){return sql`${this.buildWithCTE(u)}update ${s} set ${this.buildUpdateSet(s,o)}${a?sql` where ${a}`:void 0}${c?sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0}`}buildSelection(s,{isSingleTable:o=!1}={}){const a=s.length,c=s.flatMap((({field:s},c)=>{const u=[];if(is(s,SQL.Aliased)&&s.isSelectionField)u.push(sql.identifier(s.fieldAlias));else if(is(s,SQL.Aliased)||is(s,SQL)){const a=is(s,SQL.Aliased)?s.sql:s;o?u.push(new SQL(a.queryChunks.map((s=>is(s,Column)?sql.identifier(s.name):s)))):u.push(a),is(s,SQL.Aliased)&&u.push(sql` as ${sql.identifier(s.fieldAlias)}`)}else if(is(s,Column)){const a=s.table[Table.Symbol.Name],c=s.name;o?u.push(sql.identifier(c)):u.push(sql`${sql.identifier(a)}.${sql.identifier(c)}`)}return c<a-1&&u.push(sql`, `),u}));return sql.join(c)}buildSelectQuery({withList:s,fields:o,fieldsFlat:a,where:c,having:u,table:p,joins:w,orderBy:v,groupBy:$,limit:C,offset:q,distinct:z,setOperators:j}){const L=a??orderSelectedFields(o);for(const s of L)if(is(s.field,Column)&&getTableName(s.field.table)!==(is(p,Subquery)?p._.alias:is(p,SQLiteViewBase)?p[Zo].name:is(p,SQL)?void 0:getTableName(p))&&!(s=>w?.some((({alias:o})=>o===(s[Table.Symbol.IsAlias]?getTableName(s):s[Table.Symbol.BaseName]))))(s.field.table)){const o=getTableName(s.field.table);throw new Error(`Your "${s.path.join("->")}" field references a column "${o}"."${s.field.name}", but the table "${o}" is not part of the query! Did you forget to join it?`)}const Q=!w||0===w.length,H=this.buildWithCTE(s),K=z?sql` distinct`:void 0,J=this.buildSelection(L,{isSingleTable:Q}),Z=is(p,Table)&&p[Table.Symbol.OriginalName]!==p[Table.Symbol.Name]?sql`${sql.identifier(p[Table.Symbol.OriginalName])} ${sql.identifier(p[Table.Symbol.Name])}`:p,X=[];if(w)for(const[s,o]of w.entries()){0===s&&X.push(sql` `);const a=o.table;if(is(a,SQLiteTable)){const s=a[SQLiteTable.Symbol.Name],c=a[SQLiteTable.Symbol.Schema],u=a[SQLiteTable.Symbol.OriginalName],p=s===u?void 0:o.alias;X.push(sql`${sql.raw(o.joinType)} join ${c?sql`${sql.identifier(c)}.`:void 0}${sql.identifier(u)}${p&&sql` ${sql.identifier(p)}`} on ${o.on}`)}else X.push(sql`${sql.raw(o.joinType)} join ${a} on ${o.on}`);s<w.length-1&&X.push(sql` `)}const te=sql.join(X),oe=c?sql` where ${c}`:void 0,ae=u?sql` having ${u}`:void 0,le=[];if(v)for(const[s,o]of v.entries())le.push(o),s<v.length-1&&le.push(sql`, `);const ce=[];if($)for(const[s,o]of $.entries())ce.push(o),s<$.length-1&&ce.push(sql`, `);const ue=ce.length>0?sql` group by ${sql.join(ce)}`:void 0,de=le.length>0?sql` order by ${sql.join(le)}`:void 0,he=sql`${H}select${K} ${J} from ${Z}${te}${oe}${ue}${ae}${de}${C?sql` limit ${C}`:void 0}${q?sql` offset ${q}`:void 0}`;return j.length>0?this.buildSetOperations(he,j):he}buildSetOperations(s,o){const[a,...c]=o;if(!a)throw new Error("Cannot pass undefined values to any set operator");return 0===c.length?this.buildSetOperationQuery({leftSelect:s,setOperator:a}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:s,setOperator:a}),c)}buildSetOperationQuery({leftSelect:s,setOperator:{type:o,isAll:a,rightSelect:c,limit:u,orderBy:p,offset:w}}){const v=sql`${s.getSQL()} `,$=sql`${c.getSQL()}`;let C;if(p&&p.length>0){const s=[];for(const o of p)if(is(o,SQLiteColumn))s.push(sql.identifier(o.name));else if(is(o,SQL)){for(let s=0;s<o.queryChunks.length;s++){const a=o.queryChunks[s];is(a,SQLiteColumn)&&(o.queryChunks[s]=sql.identifier(a.name))}s.push(sql`${o}`)}else s.push(sql`${o}`);C=sql` order by ${sql.join(s,sql`, `)}`}const q=u?sql` limit ${u}`:void 0,z=sql.raw(`${o} ${a?"all ":""}`);return sql`${v}${z}${$}${C}${q}${w?sql` offset ${w}`:void 0}`}buildInsertQuery({table:s,values:o,onConflict:a,returning:c,withList:u}){const p=[],w=s[Table.Symbol.Columns],v=Object.entries(w),$=v.map((([,s])=>sql.identifier(s.name)));for(const[s,a]of o.entries()){const c=[];for(const[s,o]of v){const u=a[s];if(void 0===u||is(u,Param)&&void 0===u.value){let s;if(null!==o.default&&void 0!==o.default)s=is(o.default,SQL)?o.default:sql.param(o.default,o);else if(void 0!==o.defaultFn){const a=o.defaultFn();s=is(a,SQL)?a:sql.param(a,o)}else if(o.default||void 0===o.onUpdateFn)s=sql`null`;else{const a=o.onUpdateFn();s=is(a,SQL)?a:sql.param(a,o)}c.push(s)}else c.push(u)}p.push(c),s<o.length-1&&p.push(sql`, `)}const C=this.buildWithCTE(u),q=sql.join(p);return sql`${C}insert into ${s} ${$} values ${q}${a?sql` on conflict ${a}`:void 0}${c?sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0}`}sqlToQuery(s,o){return s.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:o})}buildRelationalQuery({fullSchema:s,schema:o,tableNamesMap:a,table:c,tableConfig:u,queryConfig:p,tableAlias:w,nestedQueryRelation:v,joinOn:$}){let C,q,z,j=[],L=[];const Q=[];if(!0===p){j=Object.entries(u.columns).map((([s,o])=>({dbKey:o.name,tsKey:s,field:aliasedTableColumn(o,w),relationTableTsKey:void 0,isJson:!1,selection:[]})))}else{const c=Object.fromEntries(Object.entries(u.columns).map((([s,o])=>[s,aliasedTableColumn(o,w)])));if(p.where){const s="function"==typeof p.where?p.where(c,{and:and,between:between,eq:eq,exists:exists,gt:gt$1,gte:gte,ilike:ilike,inArray:inArray,isNull:isNull,isNotNull:isNotNull,like:like,lt:lt$1,lte:lte,ne:ne,not:not,notBetween:notBetween,notExists:notExists,notLike:notLike,notIlike:notIlike,notInArray:notInArray,or:or,sql:sql}):p.where;z=s&&mapColumnsInSQLToAlias(s,w)}const v=[];let $=[];if(p.columns){let s=!1;for(const[o,a]of Object.entries(p.columns))void 0!==a&&o in u.columns&&(s||!0!==a||(s=!0),$.push(o));$.length>0&&($=s?$.filter((s=>!0===p.columns?.[s])):Object.keys(u.columns).filter((s=>!$.includes(s))))}else $=Object.keys(u.columns);for(const s of $){const o=u.columns[s];v.push({tsKey:s,value:o})}let Q,H=[];if(p.with&&(H=Object.entries(p.with).filter((s=>!!s[1])).map((([s,o])=>({tsKey:s,queryConfig:o,relation:u.relations[s]})))),p.extras){Q="function"==typeof p.extras?p.extras(c,{sql:sql}):p.extras;for(const[s,o]of Object.entries(Q))v.push({tsKey:s,value:mapColumnsInAliasedSQLToAlias(o,w)})}for(const{tsKey:s,value:o}of v)j.push({dbKey:is(o,SQL.Aliased)?o.fieldAlias:u.columns[s].name,tsKey:s,field:is(o,Column)?aliasedTableColumn(o,w):o,relationTableTsKey:void 0,isJson:!1,selection:[]});let K="function"==typeof p.orderBy?p.orderBy(c,{sql:sql,asc:asc,desc:desc}):p.orderBy??[];Array.isArray(K)||(K=[K]),L=K.map((s=>is(s,Column)?aliasedTableColumn(s,w):mapColumnsInSQLToAlias(s,w))),C=p.limit,q=p.offset;for(const{tsKey:c,queryConfig:u,relation:p}of H){const v=normalizeRelation(o,a,p),$=a[getTableUniqueName(p.referencedTable)],C=`${w}_${c}`,q=and(...v.fields.map(((s,o)=>eq(aliasedTableColumn(v.references[o],C),aliasedTableColumn(s,w))))),z=this.buildRelationalQuery({fullSchema:s,schema:o,tableNamesMap:a,table:s[$],tableConfig:o[$],queryConfig:is(p,One)?!0===u?{limit:1}:{...u,limit:1}:u,tableAlias:C,joinOn:q,nestedQueryRelation:p}),L=sql`(${z.sql})`.as(c);j.push({dbKey:c,tsKey:c,field:L,relationTableTsKey:$,isJson:!0,selection:z.selection})}}if(0===j.length)throw new DrizzleError({message:`No fields selected for table "${u.tsName}" ("${w}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});let H;if(z=and($,z),v){let s=sql`json_array(${sql.join(j.map((({field:s})=>is(s,SQLiteColumn)?sql.identifier(s.name):is(s,SQL.Aliased)?s.sql:s)),sql`, `)})`;is(v,Many)&&(s=sql`coalesce(json_group_array(${s}), json_array())`);const o=[{dbKey:"data",tsKey:"data",field:s.as("data"),isJson:!0,relationTableTsKey:u.tsName,selection:j}];void 0!==C||void 0!==q||L.length>0?(H=this.buildSelectQuery({table:aliasedTable(c,w),fields:{},fieldsFlat:[{path:[],field:sql.raw("*")}],where:z,limit:C,offset:q,orderBy:L,setOperators:[]}),z=void 0,C=void 0,q=void 0,L=void 0):H=aliasedTable(c,w),H=this.buildSelectQuery({table:is(H,SQLiteTable)?H:new Subquery(H,{},w),fields:{},fieldsFlat:o.map((({field:s})=>({path:[],field:is(s,Column)?aliasedTableColumn(s,w):s}))),joins:Q,where:z,limit:C,offset:q,orderBy:L,setOperators:[]})}else H=this.buildSelectQuery({table:aliasedTable(c,w),fields:{},fieldsFlat:j.map((({field:s})=>({path:[],field:is(s,Column)?aliasedTableColumn(s,w):s}))),joins:Q,where:z,limit:C,offset:q,orderBy:L,setOperators:[]});return{tableTsKey:u.tsName,sql:H,selection:j}}}class SQLiteSyncDialect extends SQLiteDialect{static[Bo]="SQLiteSyncDialect";migrate(s,o,a){const c=void 0===a||"string"==typeof a?"__drizzle_migrations":a.migrationsTable??"__drizzle_migrations",u=sql`
			CREATE TABLE IF NOT EXISTS ${sql.identifier(c)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;o.run(u);const p=o.values(sql`SELECT id, hash, created_at FROM ${sql.identifier(c)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;o.run(sql`BEGIN`);try{for(const a of s)if(!p||Number(p[2])<a.folderMillis){for(const s of a.sql)o.run(sql.raw(s));o.run(sql`INSERT INTO ${sql.identifier(c)} ("hash", "created_at") VALUES(${a.hash}, ${a.folderMillis})`)}o.run(sql`COMMIT`)}catch(s){throw o.run(sql`ROLLBACK`),s}}}class SQLiteAsyncDialect extends SQLiteDialect{static[Bo]="SQLiteAsyncDialect";async migrate(s,o,a){const c=void 0===a||"string"==typeof a?"__drizzle_migrations":a.migrationsTable??"__drizzle_migrations",u=sql`
			CREATE TABLE IF NOT EXISTS ${sql.identifier(c)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await o.run(u);const p=(await o.values(sql`SELECT id, hash, created_at FROM ${sql.identifier(c)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await o.transaction((async o=>{for(const a of s)if(!p||Number(p[2])<a.folderMillis){for(const s of a.sql)await o.run(sql.raw(s));await o.run(sql`INSERT INTO ${sql.identifier(c)} ("hash", "created_at") VALUES(${a.hash}, ${a.folderMillis})`)}}))}}class TypedQueryBuilder{static[Bo]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class SQLiteSelectBuilder{static[Bo]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(s){this.fields=s.fields,this.session=s.session,this.dialect=s.dialect,this.withList=s.withList,this.distinct=s.distinct}from(s){const o=!!this.fields;let a;return a=this.fields?this.fields:is(s,Subquery)?Object.fromEntries(Object.keys(s._.selectedFields).map((o=>[o,s[o]]))):is(s,SQLiteViewBase)?s[Zo].selectedFields:is(s,SQL)?{}:s[Table.Symbol.Columns],new SQLiteSelectBase({table:s,fields:a,isPartialSelect:o,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class SQLiteSelectQueryBuilderBase extends TypedQueryBuilder{static[Bo]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:s,fields:o,isPartialSelect:a,session:c,dialect:u,withList:p,distinct:w}){super(),this.config={withList:p,table:s,fields:{...o},distinct:w,setOperators:[]},this.isPartialSelect=a,this.session=c,this.dialect=u,this._={selectedFields:o},this.tableName=getTableLikeName(s),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(s){return(o,a)=>{const c=this.tableName,u=getTableLikeName(o);if("string"==typeof u&&this.config.joins?.some((s=>s.alias===u)))throw new Error(`Alias "${u}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof c&&(this.config.fields={[c]:this.config.fields}),"string"==typeof u&&!is(o,SQL))){const s=is(o,Subquery)?o._.selectedFields:is(o,View)?o[Zo].selectedFields:o[Table.Symbol.Columns];this.config.fields[u]=s}if("function"==typeof a&&(a=a(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:a,table:o,joinType:s,alias:u}),"string"==typeof u)switch(s){case"left":this.joinsNotNullableMap[u]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([s])=>[s,!1]))),this.joinsNotNullableMap[u]=!0;break;case"inner":this.joinsNotNullableMap[u]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map((([s])=>[s,!1]))),this.joinsNotNullableMap[u]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(s,o){return a=>{const c="function"==typeof a?a(getSQLiteSetOperators()):a;if(!haveSameKeys(this.getSelectedFields(),c.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:s,isAll:o,rightSelect:c}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(s){return this.config.setOperators.push(...s),this}where(s){return"function"==typeof s&&(s=s(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=s,this}having(s){return"function"==typeof s&&(s=s(new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=s,this}groupBy(...s){if("function"==typeof s[0]){const o=s[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(o)?o:[o]}else this.config.groupBy=s;return this}orderBy(...s){if("function"==typeof s[0]){const o=s[0](new Proxy(this.config.fields,new SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),a=Array.isArray(o)?o:[o];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a}else{const o=s;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=o:this.config.orderBy=o}return this}limit(s){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=s:this.config.limit=s,this}offset(s){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=s:this.config.offset=s,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:s,...o}=this.dialect.sqlToQuery(this.getSQL());return o}as(s){return new Proxy(new Subquery(this.getSQL(),this.config.fields,s),new SelectionProxyHandler({alias:s,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class SQLiteSelectBase extends SQLiteSelectQueryBuilderBase{static[Bo]="SQLiteSelect";_prepare(s=!0){if(!this.session)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const o=orderSelectedFields(this.config.fields),a=this.session[s?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),o,"all",!0);return a.joinsNotNullableMap=this.joinsNotNullableMap,a}prepare(){return this._prepare(!1)}run=s=>this._prepare().run(s);all=s=>this._prepare().all(s);get=s=>this._prepare().get(s);values=s=>this._prepare().values(s);async execute(){return this.all()}}function createSetOperator(s,o){return(a,c,...u)=>{const p=[c,...u].map((a=>({type:s,isAll:o,rightSelect:a})));for(const s of p)if(!haveSameKeys(a.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return a.addSetOperators(p)}}!function(s,o){for(const a of o)for(const o of Object.getOwnPropertyNames(a.prototype))"constructor"!==o&&Object.defineProperty(s.prototype,o,Object.getOwnPropertyDescriptor(a.prototype,o)||Object.create(null))}(SQLiteSelectBase,[QueryPromise]);const getSQLiteSetOperators=()=>({union:sa,unionAll:na,intersect:ia,except:oa}),sa=createSetOperator("union",!1),na=createSetOperator("union",!0),ia=createSetOperator("intersect",!1),oa=createSetOperator("except",!1);class QueryBuilder{static[Bo]="SQLiteQueryBuilder";dialect;$with(s){const o=this;return{as:a=>("function"==typeof a&&(a=a(o)),new Proxy(new WithSubquery(a.getSQL(),a.getSelectedFields(),s,!0),new SelectionProxyHandler({alias:s,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...s){const o=this;return{select:function(a){return new SQLiteSelectBuilder({fields:a??void 0,session:void 0,dialect:o.getDialect(),withList:s})},selectDistinct:function(a){return new SQLiteSelectBuilder({fields:a??void 0,session:void 0,dialect:o.getDialect(),withList:s,distinct:!0})}}}select(s){return new SQLiteSelectBuilder({fields:s??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(s){return new SQLiteSelectBuilder({fields:s??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new SQLiteSyncDialect),this.dialect}}class SQLiteUpdateBuilder{constructor(s,o,a,c){this.table=s,this.session=o,this.dialect=a,this.withList=c}static[Bo]="SQLiteUpdateBuilder";set(s){return new SQLiteUpdateBase(this.table,mapUpdateSet(this.table,s),this.session,this.dialect,this.withList)}}class SQLiteUpdateBase extends QueryPromise{constructor(s,o,a,c,u){super(),this.session=a,this.dialect=c,this.config={set:o,table:s,withList:u}}static[Bo]="SQLiteUpdate";config;where(s){return this.config.where=s,this}returning(s=this.config.table[SQLiteTable.Symbol.Columns]){return this.config.returning=orderSelectedFields(s),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:s,...o}=this.dialect.sqlToQuery(this.getSQL());return o}_prepare(s=!0){return this.session[s?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0)}prepare(){return this._prepare(!1)}run=s=>this._prepare().run(s);all=s=>this._prepare().all(s);get=s=>this._prepare().get(s);values=s=>this._prepare().values(s);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class RelationalQueryBuilder{constructor(s,o,a,c,u,p,w,v){this.mode=s,this.fullSchema=o,this.schema=a,this.tableNamesMap=c,this.table=u,this.tableConfig=p,this.dialect=w,this.session=v}static[Bo]="SQLiteAsyncRelationalQueryBuilder";findMany(s){return"sync"===this.mode?new SQLiteSyncRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,s||{},"many"):new SQLiteRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,s||{},"many")}findFirst(s){return"sync"===this.mode?new SQLiteSyncRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,s?{...s,limit:1}:{limit:1},"first"):new SQLiteRelationalQuery(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,s?{...s,limit:1}:{limit:1},"first")}}class SQLiteRelationalQuery extends QueryPromise{constructor(s,o,a,c,u,p,w,v,$){super(),this.fullSchema=s,this.schema=o,this.tableNamesMap=a,this.table=c,this.tableConfig=u,this.dialect=p,this.session=w,this.config=v,this.mode=$}static[Bo]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(s=!1){const{query:o,builtQuery:a}=this._toSQL();return this.session[s?"prepareOneTimeQuery":"prepareQuery"](a,void 0,"first"===this.mode?"get":"all",!0,((s,a)=>{const c=s.map((s=>mapRelationalRow(this.schema,this.tableConfig,s,o.selection,a)));return"first"===this.mode?c[0]:c}))}prepare(){return this._prepare(!1)}_toSQL(){const s=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName});return{query:s,builtQuery:this.dialect.sqlToQuery(s.sql)}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class SQLiteSyncRelationalQuery extends SQLiteRelationalQuery{static[Bo]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}class SQLiteRaw extends QueryPromise{constructor(s,o,a,c,u){super(),this.execute=s,this.getSQL=o,this.dialect=c,this.mapBatchResult=u,this.config={action:a}}static[Bo]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(s,o){return o?this.mapBatchResult(s):s}_prepare(){return this}isResponseInArrayMode(){return!1}}class BaseSQLiteDatabase{constructor(s,o,a,c){this.resultKind=s,this.dialect=o,this.session=a,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const u=this.query;if(this._.schema)for(const[p,w]of Object.entries(this._.schema))u[p]=new RelationalQueryBuilder(s,c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[p],w,o,a)}static[Bo]="BaseSQLiteDatabase";query;$with(s){return{as:o=>("function"==typeof o&&(o=o(new QueryBuilder)),new Proxy(new WithSubquery(o.getSQL(),o.getSelectedFields(),s,!0),new SelectionProxyHandler({alias:s,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...s){const o=this;return{select:function(a){return new SQLiteSelectBuilder({fields:a??void 0,session:o.session,dialect:o.dialect,withList:s})},selectDistinct:function(a){return new SQLiteSelectBuilder({fields:a??void 0,session:o.session,dialect:o.dialect,withList:s,distinct:!0})},update:function(a){return new SQLiteUpdateBuilder(a,o.session,o.dialect,s)},insert:function(a){return new SQLiteInsertBuilder(a,o.session,o.dialect,s)},delete:function(a){return new SQLiteDeleteBase(a,o.session,o.dialect,s)}}}select(s){return new SQLiteSelectBuilder({fields:s??void 0,session:this.session,dialect:this.dialect})}selectDistinct(s){return new SQLiteSelectBuilder({fields:s??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(s){return new SQLiteUpdateBuilder(s,this.session,this.dialect)}insert(s){return new SQLiteInsertBuilder(s,this.session,this.dialect)}delete(s){return new SQLiteDeleteBase(s,this.session,this.dialect)}run(s){const o=s.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.run(o)),(()=>o),"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(o)}all(s){const o=s.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.all(o)),(()=>o),"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(o)}get(s){const o=s.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.get(o)),(()=>o),"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(o)}values(s){const o=s.getSQL();return"async"===this.resultKind?new SQLiteRaw((async()=>this.session.values(o)),(()=>o),"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(o)}transaction(s,o){return this.session.transaction(s,o)}}class ExecuteResultSync extends QueryPromise{constructor(s){super(),this.resultCb=s}static[Bo]="ExecuteResultSync";async execute(){return this.resultCb()}sync(){return this.resultCb()}}class SQLitePreparedQuery{constructor(s,o,a){this.mode=s,this.executeMethod=o,this.query=a}static[Bo]="PreparedQuery";joinsNotNullableMap;getQuery(){return this.query}mapRunResult(s,o){return s}mapAllResult(s,o){throw new Error("Not implemented")}mapGetResult(s,o){throw new Error("Not implemented")}execute(s){return"async"===this.mode?this[this.executeMethod](s):new ExecuteResultSync((()=>this[this.executeMethod](s)))}mapResult(s,o){switch(this.executeMethod){case"run":return this.mapRunResult(s,o);case"all":return this.mapAllResult(s,o);case"get":return this.mapGetResult(s,o)}}}class SQLiteSession{constructor(s){this.dialect=s}static[Bo]="SQLiteSession";prepareOneTimeQuery(s,o,a,c){return this.prepareQuery(s,o,a,c)}run(s){const o=this.dialect.sqlToQuery(s);try{return this.prepareOneTimeQuery(o,void 0,"run",!1).run()}catch(s){throw new DrizzleError({cause:s,message:`Failed to run the query '${o.sql}'`})}}extractRawRunValueFromBatchResult(s){return s}all(s){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(s),void 0,"run",!1).all()}extractRawAllValueFromBatchResult(s){throw new Error("Not implemented")}get(s){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(s),void 0,"run",!1).get()}extractRawGetValueFromBatchResult(s){throw new Error("Not implemented")}values(s){return this.prepareOneTimeQuery(this.dialect.sqlToQuery(s),void 0,"run",!1).values()}extractRawValuesValueFromBatchResult(s){throw new Error("Not implemented")}}class SQLiteTransaction extends BaseSQLiteDatabase{constructor(s,o,a,c,u=0){super(s,o,a,c),this.schema=c,this.nestedIndex=u}static[Bo]="SQLiteTransaction";rollback(){throw new TransactionRollbackError}}class SQLiteD1Session extends SQLiteSession{constructor(s,o,a,c={}){super(o),this.client=s,this.schema=a,this.options=c,this.logger=c.logger??new NoopLogger}static[Bo]="SQLiteD1Session";logger;prepareQuery(s,o,a,c,u){const p=this.client.prepare(s.sql);return new D1PreparedQuery(p,s,this.logger,o,a,c,u)}async batch(s){const o=[],a=[];for(const c of s){const s=c._prepare(),u=s.getQuery();if(o.push(s),u.params.length>0)a.push(s.stmt.bind(...u.params));else{const o=s.getQuery();a.push(this.client.prepare(o.sql).bind(...o.params))}}return(await this.client.batch(a)).map(((s,a)=>o[a].mapResult(s,!0)))}extractRawAllValueFromBatchResult(s){return s.results}extractRawGetValueFromBatchResult(s){return s.results[0]}extractRawValuesValueFromBatchResult(s){return d1ToRawMapping(s.results)}async transaction(s,o){const a=new D1Transaction("async",this.dialect,this,this.schema);await this.run(sql.raw("begin"+(o?.behavior?" "+o.behavior:"")));try{const o=await s(a);return await this.run(sql`commit`),o}catch(s){throw await this.run(sql`rollback`),s}}}class D1Transaction extends SQLiteTransaction{static[Bo]="D1Transaction";async transaction(s){const o=`sp${this.nestedIndex}`,a=new D1Transaction("async",this.dialect,this.session,this.schema,this.nestedIndex+1);await this.session.run(sql.raw(`savepoint ${o}`));try{const c=await s(a);return await this.session.run(sql.raw(`release savepoint ${o}`)),c}catch(s){throw await this.session.run(sql.raw(`rollback to savepoint ${o}`)),s}}}function d1ToRawMapping(s){const o=[];for(const a of s){const s=Object.keys(a).map((s=>a[s]));o.push(s)}return o}class D1PreparedQuery extends SQLitePreparedQuery{constructor(s,o,a,c,u,p,w){super("async",u,o),this.logger=a,this._isResponseInArrayMode=p,this.customResultMapper=w,this.fields=c,this.stmt=s}static[Bo]="D1PreparedQuery";customResultMapper;fields;stmt;run(s){const o=fillPlaceholders(this.query.params,s??{});return this.logger.logQuery(this.query.sql,o),this.stmt.bind(...o).run()}async all(s){const{fields:o,query:a,logger:c,stmt:u,customResultMapper:p}=this;if(!o&&!p){const o=fillPlaceholders(a.params,s??{});return c.logQuery(a.sql,o),u.bind(...o).all().then((({results:s})=>this.mapAllResult(s)))}const w=await this.values(s);return this.mapAllResult(w)}mapAllResult(s,o){return o&&(s=d1ToRawMapping(s.results)),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper(s):s.map((s=>mapResultRow(this.fields,s,this.joinsNotNullableMap))):s}async get(s){const{fields:o,joinsNotNullableMap:a,query:c,logger:u,stmt:p,customResultMapper:w}=this;if(!o&&!w){const o=fillPlaceholders(c.params,s??{});return u.logQuery(c.sql,o),p.bind(...o).all().then((({results:s})=>s[0]))}const v=await this.values(s);if(v[0])return w?w(v):mapResultRow(o,v[0],a)}mapGetResult(s,o){return o&&(s=d1ToRawMapping(s.results)[0]),this.fields||this.customResultMapper?this.customResultMapper?this.customResultMapper([s]):mapResultRow(this.fields,s,this.joinsNotNullableMap):s}values(s){const o=fillPlaceholders(this.query.params,s??{});return this.logger.logQuery(this.query.sql,o),this.stmt.bind(...o).raw()}isResponseInArrayMode(){return this._isResponseInArrayMode}}class DrizzleD1Database extends BaseSQLiteDatabase{static[Bo]="D1Database";async batch(s){return this.session.batch(s)}}function drizzle(s,o={}){const a=new SQLiteAsyncDialect;let c,u;if(!0===o.logger?c=new DefaultLogger:!1!==o.logger&&(c=o.logger),o.schema){const s=function(s,o){1===Object.keys(s).length&&"default"in s&&!is(s.default,Table)&&(s=s.default);const a={},c={},u={};for(const[p,w]of Object.entries(s))if(is(w,Table)){const s=getTableUniqueName(w),o=c[s];a[s]=p,u[p]={tsName:p,dbName:w[Table.Symbol.Name],schema:w[Table.Symbol.Schema],columns:w[Table.Symbol.Columns],relations:o?.relations??{},primaryKey:o?.primaryKey??[]};for(const s of Object.values(w[Table.Symbol.Columns]))s.primary&&u[p].primaryKey.push(s);const v=w[Table.Symbol.ExtraConfigBuilder]?.(w[Table.Symbol.ExtraConfigColumns]);if(v)for(const s of Object.values(v))is(s,PrimaryKeyBuilder)&&u[p].primaryKey.push(...s.columns)}else if(is(w,Relations)){const s=getTableUniqueName(w.table),p=a[s],v=w.config(o(w.table));let $;for(const[o,a]of Object.entries(v))p?u[p].relations[o]=a:(s in c||(c[s]={relations:{},primaryKey:$}),c[s].relations[o]=a)}return{tables:u,tableNamesMap:a}}(o.schema,createTableRelationsHelpers);u={fullSchema:o.schema,schema:s.tables,tableNamesMap:s.tableNamesMap}}const p=new SQLiteD1Session(s,a,u,{logger:c});return new DrizzleD1Database("async",a,p,u)}var aa=Object.defineProperty,__publicField$2=(s,o,a)=>((s,o,a)=>o in s?aa(s,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[o]=a)(s,o+"",a);function yt$2(s){let o;const a=ca(s),c={duplex:"half",method:s.method,headers:s.headers};return s.node.req.body instanceof ArrayBuffer?new Request(a,{...c,body:s.node.req.body}):new Request(a,{...c,get body(){return o||(o=$a(s),o)}})}function vt$2(){return getContext("nitro-app",{asyncContext:!!(null==(s=globalThis.app.config.server.experimental)?void 0:s.asyncContext),AsyncLocalStorage:p}).use().event;var s}const la=Symbol("$HTTPEvent");function R$1(s){return function(...o){var a;let c=o[0];if(function(s){return"object"==typeof s&&(s instanceof H3Event||(null==s?void 0:s[la])instanceof H3Event||!0===(null==s?void 0:s.__is_event__))}(c))o[0]=c instanceof H3Event||c.__is_event__?c:c[la];else{if(!(null==(a=globalThis.app.config.server.experimental)?void 0:a.asyncContext))throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(c=vt$2(),!c)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");o.unshift(c)}return s(...o)}}const ca=R$1(getRequestURL),ua=R$1(getRequestIP),da=R$1(setResponseStatus),ha=R$1(getResponseStatus),fa=R$1(getResponseStatusText),pa=R$1(getResponseHeaders),ma=R$1(getResponseHeader),ga=R$1(setResponseHeader),ya=R$1(appendResponseHeader),ba=R$1(parseCookies),wa=R$1(getCookie),va=R$1(setCookie),Sa=R$1(useSession),xa=R$1(Io),$a=R$1(getRequestWebStream),_a=R$1(removeResponseHeader),Ea=R$1((function(s){return null!=s.web||(s.web={request:yt$2(s),url:ca(s)}),s.web.request}));const Ra="solidFetchEvent";function qt$1(s){return{...s}}function _n(s){if(!s.context[Ra]){const o=function(s){return{request:Ea(s),response:Tt$1(s),clientAddress:ua(s),locals:{},nativeEvent:s}}(s);s.context[Ra]=o}return s.context[Ra]}function An(s,o){for(const[a,c]of o.entries())ya(s,a,c)}let Ta=class{constructor(s){__publicField$2(this,"event"),this.event=s}get(s){const o=ma(this.event,s);return Array.isArray(o)?o.join(", "):o||null}has(s){return void 0!==this.get(s)}set(s,o){return ga(this.event,s,o)}delete(s){return _a(this.event,s)}append(s,o){ya(this.event,s,o)}getSetCookie(){const s=ma(this.event,"Set-Cookie");return Array.isArray(s)?s:[s]}forEach(s){return Object.entries(pa(this.event)).forEach((([o,a])=>s(Array.isArray(a)?a.join(", "):a,o,this)))}entries(){return Object.entries(pa(this.event)).map((([s,o])=>[s,Array.isArray(o)?o.join(", "):o]))[Symbol.iterator]()}keys(){return Object.keys(pa(this.event))[Symbol.iterator]()}values(){return Object.values(pa(this.event)).map((s=>Array.isArray(s)?s.join(", "):s))[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}};function Tt$1(s){return{get status(){return ha(s)},set status(o){da(s,o)},get statusText(){return fa(s)},set statusText(o){da(s,ha(s),o)},headers:new Ta(s)}}const Aa=/^(?:[a-z0-9]+:)?\/\//i,Ca=/^\/+|(\/)\/+$/g,ka="http://sr";function D$3(s,o=!1){const a=s.replace(Ca,"$1");return a?o||/^[?#]/.test(a)?a:"/"+a:""}function N$1(s,o,a){if(Aa.test(o))return;const c=D$3(s),u=a&&D$3(a);let p="";return p=!u||o.startsWith("/")?c:0!==u.toLowerCase().indexOf(c.toLowerCase())?c+u:u,(p||"/")+D$3(o,!p)}function Bt$1(s,o){return D$3(s).replace(/\/*(\*.*)?$/g,"")+D$3(o)}function Pe$2(s){const o={};return s.searchParams.forEach(((s,a)=>{a in o?Array.isArray(o[a])?o[a].push(s):o[a]=[o[a],s]:o[a]=s})),o}function kt$1(s,o,a){const[c,u]=s.split("/*",2),p=c.split("/").filter(Boolean),w=p.length;return s=>{const c=s.split("/").filter(Boolean),v=c.length-w;if(v<0||v>0&&void 0===u&&!o)return null;const $={path:w?"":"/",params:{}},i=s=>void 0===a?void 0:a[s];for(let s=0;s<w;s++){const o=p[s],a=":"===o[0],u=a?c[s]:c[s].toLowerCase(),w=a?o.slice(1):o.toLowerCase();if(a&&Y$2(u,i(w)))$.params[w]=u;else if(a||!Y$2(u,w))return null;$.path+=`/${u}`}if(u){const s=v?c.slice(-v).join("/"):"";if(!Y$2(s,i(u)))return null;$.params[u]=s}return $}}function Y$2(s,o){const n=o=>o===s;return void 0===o||("string"==typeof o?n(o):"function"==typeof o?o(s):Array.isArray(o)?o.some(n):o instanceof RegExp&&o.test(s))}function It$1(s){const[o,a]=s.pattern.split("/*",2),c=o.split("/").filter(Boolean);return c.reduce(((s,o)=>s+(o.startsWith(":")?2:3)),c.length-(void 0===a?0:1))}function Oe$1(s){const o=new Map,a=getOwner();return new Proxy({},{get:(c,u)=>(o.has(u)||runWithOwner(a,(()=>o.set(u,createMemo((()=>s()[u]))))),o.get(u)()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),ownKeys:()=>Reflect.ownKeys(s())})}function _e$1(s){let o=/(\/?\:[^\/]+)\?/.exec(s);if(!o)return[s];let a=s.slice(0,o.index),c=s.slice(o.index+o[0].length);const u=[a,a+=o[1]];for(;o=/^(\/\:[^\/]+)\?/.exec(c);)u.push(a+=o[1]),c=c.slice(o[0].length);return _e$1(c).reduce(((s,o)=>[...s,...u.map((s=>s+o))]),[])}const qa=createContext(),za=createContext(),Ae$2=()=>function(s,o){if(null==s)throw new Error(o);return s}(useContext(qa),"<A> and 'use' router primitives can be only used inside a Route.");function Kt$1(s,o=""){const{component:a,preload:c,load:u,children:p,info:w}=s,v=!p||Array.isArray(p)&&!p.length,$={key:s,component:a,preload:c||u,info:w};return He$1(s.path).reduce(((a,c)=>{for(const u of _e$1(c)){const p=Bt$1(o,u);let w=v?p:p.split("/*",1)[0];w=w.split("/").map((s=>s.startsWith(":")||s.startsWith("*")?s:encodeURIComponent(s))).join("/"),a.push({...$,originalPath:c,pattern:w,matcher:kt$1(w,!v,s.matchFilters)})}return a}),[])}function Nt$1(s,o=0){return{routes:s,score:1e4*It$1(s[s.length-1])-o,matcher(o){const a=[];for(let c=s.length-1;c>=0;c--){const u=s[c],p=u.matcher(o);if(!p)return null;a.unshift({...p,route:u})}return a}}}function He$1(s){return Array.isArray(s)?s:[s]}function Gt$1(s,o="",a=[],c=[]){const u=He$1(s);for(let s=0,p=u.length;s<p;s++){const p=u[s];if(p&&"object"==typeof p){p.hasOwnProperty("path")||(p.path="");const s=Kt$1(p,o);for(const o of s){a.push(o);const s=Array.isArray(p.children)&&0===p.children.length;if(p.children&&!s)Gt$1(p.children,o.pattern,a,c);else{const s=Nt$1([...a],c.length);c.push(s)}a.pop()}}}return a.length?c:c.sort(((s,o)=>o.score-s.score))}function Q$1(s,o){for(let a=0,c=s.length;a<c;a++){const c=s[a].matcher(o);if(c)return c}return[]}let Pa;function Jt(){return Pa}let ja=!1;function $n$1(s){ja=s}function Tn$1(s,o,a,c={}){const{signal:[u,p],utils:w={}}=s,v=w.parsePath||(s=>s),$=w.renderPath||(s=>s),C=w.beforeLeave||function(){let s=new Set,o=!1;return{subscribe:function(o){return s.add(o),()=>s.delete(o)},confirm:function(a,c){if(o)return!(o=!1);const u={to:a,options:c,defaultPrevented:!1,preventDefault:()=>u.defaultPrevented=!0};for(const p of s)p.listener({...u,from:p.location,retry:s=>{s&&(o=!0),p.navigate(a,{...c,resolve:!1})}});return!u.defaultPrevented}}}(),q=N$1("",c.base||"");if(void 0===q)throw new Error(`${q} is not a valid base path`);q&&!u().value&&p({value:q,replace:!0,scroll:!1});const[z,j]=createSignal(!1);let L;const[Q,H]=createSignal(u().value),[K,J]=createSignal(u().state),Z=function(s,o,a){const c=new URL(ka),u=createMemo((o=>{const a=s();try{return new URL(a,c)}catch{return console.error(`Invalid path ${a}`),o}}),c),p=createMemo((()=>u().pathname)),w=createMemo((()=>u().search),!0),v=createMemo((()=>u().hash)),$=on$2(w,(()=>Pe$2(u())));return{get pathname(){return p()},get search(){return w()},get hash(){return v()},get state(){return o()},get key(){return""},query:a?a($):Oe$1($)}}(Q,K,w.queryWrapper),X=[],te=createSignal(function(){const s=getRequestEvent();return s&&s.router&&s.router.submission?[s.router.submission]:[]}()),oe=createMemo((()=>"function"==typeof c.transformUrl?Q$1(o(),c.transformUrl(Z.pathname)):Q$1(o(),Z.pathname))),ie=()=>{const s=oe(),o={};for(let a=0;a<s.length;a++)Object.assign(o,s[a].params);return o},ae=w.paramsWrapper?w.paramsWrapper(ie,o):Oe$1(ie),le={pattern:q,path:()=>q,outlet:()=>null,resolvePath:s=>N$1(q,s)};return createRenderEffect(on$2(u,(s=>((s,o)=>{o.value===Q()&&o.state===K()||(void 0===L&&j(!0),Pa=s,L=o,startTransition((()=>{L===o&&(H(L.value),J(L.state))})).finally((()=>{L===o&&batch((()=>{Pa=void 0,j(!1),L=void 0}))})))})("native",s)),{defer:!0})),{base:le,location:Z,params:ae,isRouting:z,renderPath:$,parsePath:v,navigatorFactory:function(s){return s=s||useContext(za)||le,(o,a)=>function(s,o,a){wo((()=>{if("number"==typeof o)return void(o&&(w.go?w.go(o):console.warn("Router integration does not support relative routing")));const c=!o||"?"===o[0],{replace:u,resolve:v,scroll:$,state:C}={replace:!1,resolve:!c,scroll:!0,...a},q=v?s.resolvePath(o):N$1(c&&Z.pathname||"",o);if(void 0===q)throw new Error(`Path '${o}' is not a routable path`);if(X.length>=100)throw new Error("Too many redirects");if(q!==Q()||C!==K()){const s=getRequestEvent();s&&(s.response={status:302,headers:new Headers({Location:q})}),p({value:q,replace:u,scroll:$,state:C})}}))}(s,o,a)},matches:oe,beforeLeave:C,preloadRoute:function(s,c){const u=Q$1(o(),s.pathname),p=Pa;Pa="preload";for(let o in u){const{route:p,params:w}=u[o];p.component&&p.component.preload&&p.component.preload();const{preload:v}=p;ja=!0,c&&v&&runWithOwner(a(),(()=>v({params:w,location:{pathname:s.pathname,search:s.search,hash:s.hash,query:Pe$2(s),state:null,key:""},intent:"preload"}))),ja=!1}Pa=p},singleFlight:void 0===c.singleFlight||c.singleFlight,submissions:te}}function Un$1(s,o,a,c){const{base:u,location:p,params:w}=s,{pattern:v,component:$,preload:C}=c().route,q=createMemo((()=>c().path));$&&$.preload&&$.preload(),ja=!0;const z=C?C({params:w,location:p,intent:Pa||"initial"}):void 0;return ja=!1,{parent:o,pattern:v,path:q,outlet:()=>$?createComponent($,{params:w,location:p,data:z,get children(){return a()}}):a(),resolvePath:s=>N$1(u.path(),s,q())}}let Ia=new Map;function B$2(){const s=getRequestEvent();if(!s)throw new Error("Cannot find cache context");return(s.router||(s.router={})).cache||(s.router.cache=new Map)}function qe$3(s,o){s&&!Array.isArray(s)&&(s=[s]);for(let a of Ia.keys())(void 0===s||$e$2(a,s))&&o(Ia.get(a))}function U(s,o){s.GET&&(s=s.GET);const n=(...a)=>{const c=B$2(),u=Jt(),p=ja,w=getOwner()?Ae$2().navigatorFactory():void 0,v=Date.now(),$=o+ee$1(a);let C,q=c.get($);{const s=getRequestEvent();if(s){const o=(s.router||(s.router={})).dataOnly;if(o){const a=s&&(s.router.data||(s.router.data={}));if(a&&$ in a)return a[$];if(Array.isArray(o)&&!$e$2($,o))return a[$]=void 0,Promise.resolve()}}}if(q&&q[0]){"preload"===q[3]&&"preload"!==u&&(q[0]=v);let s=q[1];return"preload"!==u&&(s="then"in q[1]?q[1].then(y(!1),y(!0)):y(!1)(q[1])),p&&"then"in s&&s.catch((()=>{})),s}C=s(...a),q?(q[0]=v,q[1]=C,q[3]=u):(c.set($,q=[v,C,,u,createSignal(v)]),q[4].count=0);{const s=getRequestEvent();if(s&&s.router.dataOnly)return s.router.data[$]=C}if("preload"!==u&&(C="then"in C?C.then(y(!1),y(!0)):y(!1)(C)),p&&"then"in C&&C.catch((()=>{})),vo.context&&vo.context.async&&!vo.context.noHydrate){const s=getRequestEvent();(!s||!s.serverOnly)&&vo.context.serialize($,C)}return C;function y(s){return async o=>{if(o instanceof Response){const s=o.headers.get("Location");if(null!==s){if(w&&s.startsWith("/"))startTransition((()=>{w(s,{replace:!0})}));else{const o=getRequestEvent();o&&(o.response={status:302,headers:new Headers({Location:s})})}return}o.customBody&&(o=await o.customBody())}if(s)throw o;return q[2]=o,o}}};return n.keyFor=(...s)=>o+ee$1(s),n.key=o,n}function $e$2(s,o){for(let a of o)if(a&&s.startsWith(a))return!0;return!1}function ee$1(s){return JSON.stringify(s,((s,o)=>function(s){let o;return null!=s&&"object"==typeof s&&(!(o=Object.getPrototypeOf(s))||o===Object.prototype)}(o)?Object.keys(o).sort().reduce(((s,a)=>(s[a]=o[a],s)),{}):o))}function Fn$1(s,o){const a=function(s){const o=Ae$2(),a=createMemo((()=>o.submissions[0]().filter((o=>o.url===s.base&&!0))));return new Proxy([],{get:(s,o)=>o===mo?a():"pending"===o?a().some((s=>!s.result)):a()[o],has:(s,o)=>o in a()})}(s);return new Proxy({},{get(s,o){var c;return 0===a.length&&"clear"===o||"retry"===o?()=>{}:null==(c=a[a.length-1])?void 0:c[o]}})}function Te$1(s,o={}){function n(...o){const u=this.r,p=this.f,w=(u.singleFlight&&s.withOptions?s.withOptions({headers:{"X-Single-Flight":"true"}}):s)(...o),[v,$]=createSignal();let C;function g(s){return async o=>{var c;const w=await async function(s,o,a){let c,u,p,w;if(s instanceof Response){if(s.headers.has("X-Revalidate")&&(p=s.headers.get("X-Revalidate").split(",")),s.customBody&&(c=u=await s.customBody(),s.headers.has("X-Single-Flight")&&(c=c._$value,delete u._$value,w=Object.keys(u))),s.headers.has("Location")){const o=s.headers.get("Location")||"/";o.startsWith("http")?window.location.href=o:a(o)}}else{if(o)return{error:s};c=s}return qe$3(p,(s=>s[0]=0)),w&&w.forEach((s=>U.set(s,u[s]))),await function(s,o=!0){return startTransition((()=>{const a=Date.now();qe$3(s,(s=>{o&&(s[0]=0),s[4][1](a)}))}))}(p,!1),null!=c?{data:c}:void 0}(o,s,u.navigatorFactory());let v=null;if(null==(c=a.onComplete)||c.call(a,{...C,result:null==w?void 0:w.data,error:null==w?void 0:w.error,pending:!1,retry:()=>v=C.retry()}),v)return v;if(!w)return C.clear();if($(w),w.error&&!p)throw w.error;return w.data}}return u.submissions[1]((a=>[...a,C={input:o,url:c,get result(){var s;return null==(s=v())?void 0:s.data},get error(){var s;return null==(s=v())?void 0:s.error},get pending(){return!v()},clear(){u.submissions[1]((s=>s.filter((s=>s!==C))))},retry:()=>($(void 0),s(...o).then(g(),g(!0)))}])),w.then(g(),g(!0))}const a="string"==typeof o?{name:o}:o,c=s.url||a.name&&`https://action/${a.name}`||"";return n.base=c,Ue(n,c)}function Ue(s,o){return s.toString=()=>{if(!o)throw new Error("Client Actions need explicit names if server rendered");return o},s.with=function(...a){const r=function(...o){return s.call(this,...a,...o)};r.base=s.base;const c=new URL(o,ka);return c.searchParams.set("args",ee$1(a)),Ue(r,("https://action"===c.origin?c.origin:"")+c.pathname+c.search)},s.url=o,s}function G$1(s,o=302){let a,c;"number"==typeof o?a={status:o}:(({revalidate:c,...a}=o),typeof a.status>"u"&&(a.status=302));const u=new Headers(a.headers);return u.set("Location",s),void 0!==c&&u.set("X-Revalidate",c.toString()),new Response(null,{...a,headers:u})}function re$1(s,o,a){if("function"!=typeof s)throw new Error("Export from a 'use server' module must be a function");return new Proxy(s,{get:(s,c,u)=>"url"===c?`/_server?id=${encodeURIComponent(o)}&name=${encodeURIComponent(a)}`:"GET"===c?u:s[c],apply(c,u,p){const w=getRequestEvent();if(!w)throw new Error("Cannot call server function outside of a request");const v=qt$1(w);return v.locals.serverFunctionMeta={id:o+"#"+a},v.serverOnly=!0,provideRequestEvent(v,(()=>s.apply(u,p)))}})}function K$2(){var s,o,a,c,u,p,w;const v=getRequestEvent();if(!v)throw new Error("getDb must be called in a request context");let $;try{const C=v.nativeEvent.context.cloudflare;if(console.log("Request event structure:",{hasEnv:!!C.env,hasPlatform:!!C.platform,hasContext:!!C.context,envKeys:C.env?Object.keys(C.env):[],platformEnvKeys:(null==(s=C.platform)?void 0:s.env)?Object.keys(C.platform.env):[],contextEnvKeys:(null==(o=C.context)?void 0:o.env)?Object.keys(C.context.env):[]}),null==(a=C.env)?void 0:a.DB)console.log("Found DB in event.nativeEvent.env"),$=C.env.DB;else if(null==(u=null==(c=C.platform)?void 0:c.env)?void 0:u.DB)console.log("Found DB in event.nativeEvent.platform.env"),$=C.platform.env.DB;else{if(!(null==(w=null==(p=C.context)?void 0:p.env)?void 0:w.DB))throw console.error("D1 database binding not found in any expected location"),new Error("D1 database binding not found in environment");console.log("Found DB in event.nativeEvent.context.env"),$=C.context.env.DB}}catch(s){throw console.error("Error accessing DB binding:",s),new Error("Failed to access D1 database binding")}return drizzle($)}U.get=s=>B$2().get(s)[2],U.set=(s,o)=>{const a=B$2(),c=Date.now();let u=a.get(s);u?(u[0]=c,u[1]=Promise.resolve(o),u[2]=o,u[3]="preload"):(a.set(s,u=[c,Promise.resolve(o),o,"preload",createSignal(c)]),u[4].count=0)},U.delete=s=>B$2().delete(s),U.clear=()=>B$2().clear();const Oa={select:()=>K$2().select(),insert:s=>K$2().insert(s),update:s=>K$2().update(s),delete:s=>K$2().delete(s)},La=sqliteTable("users",{id:integer("id").primaryKey().unique().notNull(),username:text("username").notNull().default(""),password:text("password").notNull().default("")});function se$1(){var s;return Sa({password:null!=(s=z.env.SESSION_SECRET)?s:"areallylongsecretthatyoushouldreplace"})}const Na=re$1((async function(s){const o=String(s.get("username")),a=String(s.get("password")),c=String(s.get("loginType"));let u=function(s){if("string"!=typeof s||s.length<3)return"Usernames must be at least 3 characters long"}(o)||function(s){if("string"!=typeof s||s.length<6)return"Passwords must be at least 6 characters long"}(a);if(u)return new Error(u);try{const s=await("login"!==c?async function(s,o){if(await Oa.select().from(La).where(eq(La.username,s)).get())throw new Error("User already exists");return Oa.insert(La).values({username:s,password:o}).returning().get()}(o,a):async function(s,o){const a=await Oa.select().from(La).where(eq(La.username,s)).get();if(!a||o!==a.password)throw new Error("Invalid login");return a}(o,a));await(await se$1()).update((o=>{o.userId=s.id}))}catch(s){return s}throw G$1("/")}),"src_api_server_ts--loginOrRegister_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Qa=Na,Ba=re$1((async function(){throw await(await se$1()).update((s=>s.userId=void 0)),G$1("/login")}),"src_api_server_ts--logout_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Da=re$1((async function(){const s=(await se$1()).data.userId;if(void 0===s)throw G$1("/login");try{const o=await Oa.select().from(La).where(eq(La.id,s)).get();if(!o)throw G$1("/login");return{id:o.id,username:o.username}}catch{throw Ba()}}),"src_api_server_ts--getUser_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Ma=U(Da,"user"),Ha=Te$1(Qa,"loginOrRegister"),Fa=Te$1(Ba,"logout");var Ua=Object.defineProperty,__publicField$1=(s,o,a)=>((s,o,a)=>o in s?Ua(s,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[o]=a)(s,"symbol"!=typeof o?o+"":o,a);const Ka="Invariant Violation",{setPrototypeOf:Wa=function(s,o){return s.__proto__=o,s}}=Object;let Va=class T extends Error{constructor(s=Ka){super("number"==typeof s?`${Ka}: ${s} (see https://github.com/apollographql/invariant-packages)`:s),__publicField$1(this,"framesToPop",1),__publicField$1(this,"name",Ka),Wa(this,T.prototype)}};const Ja={preload(){Ma()}},Ga=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("../build/_...404_.mjs"),import:()=>import("../build/_...404_.mjs")},path:"/*404",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../build/index.mjs"),import:()=>import("../build/index.mjs")},$$route:{require:()=>({route:Ja}),src:"src/routes/index.tsx?pick=route"},path:"/",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/index.tsx"},{page:!0,$component:{src:"src/routes/login.tsx?pick=default&pick=$css",build:()=>import("../build/login.mjs"),import:()=>import("../build/login.mjs")},path:"/login",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/login.tsx"}],Ya=function(s){function r(s,o,a,c){const u=Object.values(s).find((s=>a.startsWith(s.id+"/")));return u?(r(u.children||(u.children=[]),o,a.slice(u.id.length)),s):(s.push({...o,id:a,path:a.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/")}),s)}return s.sort(((s,o)=>s.path.length-o.path.length)).reduce(((s,o)=>r(s,o,o.path,o.path)),[])}(Ga.filter((s=>s.page)));createRouter$1({routes:Ga.reduce(((s,o)=>{if(!function(s){return s.$HEAD||s.$GET||s.$POST||s.$PUT||s.$PATCH||s.$DELETE}(o))return s;let a=o.path.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/").replace(/\*([^/]*)/g,((s,o)=>`**:${o}`)).split("/").map((s=>s.startsWith(":")||s.startsWith("*")?s:encodeURIComponent(s))).join("/");if(/:[^/]*\?/g.test(a))throw new Error(`Optional parameters are not supported in API routes: ${a}`);if(s[a])throw new Error(`Duplicate API routes for "${a}" found at "${s[a].route.path}" and "${o.path}"`);return s[a]={route:o},s}),{})});const Za={style:s=>ssrElement("style",s.attrs,(()=>s.children)),link:s=>ssrElement("link",s.attrs,void 0),script:s=>s.attrs.src?ssrElement("script",mergeProps((()=>s.attrs),{get id(){return s.key}}),(()=>ssr(" "))):null,noscript:s=>ssrElement("noscript",s.attrs,(()=>escape(s.children)))};function ve(s,o,a,c="default"){return lazy((async()=>{var a;{const u=(await s.import())[c],p=(await(null==(a=o.inputs)?void 0:a[s.src].assets())).filter((s=>"style"===s.tag||"stylesheet"===s.attrs.rel));return{default:s=>[...p.map((s=>function(s,o){let{tag:a,attrs:{key:c,...u}={key:void 0},children:p}=s;return Za[a]({attrs:{...u,nonce:o},key:c,children:p})}(s))),createComponent(u,s)]}}}))}const Ae$1=()=>getRequestEvent().routes;function Se$1(s){const o=wa(s.nativeEvent,"flash");if(o)try{let s=JSON.parse(o);if(!s||!s.result)return;const a=[...s.input.slice(0,-1),new Map(s.input[s.input.length-1])],c=s.error?new Error(s.result):s.result;return{input:a,url:s.url,pending:!1,result:s.thrown?void 0:c,error:s.thrown?c:void 0}}catch(s){console.error(s)}finally{va(s.nativeEvent,"flash","",{maxAge:0})}}const Xa=new Set([301,302,303,307,308]);const el={"src_api_server_ts--loginOrRegister_1":{functionName:"loginOrRegister_1",importer:()=>import("../build/server-B-YuvM1W.mjs")},"src_api_server_ts--logout_1":{functionName:"logout_1",importer:()=>import("../build/server-B-YuvM1W.mjs")},"src_api_server_ts--getUser_1":{functionName:"getUser_1",importer:()=>import("../build/server-B-YuvM1W.mjs")}};function O(s,o){return new ReadableStream({start(a){gr(o,{scopeId:s,plugins:[Hi,Ui,Wi,Xi,to,io,ao,co,po,ho],onSerialize(o,c){a.enqueue(function(s){const o=(new TextEncoder).encode(s),a=o.length,c=a.toString(16),u="00000000".substring(0,8-c.length)+c,p=(new TextEncoder).encode(`;0x${u};`),w=new Uint8Array(12+a);return w.set(p),w.set(o,12),w}(c?`(${xr(s)},${o})`:o))},onDone(){a.close()},onError(s){a.error(s)}})}})}function I(s,o,a,c){const u=new URL(o.url),p=s instanceof Error;let w,v=302;return s instanceof Response?(w=new Headers(s.headers),s.headers.has("Location")&&(w.set("Location",new URL(s.headers.get("Location"),u.origin+"").toString()),v=function(s){return s.status&&Xa.has(s.status)?s.status:302}(s))):w=new Headers({Location:new URL(o.headers.get("referer")).toString()}),s&&w.append("Set-Cookie",`flash=${encodeURIComponent(JSON.stringify({url:u.pathname+u.search,result:p?s.message:s,thrown:c,error:p,input:[...a.slice(0,-1),[...a[a.length-1].entries()]]}))}; Secure; HttpOnly;`),new Response(null,{status:v,headers:w})}let tl;function qe$2(s){var o;const a=new Headers(s.request.headers),c=ba(s.nativeEvent),u=s.response.headers.getSetCookie();a.delete("cookie");let p=!1;return(null==(o=s.nativeEvent.node)?void 0:o.req)&&(p=!0,s.nativeEvent.node.req.headers.cookie=""),u.forEach((s=>{if(!s)return;const o=s.split(";")[0],[a,u]=o.split("=");a&&u&&(c[a]=u)})),Object.entries(c).forEach((([o,c])=>{a.append("cookie",`${o}=${c}`),p&&(s.nativeEvent.node.req.headers.cookie+=`${o}=${c};`)})),a}async function A(s,o){let a,c=new URL(s.request.headers.get("referer")).toString();o instanceof Response&&(o.headers.has("X-Revalidate")&&(a=o.headers.get("X-Revalidate").split(",")),o.headers.has("Location")&&(c=new URL(o.headers.get("Location"),new URL(s.request.url).origin+"").toString()));const u=qt$1(s);return u.request=new Request(c,{headers:qe$2(s)}),await provideRequestEvent(u,(async()=>{await async function(s){const o=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,s.response.headers.set("Content-Type","text/html"),Object.assign(s,{manifest:await o.json(),assets:[...await o.inputs[o.handler].assets()],router:{submission:Se$1(s)},routes:Ya.map((function e(s){return{...s,...s.$$route?s.$$route.require().route:void 0,info:{...s.$$route?s.$$route.require().route.info:{},filesystem:!0},component:s.$component&&ve(s.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:s.children?s.children.map(e):void 0}})),complete:!1,$islands:new Set})}(u),tl||(tl=(await import("../build/app-B2XfqFCO.mjs")).default),u.router.dataOnly=a||!0,u.router.previousUrl=s.request.headers.get("referer");try{renderToString((()=>{vo.context.event=u,tl()}))}catch(s){console.log(s)}const c=u.router.data;if(!c)return o;let p=!1;for(const s in c)void 0===c[s]?delete c[s]:p=!0;return p&&(o instanceof Response?o.customBody&&(c._$value=o.customBody()):(c._$value=o,o=new Response(null,{status:200})),o.customBody=()=>c,o.headers.set("X-Single-Flight","true")),o}))}const rl=eventHandler((async function(s){const o=_n(s),a=o.request,c=a.headers.get("X-Server-Id"),u=a.headers.get("X-Server-Instance"),p=a.headers.has("X-Single-Flight"),w=new URL(a.url);let v,$;if(c)(function(s,o){if(!s)throw new Va(o)})("string"==typeof c,"Invalid server function"),[v,$]=c.split("#");else if(v=w.searchParams.get("id"),$=w.searchParams.get("name"),!v||!$)return new Response(null,{status:404});const C=el[v];let q;if(!C)return new Response(null,{status:404});q=await C.importer();const z=q[C.functionName];let j=[];if(!u||"GET"===s.method){const s=w.searchParams.get("args");if(s){const o=JSON.parse(s);(o.t?Lo(o,{plugins:[Hi,Ui,Wi,Xi,to,io,ao,co,po,ho]}):o).forEach((s=>j.push(s)))}}if("POST"===s.method){const o=a.headers.get("content-type"),c=s.node.req,u=c instanceof ReadableStream,p=c.body instanceof ReadableStream,w=u&&c.locked||p&&c.body.locked,v=u?c:c.body;if((null==o?void 0:o.startsWith("multipart/form-data"))||(null==o?void 0:o.startsWith("application/x-www-form-urlencoded")))j.push(await(w?a:new Request(a,{...a,body:v})).formData());else if(null==o?void 0:o.startsWith("application/json")){const s=w?a:new Request(a,{...a,body:v});j=Lo(await s.json(),{plugins:[Hi,Ui,Wi,Xi,to,io,ao,co,po,ho]})}}try{let c=await provideRequestEvent(o,(async()=>(vo.context={event:o},o.locals.serverFunctionMeta={id:v+"#"+$},z(...j))));if(p&&u&&(c=await A(o,c)),c instanceof Response){if(c.headers&&c.headers.has("X-Content-Raw"))return c;u&&(c.headers&&An(s,c.headers),c.status&&(c.status<300||c.status>=400)&&da(s,c.status),c.customBody?c=await c.customBody():null==c.body&&(c=null))}return u?(xa(s,"content-type","text/javascript"),O(u,c)):I(c,a,j)}catch(c){if(c instanceof Response)p&&u&&(c=await A(o,c)),c.headers&&An(s,c.headers),c.status&&(!u||c.status<300||c.status>=400)&&da(s,c.status),c.customBody?c=c.customBody():null==c.body&&(c=null),xa(s,"X-Error","true");else if(u){const o=c instanceof Error?c.message:"string"==typeof c?c:"true";xa(s,"X-Error",o.replace(/[\r\n]+/g,""))}else c=I(c,a,j,!0);return u?(xa(s,"content-type","text/javascript"),O(u,c)):c}}));var sl=Object.defineProperty,__publicField=(s,o,a)=>((s,o,a)=>o in s?sl(s,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[o]=a)(s,o+"",a);function mt$1(s){let o;const a=il(s),c={duplex:"half",method:s.method,headers:s.headers};return s.node.req.body instanceof ArrayBuffer?new Request(a,{...c,body:s.node.req.body}):new Request(a,{...c,get body(){return o||(o=wl(s),o)}})}function wt$1(){return getContext("nitro-app",{asyncContext:!!(null==(s=globalThis.app.config.server.experimental)?void 0:s.asyncContext),AsyncLocalStorage:p}).use().event;var s}const nl=Symbol("$HTTPEvent");function R(s){return function(...o){var a;let c=o[0];if(function(s){return"object"==typeof s&&(s instanceof H3Event||(null==s?void 0:s[nl])instanceof H3Event||!0===(null==s?void 0:s.__is_event__))}(c))o[0]=c instanceof H3Event||c.__is_event__?c:c[nl];else{if(!(null==(a=globalThis.app.config.server.experimental)?void 0:a.asyncContext))throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(c=wt$1(),!c)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");o.unshift(c)}return s(...o)}}const il=R(getRequestURL),ol=R(getRequestIP),al=R(setResponseStatus),ll=R(getResponseStatus),cl=R(getResponseStatusText),ul=R(getResponseHeaders),dl=R(getResponseHeader),hl=R(setResponseHeader),fl=R(appendResponseHeader),pl=R((function(s,o,a=302){return s.node.res.statusCode=sanitizeStatusCode(a,s.node.res.statusCode),s.node.res.setHeader("location",o),function(s,o,a){return function(s,o){304===s.node.res.statusCode||s.node.res.getHeader("content-type")||s.node.res.setHeader("content-type",o)}(s,a),new Promise((a=>{jo((()=>{s.handled||s.node.res.end(o),a()}))}))}(s,`<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=${o.replace(/"/g,"%22")}"></head></html>`,zo)})),ml=R(getCookie),gl=R(setCookie),yl=R(useSession),bl=R(Io),wl=R(getRequestWebStream),vl=R(removeResponseHeader),Sl=R((function(s){return null!=s.web||(s.web={request:mt$1(s),url:il(s)}),s.web.request}));const xl=/^(?:[a-z0-9]+:)?\/\//i,$l=/^\/+|(\/)\/+$/g,_l="http://sr";function D$1(s,o=!1){const a=s.replace($l,"$1");return a?o||/^[?#]/.test(a)?a:"/"+a:""}function N(s,o,a){if(xl.test(o))return;const c=D$1(s),u=a&&D$1(a);let p="";return p=!u||o.startsWith("/")?c:0!==u.toLowerCase().indexOf(c.toLowerCase())?c+u:u,(p||"/")+D$1(o,!p)}function Ft(s,o){return D$1(s).replace(/\/*(\*.*)?$/g,"")+D$1(o)}function Pe(s){const o={};return s.searchParams.forEach(((s,a)=>{a in o?Array.isArray(o[a])?o[a].push(s):o[a]=[o[a],s]:o[a]=s})),o}function Ut(s,o,a){const[c,u]=s.split("/*",2),p=c.split("/").filter(Boolean),w=p.length;return s=>{const c=s.split("/").filter(Boolean),v=c.length-w;if(v<0||v>0&&void 0===u&&!o)return null;const $={path:w?"":"/",params:{}},i=s=>void 0===a?void 0:a[s];for(let s=0;s<w;s++){const o=p[s],a=":"===o[0],u=a?c[s]:c[s].toLowerCase(),w=a?o.slice(1):o.toLowerCase();if(a&&J$1(u,i(w)))$.params[w]=u;else if(a||!J$1(u,w))return null;$.path+=`/${u}`}if(u){const s=v?c.slice(-v).join("/"):"";if(!J$1(s,i(u)))return null;$.params[u]=s}return $}}function J$1(s,o){const n=o=>o===s;return void 0===o||("string"==typeof o?n(o):"function"==typeof o?o(s):Array.isArray(o)?o.some(n):o instanceof RegExp&&o.test(s))}function Dt(s){const[o,a]=s.pattern.split("/*",2),c=o.split("/").filter(Boolean);return c.reduce(((s,o)=>s+(o.startsWith(":")?2:3)),c.length-(void 0===a?0:1))}function Ce(s){const o=new Map,a=getOwner();return new Proxy({},{get:(c,u)=>(o.has(u)||runWithOwner(a,(()=>o.set(u,createMemo((()=>s()[u]))))),o.get(u)()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),ownKeys:()=>Reflect.ownKeys(s())})}function Oe(s){let o=/(\/?\:[^\/]+)\?/.exec(s);if(!o)return[s];let a=s.slice(0,o.index),c=s.slice(o.index+o[0].length);const u=[a,a+=o[1]];for(;o=/^(\/\:[^\/]+)\?/.exec(c);)u.push(a+=o[1]),c=c.slice(o[0].length);return Oe(c).reduce(((s,o)=>[...s,...u.map((s=>s+o))]),[])}const El=createContext(),Rl=createContext(),_e=()=>function(s,o){if(null==s)throw new Error(o);return s}(useContext(El),"<A> and 'use' router primitives can be only used inside a Route.");function kt(s,o=""){const{component:a,preload:c,load:u,children:p,info:w}=s,v=!p||Array.isArray(p)&&!p.length,$={key:s,component:a,preload:c||u,info:w};return Ae(s.path).reduce(((a,c)=>{for(const u of Oe(c)){const p=Ft(o,u);let w=v?p:p.split("/*",1)[0];w=w.split("/").map((s=>s.startsWith(":")||s.startsWith("*")?s:encodeURIComponent(s))).join("/"),a.push({...$,originalPath:c,pattern:w,matcher:Ut(w,!v,s.matchFilters)})}return a}),[])}function Wt(s,o=0){return{routes:s,score:1e4*Dt(s[s.length-1])-o,matcher(o){const a=[];for(let c=s.length-1;c>=0;c--){const u=s[c],p=u.matcher(o);if(!p)return null;a.unshift({...p,route:u})}return a}}}function Ae(s){return Array.isArray(s)?s:[s]}function Mt(s,o="",a=[],c=[]){const u=Ae(s);for(let s=0,p=u.length;s<p;s++){const p=u[s];if(p&&"object"==typeof p){p.hasOwnProperty("path")||(p.path="");const s=kt(p,o);for(const o of s){a.push(o);const s=Array.isArray(p.children)&&0===p.children.length;if(p.children&&!s)Mt(p.children,o.pattern,a,c);else{const s=Wt([...a],c.length);c.push(s)}a.pop()}}}return a.length?c:c.sort(((s,o)=>o.score-s.score))}function Y$1(s,o){for(let a=0,c=s.length;a<c;a++){const c=s[a].matcher(o);if(c)return c}return[]}let Tl;function Kt(){return Tl}let Al=!1;function Hn(s){Al=s}function qn(s,o,a,c={}){const{signal:[u,p],utils:w={}}=s,v=w.parsePath||(s=>s),$=w.renderPath||(s=>s),C=w.beforeLeave||function(){let s=new Set,o=!1;return{subscribe:function(o){return s.add(o),()=>s.delete(o)},confirm:function(a,c){if(o)return!(o=!1);const u={to:a,options:c,defaultPrevented:!1,preventDefault:()=>u.defaultPrevented=!0};for(const p of s)p.listener({...u,from:p.location,retry:s=>{s&&(o=!0),p.navigate(a,{...c,resolve:!1})}});return!u.defaultPrevented}}}(),q=N("",c.base||"");if(void 0===q)throw new Error(`${q} is not a valid base path`);q&&!u().value&&p({value:q,replace:!0,scroll:!1});const[z,j]=createSignal(!1);let L;const[Q,H]=createSignal(u().value),[K,J]=createSignal(u().state),Z=function(s,o,a){const c=new URL(_l),u=createMemo((o=>{const a=s();try{return new URL(a,c)}catch{return console.error(`Invalid path ${a}`),o}}),c),p=createMemo((()=>u().pathname)),w=createMemo((()=>u().search),!0),v=createMemo((()=>u().hash)),$=on$2(w,(()=>Pe(u())));return{get pathname(){return p()},get search(){return w()},get hash(){return v()},get state(){return o()},get key(){return""},query:a?a($):Ce($)}}(Q,K,w.queryWrapper),X=[],te=createSignal(function(){const s=getRequestEvent();return s&&s.router&&s.router.submission?[s.router.submission]:[]}()),oe=createMemo((()=>"function"==typeof c.transformUrl?Y$1(o(),c.transformUrl(Z.pathname)):Y$1(o(),Z.pathname))),ie=()=>{const s=oe(),o={};for(let a=0;a<s.length;a++)Object.assign(o,s[a].params);return o},ae=w.paramsWrapper?w.paramsWrapper(ie,o):Ce(ie),le={pattern:q,path:()=>q,outlet:()=>null,resolvePath:s=>N(q,s)};return createRenderEffect(on$2(u,(s=>((s,o)=>{o.value===Q()&&o.state===K()||(void 0===L&&j(!0),Tl=s,L=o,startTransition((()=>{L===o&&(H(L.value),J(L.state))})).finally((()=>{L===o&&batch((()=>{Tl=void 0,j(!1),L=void 0}))})))})("native",s)),{defer:!0})),{base:le,location:Z,params:ae,isRouting:z,renderPath:$,parsePath:v,navigatorFactory:function(s){return s=s||useContext(Rl)||le,(o,a)=>function(s,o,a){wo((()=>{if("number"==typeof o)return void(o&&(w.go?w.go(o):console.warn("Router integration does not support relative routing")));const c=!o||"?"===o[0],{replace:u,resolve:v,scroll:$,state:C}={replace:!1,resolve:!c,scroll:!0,...a},q=v?s.resolvePath(o):N(c&&Z.pathname||"",o);if(void 0===q)throw new Error(`Path '${o}' is not a routable path`);if(X.length>=100)throw new Error("Too many redirects");if(q!==Q()||C!==K()){const s=getRequestEvent();s&&(s.response={status:302,headers:new Headers({Location:q})}),p({value:q,replace:u,scroll:$,state:C})}}))}(s,o,a)},matches:oe,beforeLeave:C,preloadRoute:function(s,c){const u=Y$1(o(),s.pathname),p=Tl;Tl="preload";for(let o in u){const{route:p,params:w}=u[o];p.component&&p.component.preload&&p.component.preload();const{preload:v}=p;Al=!0,c&&v&&runWithOwner(a(),(()=>v({params:w,location:{pathname:s.pathname,search:s.search,hash:s.hash,query:Pe(s),state:null,key:""},intent:"preload"}))),Al=!1}Tl=p},singleFlight:void 0===c.singleFlight||c.singleFlight,submissions:te}}function $n(s,o,a,c){const{base:u,location:p,params:w}=s,{pattern:v,component:$,preload:C}=c().route,q=createMemo((()=>c().path));$&&$.preload&&$.preload(),Al=!0;const z=C?C({params:w,location:p,intent:Tl||"initial"}):void 0;return Al=!1,{parent:o,pattern:v,path:q,outlet:()=>$?createComponent($,{params:w,location:p,data:z,get children(){return a()}}):a(),resolvePath:s=>N(u.path(),s,q())}}let Cl=new Map;function B$1(){const s=getRequestEvent();if(!s)throw new Error("Cannot find cache context");return(s.router||(s.router={})).cache||(s.router.cache=new Map)}function He(s,o){s&&!Array.isArray(s)&&(s=[s]);for(let a of Cl.keys())(void 0===s||qe$1(a,s))&&o(Cl.get(a))}function F(s,o){s.GET&&(s=s.GET);const n=(...a)=>{const c=B$1(),u=Kt(),p=Al,w=getOwner()?_e().navigatorFactory():void 0,v=Date.now(),$=o+ee(a);let C,q=c.get($);{const s=getRequestEvent();if(s){const o=(s.router||(s.router={})).dataOnly;if(o){const a=s&&(s.router.data||(s.router.data={}));if(a&&$ in a)return a[$];if(Array.isArray(o)&&!qe$1($,o))return a[$]=void 0,Promise.resolve()}}}if(q&&q[0]){"preload"===q[3]&&"preload"!==u&&(q[0]=v);let s=q[1];return"preload"!==u&&(s="then"in q[1]?q[1].then(y(!1),y(!0)):y(!1)(q[1])),p&&"then"in s&&s.catch((()=>{})),s}C=s(...a),q?(q[0]=v,q[1]=C,q[3]=u):(c.set($,q=[v,C,,u,createSignal(v)]),q[4].count=0);{const s=getRequestEvent();if(s&&s.router.dataOnly)return s.router.data[$]=C}if("preload"!==u&&(C="then"in C?C.then(y(!1),y(!0)):y(!1)(C)),p&&"then"in C&&C.catch((()=>{})),vo.context&&vo.context.async&&!vo.context.noHydrate){const s=getRequestEvent();(!s||!s.serverOnly)&&vo.context.serialize($,C)}return C;function y(s){return async o=>{if(o instanceof Response){const s=o.headers.get("Location");if(null!==s){if(w&&s.startsWith("/"))startTransition((()=>{w(s,{replace:!0})}));else{const o=getRequestEvent();o&&(o.response={status:302,headers:new Headers({Location:s})})}return}o.customBody&&(o=await o.customBody())}if(s)throw o;return q[2]=o,o}}};return n.keyFor=(...s)=>o+ee(s),n.key=o,n}function qe$1(s,o){for(let a of o)if(a&&s.startsWith(a))return!0;return!1}function ee(s){return JSON.stringify(s,((s,o)=>function(s){let o;return null!=s&&"object"==typeof s&&(!(o=Object.getPrototypeOf(s))||o===Object.prototype)}(o)?Object.keys(o).sort().reduce(((s,a)=>(s[a]=o[a],s)),{}):o))}function Tn(s,o){const a=function(s){const o=_e(),a=createMemo((()=>o.submissions[0]().filter((o=>o.url===s.base&&!0))));return new Proxy([],{get:(s,o)=>o===mo?a():"pending"===o?a().some((s=>!s.result)):a()[o],has:(s,o)=>o in a()})}(s);return new Proxy({},{get(s,o){var c;return 0===a.length&&"clear"===o||"retry"===o?()=>{}:null==(c=a[a.length-1])?void 0:c[o]}})}function $e(s,o={}){function n(...o){const u=this.r,p=this.f,w=(u.singleFlight&&s.withOptions?s.withOptions({headers:{"X-Single-Flight":"true"}}):s)(...o),[v,$]=createSignal();let C;function g(s){return async o=>{var c;const w=await async function(s,o,a){let c,u,p,w;if(s instanceof Response){if(s.headers.has("X-Revalidate")&&(p=s.headers.get("X-Revalidate").split(",")),s.customBody&&(c=u=await s.customBody(),s.headers.has("X-Single-Flight")&&(c=c._$value,delete u._$value,w=Object.keys(u))),s.headers.has("Location")){const o=s.headers.get("Location")||"/";o.startsWith("http")?window.location.href=o:a(o)}}else{if(o)return{error:s};c=s}return He(p,(s=>s[0]=0)),w&&w.forEach((s=>F.set(s,u[s]))),await function(s,o=!0){return startTransition((()=>{const a=Date.now();He(s,(s=>{o&&(s[0]=0),s[4][1](a)}))}))}(p,!1),null!=c?{data:c}:void 0}(o,s,u.navigatorFactory());let v=null;if(null==(c=a.onComplete)||c.call(a,{...C,result:null==w?void 0:w.data,error:null==w?void 0:w.error,pending:!1,retry:()=>v=C.retry()}),v)return v;if(!w)return C.clear();if($(w),w.error&&!p)throw w.error;return w.data}}return u.submissions[1]((a=>[...a,C={input:o,url:c,get result(){var s;return null==(s=v())?void 0:s.data},get error(){var s;return null==(s=v())?void 0:s.error},get pending(){return!v()},clear(){u.submissions[1]((s=>s.filter((s=>s!==C))))},retry:()=>($(void 0),s(...o).then(g(),g(!0)))}])),w.then(g(),g(!0))}const a="string"==typeof o?{name:o}:o,c=s.url||a.name&&`https://action/${a.name}`||"";return n.base=c,Te(n,c)}function Te(s,o){return s.toString=()=>{if(!o)throw new Error("Client Actions need explicit names if server rendered");return o},s.with=function(...a){const r=function(...o){return s.call(this,...a,...o)};r.base=s.base;const c=new URL(o,_l);return c.searchParams.set("args",ee(a)),Te(r,("https://action"===c.origin?c.origin:"")+c.pathname+c.search)},s.url=o,s}function G(s,o=302){let a,c;"number"==typeof o?a={status:o}:(({revalidate:c,...a}=o),typeof a.status>"u"&&(a.status=302));const u=new Headers(a.headers);return u.set("Location",s),void 0!==c&&u.set("X-Revalidate",c.toString()),new Response(null,{...a,headers:u})}F.get=s=>B$1().get(s)[2],F.set=(s,o)=>{const a=B$1(),c=Date.now();let u=a.get(s);u?(u[0]=c,u[1]=Promise.resolve(o),u[2]=o,u[3]="preload"):(a.set(s,u=[c,Promise.resolve(o),o,"preload",createSignal(c)]),u[4].count=0)},F.delete=s=>B$1().delete(s),F.clear=()=>B$1().clear();const kl="solidFetchEvent";function Fn(s){if(!s.context[kl]){const o=function(s){return{request:Sl(s),response:sn(s),clientAddress:ol(s),locals:{},nativeEvent:s}}(s);s.context[kl]=o}return s.context[kl]}class rn{constructor(s){__publicField(this,"event"),this.event=s}get(s){const o=dl(this.event,s);return Array.isArray(o)?o.join(", "):o||null}has(s){return void 0!==this.get(s)}set(s,o){return hl(this.event,s,o)}delete(s){return vl(this.event,s)}append(s,o){fl(this.event,s,o)}getSetCookie(){const s=dl(this.event,"Set-Cookie");return Array.isArray(s)?s:[s]}forEach(s){return Object.entries(ul(this.event)).forEach((([o,a])=>s(Array.isArray(a)?a.join(", "):a,o,this)))}entries(){return Object.entries(ul(this.event)).map((([s,o])=>[s,Array.isArray(o)?o.join(", "):o]))[Symbol.iterator]()}keys(){return Object.keys(ul(this.event))[Symbol.iterator]()}values(){return Object.values(ul(this.event)).map((s=>Array.isArray(s)?s.join(", "):s))[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function sn(s){return{get status(){return ll(s)},set status(o){al(s,o)},get statusText(){return cl(s)},set statusText(o){al(s,ll(s),o)},headers:new rn(s)}}function re(s,o,a){if("function"!=typeof s)throw new Error("Export from a 'use server' module must be a function");return new Proxy(s,{get:(s,c,u)=>"url"===c?`/_server?id=${encodeURIComponent(o)}&name=${encodeURIComponent(a)}`:"GET"===c?u:s[c],apply(c,u,p){const w=getRequestEvent();if(!w)throw new Error("Cannot call server function outside of a request");const v=function(s){return{...s}}(w);return v.locals.serverFunctionMeta={id:o+"#"+a},v.serverOnly=!0,provideRequestEvent(v,(()=>s.apply(u,p)))}})}function K$1(){var s,o,a,c,u,p,w;const v=getRequestEvent();if(!v)throw new Error("getDb must be called in a request context");let $;try{const C=v.nativeEvent.context.cloudflare;if(console.log("Request event structure:",{hasEnv:!!C.env,hasPlatform:!!C.platform,hasContext:!!C.context,envKeys:C.env?Object.keys(C.env):[],platformEnvKeys:(null==(s=C.platform)?void 0:s.env)?Object.keys(C.platform.env):[],contextEnvKeys:(null==(o=C.context)?void 0:o.env)?Object.keys(C.context.env):[]}),null==(a=C.env)?void 0:a.DB)console.log("Found DB in event.nativeEvent.env"),$=C.env.DB;else if(null==(u=null==(c=C.platform)?void 0:c.env)?void 0:u.DB)console.log("Found DB in event.nativeEvent.platform.env"),$=C.platform.env.DB;else{if(!(null==(w=null==(p=C.context)?void 0:p.env)?void 0:w.DB))throw console.error("D1 database binding not found in any expected location"),new Error("D1 database binding not found in environment");console.log("Found DB in event.nativeEvent.context.env"),$=C.context.env.DB}}catch(s){throw console.error("Error accessing DB binding:",s),new Error("Failed to access D1 database binding")}return drizzle($)}const X_select=()=>K$1().select(),X_insert=s=>K$1().insert(s),ql=sqliteTable("users",{id:integer("id").primaryKey().unique().notNull(),username:text("username").notNull().default(""),password:text("password").notNull().default("")});function se(){var s;return yl({password:null!=(s=z.env.SESSION_SECRET)?s:"areallylongsecretthatyoushouldreplace"})}const zl=re((async function(s){const o=String(s.get("username")),a=String(s.get("password")),c=String(s.get("loginType"));let u=function(s){if("string"!=typeof s||s.length<3)return"Usernames must be at least 3 characters long"}(o)||function(s){if("string"!=typeof s||s.length<6)return"Passwords must be at least 6 characters long"}(a);if(u)return new Error(u);try{const s=await("login"!==c?async function(s,o){if(await X_select().from(ql).where(eq(ql.username,s)).get())throw new Error("User already exists");return X_insert(ql).values({username:s,password:o}).returning().get()}(o,a):async function(s,o){const a=await X_select().from(ql).where(eq(ql.username,s)).get();if(!a||o!==a.password)throw new Error("Invalid login");return a}(o,a));await(await se()).update((o=>{o.userId=s.id}))}catch(s){return s}throw G("/")}),"src_api_server_ts--loginOrRegister_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Pl=zl,jl=re((async function(){throw await(await se()).update((s=>s.userId=void 0)),G("/login")}),"src_api_server_ts--logout_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Il=re((async function(){const s=(await se()).data.userId;if(void 0===s)throw G("/login");try{const o=await X_select().from(ql).where(eq(ql.id,s)).get();if(!o)throw G("/login");return{id:o.id,username:o.username}}catch{throw jl()}}),"src_api_server_ts--getUser_1","/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/api/server.ts?tsr-directive-use-server="),Ol=F(Il,"user"),Ll=$e(Pl,"loginOrRegister"),Nl=$e(jl,"logout"),W=s=>o=>{const{base:a}=o,c=children((()=>o.children)),u=createMemo((()=>Mt(c(),o.base||"")));let p;const w=qn(s,u,(()=>p),{base:a,singleFlight:o.singleFlight,transformUrl:o.transformUrl});return s.create&&s.create(w),createComponent(El.Provider,{value:w,get children(){return createComponent(Fe,{routerState:w,get root(){return o.root},get preload(){return o.rootPreload||o.rootLoad},get children(){return[(p=getOwner())&&null,createComponent(qe,{routerState:w,get branches(){return u()}})]}})}})};function Fe(s){const o=s.routerState.location,a=s.routerState.params,c=createMemo((()=>s.preload&&wo((()=>{Hn(!0),s.preload({params:a,location:o,intent:Kt()||"initial"}),Hn(!1)}))));return createComponent(Show,{get when(){return s.root},keyed:!0,get fallback(){return s.children},children:u=>createComponent(u,{params:a,location:o,get data(){return c()},get children(){return s.children}})})}function qe(s){{const o=getRequestEvent();if(o&&o.router&&o.router.dataOnly)return void function(s,o,a){const c=new URL(s.request.url),u=Y$1(a,new URL(s.router.previousUrl||s.request.url).pathname),p=Y$1(a,c.pathname);for(let a=0;a<p.length;a++){(!u[a]||p[a].route!==u[a].route)&&(s.router.dataOnly=!0);const{route:c,params:w}=p[a];c.preload&&c.preload({params:w,location:o.location,intent:"preload"})}}(o,s.routerState,s.branches);o&&((o.router||(o.router={})).matches||(o.router.matches=s.routerState.matches().map((({route:s,path:o,params:a})=>({path:s.originalPath,pattern:s.pattern,match:o,params:a,info:s.info})))))}const o=[];let a;const c=createMemo(on$2(s.routerState.matches,((u,p,w)=>{let v=p&&u.length===p.length;const $=[];for(let a=0,C=u.length;a<C;a++){const C=p&&p[a],q=u[a];w&&C&&q.route.key===C.route.key?$[a]=w[a]:(v=!1,o[a]&&o[a](),createRoot((u=>{o[a]=u,$[a]=$n(s.routerState,$[a-1]||s.routerState.base,D((()=>c()[a+1])),(()=>s.routerState.matches()[a]))})))}return o.splice(u.length).forEach((s=>s())),w&&v?w:(a=$[0],$)})));return D((()=>c()&&a))()}const D=s=>()=>createComponent(Show,{get when(){return s()},keyed:!0,children:s=>createComponent(Rl.Provider,{value:s,get children(){return s.outlet()}})});function je(s){const o=new URL(s);return o.pathname+o.search}function We(s){return function(s){let o;const a={value:s.url||(o=getRequestEvent())&&je(o.request.url)||""};return W({signal:[()=>a,s=>Object.assign(a,s)]})(s)}(s)}const Ql={preload(){Ol()}},Bl=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("../build/_...404_2.mjs"),import:()=>import("../build/_...404_2.mjs")},path:"/*404",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../build/index2.mjs"),import:()=>import("../build/index2.mjs")},$$route:{require:()=>({route:Ql}),src:"src/routes/index.tsx?pick=route"},path:"/",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/index.tsx"},{page:!0,$component:{src:"src/routes/login.tsx?pick=default&pick=$css",build:()=>import("../build/login2.mjs"),import:()=>import("../build/login2.mjs")},path:"/login",filePath:"/Users/Home/Developer/GitHub/solid-start/examples/with-drizzle/src/routes/login.tsx"}],Dl=function(s){function r(s,o,a,c){const u=Object.values(s).find((s=>a.startsWith(s.id+"/")));return u?(r(u.children||(u.children=[]),o,a.slice(u.id.length)),s):(s.push({...o,id:a,path:a.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/")}),s)}return s.sort(((s,o)=>s.path.length-o.path.length)).reduce(((s,o)=>r(s,o,o.path,o.path)),[])}(Bl.filter((s=>s.page)));const Ml=createRouter$1({routes:Bl.reduce(((s,o)=>{if(!function(s){return s.$HEAD||s.$GET||s.$POST||s.$PUT||s.$PATCH||s.$DELETE}(o))return s;let a=o.path.replace(/\([^)/]+\)/g,"").replace(/\/+/g,"/").replace(/\*([^/]*)/g,((s,o)=>`**:${o}`)).split("/").map((s=>s.startsWith(":")||s.startsWith("*")?s:encodeURIComponent(s))).join("/");if(/:[^/]*\?/g.test(a))throw new Error(`Optional parameters are not supported in API routes: ${a}`);if(s[a])throw new Error(`Duplicate API routes for "${a}" found at "${s[a].route.path}" and "${o.path}"`);return s[a]={route:o},s}),{})});const Hl={style:s=>ssrElement("style",s.attrs,(()=>s.children)),link:s=>ssrElement("link",s.attrs,void 0),script:s=>s.attrs.src?ssrElement("script",mergeProps((()=>s.attrs),{get id(){return s.key}}),(()=>ssr(" "))):null,noscript:s=>ssrElement("noscript",s.attrs,(()=>escape(s.children)))};function P(s,o){let{tag:a,attrs:{key:c,...u}={key:void 0},children:p}=s;return Hl[a]({attrs:{...u,nonce:o},key:c,children:p})}function rt(s,o,a,c="default"){return lazy((async()=>{var a;{const u=(await s.import())[c],p=(await(null==(a=o.inputs)?void 0:a[s.src].assets())).filter((s=>"style"===s.tag||"stylesheet"===s.attrs.rel));return{default:s=>[...p.map((s=>P(s))),createComponent(u,s)]}}}))}const nt=()=>getRequestEvent().routes;function ot(s){const o=ml(s.nativeEvent,"flash");if(o)try{let s=JSON.parse(o);if(!s||!s.result)return;const a=[...s.input.slice(0,-1),new Map(s.input[s.input.length-1])],c=s.error?new Error(s.result):s.result;return{input:a,url:s.url,pending:!1,result:s.thrown?void 0:c,error:s.thrown?c:void 0}}catch(s){console.error(s)}finally{gl(s.nativeEvent,"flash","",{maxAge:0})}}async function st(s){const o=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,s.response.headers.set("Content-Type","text/html"),Object.assign(s,{manifest:await o.json(),assets:[...await o.inputs[o.handler].assets()],router:{submission:ot(s)},routes:Dl.map((function e(s){return{...s,...s.$$route?s.$$route.require().route:void 0,info:{...s.$$route?s.$$route.require().route.info:{},filesystem:!0},component:s.$component&&rt(s.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:s.children?s.children.map(e):void 0}})),complete:!1,$islands:new Set})}const Fl=new Set([301,302,303,307,308]);function x(s){return s.status&&Fl.has(s.status)?s.status:302}function it(s,o,a={},c){return eventHandler({handler:c=>{const u=Fn(c);return provideRequestEvent(u,(async()=>{const p=function(s,o){const a=Ml.lookup(s);if(a&&a.route){const s="HEAD"===o?a.route.$HEAD||a.route.$GET:a.route[`$${o}`];return void 0===s?void 0:{handler:s,params:a.params}}}(new URL(u.request.url).pathname,u.request.method);if(p){const s=await p.handler.import(),o="HEAD"===u.request.method?s.HEAD||s.GET:s[u.request.method];u.params=p.params||{},vo.context={event:u};const a=await o(u);if(void 0!==a)return a;if("GET"!==u.request.method)throw new Error(`API handler for ${u.request.method} "${u.request.url}" did not return a response.`)}const w=await o(u),v="function"==typeof a?await a(w):{...a},$=v.mode||"stream";if(v.nonce&&(w.nonce=v.nonce),"sync"===$){const o=renderToString((()=>(vo.context.event=w,s(w))),v);if(w.complete=!0,w.response&&w.response.headers.get("Location")){const s=x(w.response);return pl(c,w.response.headers.get("Location"),s)}return o}if(v.onCompleteAll){const s=v.onCompleteAll;v.onCompleteAll=o=>{B(w)(o),s(o)}}else v.onCompleteAll=B(w);if(v.onCompleteShell){const s=v.onCompleteShell;v.onCompleteShell=o=>{_(w,c)(),s(o)}}else v.onCompleteShell=_(w,c);const C=function(s,o={}){let a,{nonce:c,onCompleteShell:u,onCompleteAll:p,renderId:w,noScripts:v}=o;const $=[],pushTask=s=>{v||(Q||H||(Q=getLocalHeaderScript(w)),Q+=s+";",!X&&H&&(X=setTimeout(writeTasks)))},C=createSerializer({scopeId:o.renderId,onData:pushTask,onDone:()=>{writeTasks(),doShell(),p&&p({write(s){!K&&te.write(s)}}),j&&j.end(),K=!0,H&&a()},onError:o.onError}),flushEnd=()=>{q.size||queue((()=>queue((()=>C.flush()))))},q=new Map,writeTasks=()=>{Q.length&&!K&&H&&(te.write(`<script${c?` nonce="${c}"`:""}>${Q}<\/script>`),Q=""),X&&clearTimeout(X),X=null};let z,j,L="",Q="",H=!1,K=!1,J=!1,Z=!1,X=null,te={write(s){L+=s}};vo.context=z={id:w||"",count:0,async:!0,resources:{},lazy:{},suspense:{},assets:[],nonce:c,block(s){H||$.push(s)},replace(s,o){if(H)return;const a=`\x3c!--!$${s}--\x3e`,c=oe.indexOf(a);if(-1===c)return;const u=oe.indexOf(`\x3c!--!$/${s}--\x3e`,c+a.length);oe=oe.slice(0,c)+resolveSSRNode(escape(o()))+oe.slice(u+a.length+1)},serialize(s,o,a){const c=vo.context.noHydrate;!H&&a&&"object"==typeof o&&"then"in o?($.push(o),!c&&o.then((o=>{C.write(s,o)})).catch((o=>{C.write(s,o)}))):c||C.write(s,o)},roots:0,nextRoot(){return this.renderId+"i-"+this.roots++},registerFragment(s){if(!q.has(s)){let o,a;const c=new Promise(((s,c)=>(o=s,a=c)));q.set(s,(s=>queue((()=>queue((()=>{s?a(s):o(!0),queue(flushEnd)})))))),C.write(s,c)}return(o,a)=>{if(q.has(s)){const c=q.get(s);if(q.delete(s),function(s,o){for(const a of[...s.keys()].reverse())if(o.startsWith(a))return!0;return!1}(q,s))return void c();K||(H?(te.write(`<template id="${s}">${void 0!==o?o:" "}</template>`),pushTask(`$df("${s}")${Z?"":';function $df(e,n,o,t){if(n=document.getElementById(e),o=document.getElementById("pl-"+e)){for(;o&&8!==o.nodeType&&o.nodeValue!=="pl-"+e;)t=o.nextSibling,o.remove(),o=t;_$HY.done?o.remove():o.replaceWith(n.content)}n.remove(),_$HY.fe(e)}'}`),c(a),Z=!0):(queue((()=>oe=function(s,o,a){const c=`<template id="pl-${o}">`,u=`\x3c!--pl-${o}--\x3e`,p=s.indexOf(c);if(-1===p)return s;const w=s.indexOf(u,p+c.length);return s.slice(0,p)+a+s.slice(w+u.length)}(oe,s,void 0!==o?o:""))),c(a)))}return H}}};let oe=createRoot((o=>(a=o,resolveSSRNode(escape(s())))));function doShell(){J||(vo.context=z,z.noHydrate=!0,oe=injectAssets(z.assets,oe),Q.length&&(oe=injectScripts(oe,Q,c)),te.write(oe),Q="",u&&u({write(s){!K&&te.write(s)}}),J=!0)}return{then(s){function complete(){a(),s(L)}if(p){let s=p;p=o=>{s(o),complete()}}else p=complete;queue(flushEnd)},pipe(s){allSettled($).then((()=>{setTimeout((()=>{doShell(),te=j=s,te.write(L),H=!0,K?(a(),j.end()):flushEnd()}))}))},pipeTo:s=>allSettled($).then((()=>{let o;const c=new Promise((s=>o=s));return setTimeout((()=>{doShell();const c=new TextEncoder,u=s.getWriter();j={end(){u.releaseLock(),s.close(),o()}},te={write(s){u.write(c.encode(s))}},te.write(L),H=!0,K?(a(),j.end()):flushEnd()})),c}))}}((()=>(vo.context.event=w,s(w))),v);if(w.response&&w.response.headers.get("Location")){const s=x(w.response);return pl(c,w.response.headers.get("Location"),s)}if("async"===$)return C;const{writable:q,readable:z}=new TransformStream;return C.pipeTo(q),z}))}})}function _(s,o){return()=>{if(s.response&&s.response.headers.get("Location")){const a=x(s.response);al(o,a),bl(o,"Location",s.response.headers.get("Location"))}}}function B(s){return({write:o})=>{s.complete=!0;const a=s.response&&s.response.headers.get("Location");a&&o(`<script>window.location="${a}"<\/script>`)}}var Ul=["<a",' href="/">Index</a>'],Kl=["<a",' href="/about">About</a>'];function dt(){return createComponent(We,{root:s=>[ssr(Ul,ssrHydrationKey()),ssr(Kl,ssrHydrationKey()),createComponent(Suspense,{get children(){return s.children}})],get children(){return createComponent(nt,{})}})}const V=s=>{const o=getRequestEvent();return o.response.status=s.code,o.response.statusText=s.text,function(s){bo&&(bo.cleanups?bo.cleanups.push(s):bo.cleanups=[s])}((()=>!o.nativeEvent.handled&&!o.complete&&(o.response.status=200))),null};var Wl=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">',"</span>"],Vl=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">500 | Internal Server Error</span>'];const mt=s=>createComponent(ErrorBoundary,{fallback:s=>(console.error(s),[ssr(Wl,ssrHydrationKey(),escape("500 | Internal Server Error")),createComponent(V,{code:500})]),get children(){return s.children}}),ft=s=>{let o=!1;const a=catchError((()=>s.children),(s=>{console.error(s),o=!!s}));return o?[ssr(Vl,ssrHydrationKey()),createComponent(V,{code:500})]:a};var Jl=["<script",">","<\/script>"],Gl=["<script",' type="module"'," async","><\/script>"],Yl=["<script",' type="module" async',"><\/script>"];const Zl=ssr("<!DOCTYPE html>");function Y(s,o,a=[]){for(let c=0;c<o.length;c++){const u=o[c];if(u.path!==s[0].path)continue;let p=[...a,u];if(u.children){const o=s.slice(1);if(0===o.length||(p=Y(o,u.children,p),!p))continue}return p}}function yt(s){const o=getRequestEvent(),a=o.nonce;let c=[];return Promise.resolve().then((async()=>{let s=[];if(o.router&&o.router.matches){const a=[...o.router.matches];for(;a.length&&(!a[0].info||!a[0].info.filesystem);)a.shift();const c=a.length&&Y(a,o.routes);if(c){const o=globalThis.MANIFEST.client.inputs;for(let a=0;a<c.length;a++){const u=o[c[a].$component.src];s.push(u.assets())}}}c=await Promise.all(s).then((s=>[...new Map(s.flat().map((s=>[s.attrs.key,s]))).values()].filter((s=>"modulepreload"===s.attrs.rel&&!o.assets.find((o=>o.attrs.key===s.attrs.key))))))})),function(s){vo.context.assets.push((()=>resolveSSRNode(escape(s()))))}((()=>c.length?c.map((s=>P(s))):void 0)),createComponent(NoHydration,{get children(){return[Zl,createComponent(ft,{get children(){return createComponent(s.document,{get assets(){return[createComponent(HydrationScript,{}),o.assets.map((s=>P(s,a)))]},get scripts(){return a?[ssr(Jl,ssrHydrationKey()+ssrAttribute("nonce",escape(a,!0),!1),`window.manifest = ${JSON.stringify(o.manifest)}`),ssr(Gl,ssrHydrationKey(),ssrAttribute("nonce",escape(a,!0),!1),ssrAttribute("src",escape(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]:[ssr(Jl,ssrHydrationKey(),`window.manifest = ${JSON.stringify(o.manifest)}`),ssr(Yl,ssrHydrationKey(),ssrAttribute("src",escape(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return createComponent(Hydration,{get children(){return createComponent(mt,{get children(){return createComponent(dt,{})}})}})}})}})]}})}var Xl=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],ec=["<html",' lang="en">','<body><div id="app">',"</div>\x3c!--$--\x3e","\x3c!--/--\x3e</body></html>"];const tc=function(s,o){return it(s,st,o)}((()=>createComponent(yt,{document:({assets:s,children:o,scripts:a})=>ssr(ec,ssrHydrationKey(),createComponent(NoHydration,{get children(){return ssr(Xl,escape(s))}}),escape(o),escape(a))}))),rc=[{route:"/_server",handler:rl,lazy:!1,middleware:!0,method:void 0},{route:"/",handler:tc,lazy:!1,middleware:!0,method:void 0}];const sc=function(){const s=useRuntimeConfig(),o=new Hookable,captureError=(s,a={})=>{const c=o.callHookParallel("error",s,a).catch((s=>{console.error("Error while capturing another error",s)}));if(a.event&&isEvent$1(a.event)){const o=a.event.context.nitro?.errors;o&&o.push({error:s,context:a}),a.event.waitUntil&&a.event.waitUntil(c)}},a=createApp({debug:destr(!1),onError:(s,o)=>(captureError(s,{event:o,tags:["request"]}),async function(s,o){for(const a of Sn)try{if(await a(s,o,{defaultHandler:defaultHandler}),o.handled)return}catch(s){console.error(s)}}(s,o)),onRequest:async s=>{s.context.nitro=s.context.nitro||{errors:[]};const o=s.node.req?.__unenv__;o?._platform&&(s.context={_platform:o?._platform,...o._platform,...s.context}),!s.context.waitUntil&&o?.waitUntil&&(s.context.waitUntil=o.waitUntil),s.fetch=(o,a)=>fetchWithEvent(s,o,a,{fetch:localFetch}),s.$fetch=(o,a)=>fetchWithEvent(s,o,a,{fetch:p}),s.waitUntil=o=>{s.context.nitro._waitUntilPromises||(s.context.nitro._waitUntilPromises=[]),s.context.nitro._waitUntilPromises.push(o),s.context.waitUntil&&s.context.waitUntil(o)},s.captureError=(o,a)=>{captureError(o,{event:s,...a})},await sc.hooks.callHook("request",s).catch((o=>{captureError(o,{event:s,tags:["request"]})}))},onBeforeResponse:async(s,o)=>{await sc.hooks.callHook("beforeResponse",s,o).catch((o=>{captureError(o,{event:s,tags:["request","response"]})}))},onAfterResponse:async(s,o)=>{await sc.hooks.callHook("afterResponse",s,o).catch((o=>{captureError(o,{event:s,tags:["request","response"]})}))}}),c=function(s={}){const o=createRouter$1({}),a={};let c;const u={},addRoute=(s,c,p)=>{let w=a[s];if(w||(a[s]=w={path:s,handlers:{}},o.insert(s,w)),Array.isArray(p))for(const o of p)addRoute(s,c,o);else w.handlers[p]=toEventHandler(c,0,s);return u};u.use=u.add=(s,o,a)=>addRoute(s,o,a||"all");for(const s of js)u[s]=(o,a)=>u.add(o,a,s);const matchHandler=(s="/",a="get")=>{const u=s.indexOf("?");-1!==u&&(s=s.slice(0,Math.max(0,u)));const p=o.lookup(s);if(!p||!p.handlers)return{error:createError$1({statusCode:404,name:"Not Found",statusMessage:`Cannot find any route matching ${s||"/"}.`})};let w=p.handlers[a]||p.handlers.all;if(!w){c||(c=toRouteMatcher(o));const u=c.matchAll(s).reverse();for(const s of u){if(s.handlers[a]){w=s.handlers[a],p.handlers[a]=p.handlers[a]||w;break}if(s.handlers.all){w=s.handlers.all,p.handlers.all=p.handlers.all||w;break}}}return w?{matched:p,handler:w}:{error:createError$1({statusCode:405,name:"Method Not Allowed",statusMessage:`Method ${a} is not allowed on this route.`})}},p=s.preemptive||s.preemtive;return u.handler=Ps((s=>{const o=matchHandler(s.path,s.method.toLowerCase());if("error"in o){if(p)throw o.error;return}s.context.matchedRoute=o.matched;const a=o.matched.params||{};return s.context.params=a,Promise.resolve(o.handler(s)).then((s=>void 0===s&&p?null:s))})),u.handler.__resolve__=async s=>{s=function(s=""){return function(s=""){return s.startsWith("/")}(s)?s:"/"+s}(s);const o=matchHandler(s);if("error"in o)return;let a={route:o.matched.path,handler:o.handler};if(o.handler.__resolve__){const c=await o.handler.__resolve__(s);if(!c)return;a={...a,...c}}return a},u}({preemptive:!0}),u=toNodeListener(a),localFetch=(s,o)=>s.toString().startsWith("/")?async function(s,o,a={}){try{const c=await b(s,{url:o,...a});return new Response(c.body,{status:c.status,statusText:c.statusText,headers:S$2(c.headers)})}catch(s){return new Response(s.toString(),{status:Number.parseInt(s.statusCode||s.code)||500,statusText:s.statusText})}}(u,s,o).then((s=>function(s){return s.headers.has("set-cookie")?new Response(s.body,{status:s.status,statusText:s.statusText,headers:normalizeCookieHeaders(s.headers)}):s}(s))):globalThis.fetch(s,o),p=createFetch({fetch:localFetch,Headers:Us,defaults:{baseURL:s.app.baseURL}});globalThis.$fetch=p,a.use(createRouteRulesHandler({localFetch:localFetch}));for(const o of rc){let u=o.lazy?lazyEventHandler(o.handler):o.handler;if(o.middleware||!o.route){const c=(s.app.baseURL+(o.route||"/")).replace(/\/+/g,"/");a.use(c,u)}else{const s=getRouteRulesForPath(o.route.replace(/:\w+|\*\*/g,"_"));s.cache&&(u=cachedEventHandler(u,{group:"nitro/routes",...s.cache})),c.use(o.route,u,o.method)}}a.use(s.app.baseURL,c.handler);{const s=a.handler;a.handler=o=>{const a={event:o};return bn.callAsync(a,(()=>s(o)))}}return{hooks:o,h3App:a,router:c,localCall:s=>b(u,s),localFetch:localFetch,captureError:captureError}}();function useNitroApp(){return sc}!function(s){for(const o of Ln)try{o(s)}catch(o){throw s.captureError(o,{tags:["plugin"]}),o}}(sc);const nc={"/favicon.ico":{type:"image/vnd.microsoft.icon",etag:'"298-hdW7/pL89QptiszdYCHH67XxLxs"',mtime:"2025-05-20T20:26:05.893Z",size:664,path:"../favicon.ico"},"/assets/index-B64JFNGz.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"1ca3-j1yUOnnfrJvX8fDDHo4UkFbajlQ"',mtime:"2025-05-20T20:26:05.932Z",size:7331,path:"../assets/index-B64JFNGz.js.br"},"/assets/index-B64JFNGz.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"1f9c-9C6jeC0b1EbVXXqZpOxvZPVw1PQ"',mtime:"2025-05-20T20:26:05.932Z",size:8092,path:"../assets/index-B64JFNGz.js.gz"},"/assets/ssr-rN2XJZw8.css":{type:"text/css; charset=utf-8",etag:'"17f-EyPT40t0Q2Ip557OUJ0k5vttT/g"',mtime:"2025-05-20T20:26:05.894Z",size:383,path:"../assets/ssr-rN2XJZw8.css"},"/_build/.vite/manifest.json":{type:"application/json",etag:'"644-hNDyedgf8RI2oILxqJH3wt7veRw"',mtime:"2025-05-20T20:26:05.896Z",size:1604,path:"../_build/.vite/manifest.json"},"/_build/.vite/manifest.json.br":{type:"application/json",encoding:"br",etag:'"14a-ztPlOiCZ3D/D5qOQhayxFm5cwrQ"',mtime:"2025-05-20T20:26:05.932Z",size:330,path:"../_build/.vite/manifest.json.br"},"/_build/.vite/manifest.json.gz":{type:"application/json",encoding:"gzip",etag:'"17d-8lwbevvyT8cAnzxYlnTAHd7Isjk"',mtime:"2025-05-20T20:26:05.931Z",size:381,path:"../_build/.vite/manifest.json.gz"},"/_build/assets/_...404_-dua6DiWa.js":{type:"text/javascript; charset=utf-8",etag:'"b7-cJIVnEiEvhB37oUqVn3OsldxVIM"',mtime:"2025-05-20T20:26:05.896Z",size:183,path:"../_build/assets/_...404_-dua6DiWa.js"},"/_build/assets/client-Dc-Tua0f.js":{type:"text/javascript; charset=utf-8",etag:'"3b8c-f9VPOk6O6S4ZH+TQZWNw7EhHyEQ"',mtime:"2025-05-20T20:26:05.896Z",size:15244,path:"../_build/assets/client-Dc-Tua0f.js"},"/_build/assets/client-Dc-Tua0f.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"15b2-6AZInmubSq/u8y2w7L+LxAhFHXQ"',mtime:"2025-05-20T20:26:05.932Z",size:5554,path:"../_build/assets/client-Dc-Tua0f.js.br"},"/_build/assets/client-Dc-Tua0f.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"1832-NIVTquuSVCYplE7LIxezMOMH70I"',mtime:"2025-05-20T20:26:05.932Z",size:6194,path:"../_build/assets/client-Dc-Tua0f.js.gz"},"/_build/assets/client-rN2XJZw8.css":{type:"text/css; charset=utf-8",etag:'"17f-EyPT40t0Q2Ip557OUJ0k5vttT/g"',mtime:"2025-05-20T20:26:05.896Z",size:383,path:"../_build/assets/client-rN2XJZw8.css"},"/_build/assets/index-DSajY67n.js":{type:"text/javascript; charset=utf-8",etag:'"847a-MquO6H8kryhTtmdxCzrL7dsLivo"',mtime:"2025-05-20T20:26:05.896Z",size:33914,path:"../_build/assets/index-DSajY67n.js"},"/_build/assets/index-DSajY67n.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"2888-6mV3Js5YqNogYBq4GrpKy5r+pJk"',mtime:"2025-05-20T20:26:05.935Z",size:10376,path:"../_build/assets/index-DSajY67n.js.br"},"/_build/assets/index-DSajY67n.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"2cf7-ZAxBk8ChGKD0hfYjeVrGCL2UL6g"',mtime:"2025-05-20T20:26:05.932Z",size:11511,path:"../_build/assets/index-DSajY67n.js.gz"},"/_build/assets/index-Js0Seij8.js":{type:"text/javascript; charset=utf-8",etag:'"48a-DKoz+8mao4an54uRdSaF8mXyEOs"',mtime:"2025-05-20T20:26:05.896Z",size:1162,path:"../_build/assets/index-Js0Seij8.js"},"/_build/assets/index-Js0Seij8.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"220-EqSrQ7bZXUTBhQSaUyjZIUgoV+4"',mtime:"2025-05-20T20:26:05.932Z",size:544,path:"../_build/assets/index-Js0Seij8.js.br"},"/_build/assets/index-Js0Seij8.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"276-QHDGGbJTMM/3M7GKOZEw92qz2Mk"',mtime:"2025-05-20T20:26:05.932Z",size:630,path:"../_build/assets/index-Js0Seij8.js.gz"},"/_build/assets/login-Cs7fDAsq.js":{type:"text/javascript; charset=utf-8",etag:'"4e4-ln+0XYayF+0Gbv+/kiARSFQXES8"',mtime:"2025-05-20T20:26:05.897Z",size:1252,path:"../_build/assets/login-Cs7fDAsq.js"},"/_build/assets/login-Cs7fDAsq.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"20f-k+Sis3+DbSuwyY71H0LvBA2RbYo"',mtime:"2025-05-20T20:26:05.932Z",size:527,path:"../_build/assets/login-Cs7fDAsq.js.br"},"/_build/assets/login-Cs7fDAsq.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"28c-spNQ066ipHk4D+FZVInYMSOd74c"',mtime:"2025-05-20T20:26:05.932Z",size:652,path:"../_build/assets/login-Cs7fDAsq.js.gz"},"/_build/assets/web-KYKOfUcb.js":{type:"text/javascript; charset=utf-8",etag:'"59e6-gG6BQWqH9onwGGOg7xxK754t4Nk"',mtime:"2025-05-20T20:26:05.896Z",size:23014,path:"../_build/assets/web-KYKOfUcb.js"},"/_build/assets/web-KYKOfUcb.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"1fb4-+YKhYkkk0Qcfk8w2ejL4GfT694o"',mtime:"2025-05-20T20:26:05.932Z",size:8116,path:"../_build/assets/web-KYKOfUcb.js.br"},"/_build/assets/web-KYKOfUcb.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"22d5-WR94Pfi1WH7vDQlSKecqiDh9FE0"',mtime:"2025-05-20T20:26:05.932Z",size:8917,path:"../_build/assets/web-KYKOfUcb.js.gz"},"/_server/assets/app-B2XfqFCO.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"a07-+Top4eq0VmEJE6bpKvSVlUXAji4"',mtime:"2025-05-20T20:26:05.932Z",size:2567,path:"../_server/assets/app-B2XfqFCO.js.br"},"/_server/assets/app-B2XfqFCO.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"b36-PEC02v360PDpLZmEEbTQiasge0Q"',mtime:"2025-05-20T20:26:05.932Z",size:2870,path:"../_server/assets/app-B2XfqFCO.js.gz"},"/_server/assets/app-rN2XJZw8.css":{type:"text/css; charset=utf-8",etag:'"17f-EyPT40t0Q2Ip557OUJ0k5vttT/g"',mtime:"2025-05-20T20:26:05.898Z",size:383,path:"../_server/assets/app-rN2XJZw8.css"},"/_server/assets/index-DcGoOrg_.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"1cca-DO/vuVGXySSKnTBAMwb4k/nroBc"',mtime:"2025-05-20T20:26:05.940Z",size:7370,path:"../_server/assets/index-DcGoOrg_.js.br"},"/_server/assets/index-DcGoOrg_.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"1fc2-kEYzgNiQS7O1pfbhIwK9WH6/S7E"',mtime:"2025-05-20T20:26:05.932Z",size:8130,path:"../_server/assets/index-DcGoOrg_.js.gz"},"/_server/assets/server-B-YuvM1W.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"2c7-sbe6sN4+Qs7K4A06+tolud/x0a0"',mtime:"2025-05-20T20:26:05.932Z",size:711,path:"../_server/assets/server-B-YuvM1W.js.br"},"/_server/assets/server-B-YuvM1W.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"333-lXJkJkViK65I5i19Ivlq244VQhM"',mtime:"2025-05-20T20:26:05.932Z",size:819,path:"../_server/assets/server-B-YuvM1W.js.gz"},"/_server/assets/server-fns-CD-uTy4t.js.br":{type:"text/javascript; charset=utf-8",encoding:"br",etag:'"dba-hiR2VyFl3IrXTzvtwPhlrlrbeyg"',mtime:"2025-05-20T20:26:05.936Z",size:3514,path:"../_server/assets/server-fns-CD-uTy4t.js.br"},"/_server/assets/server-fns-CD-uTy4t.js.gz":{type:"text/javascript; charset=utf-8",encoding:"gzip",etag:'"f44-2Qt6CFea/t73TrcDMfiellFoTkM"',mtime:"2025-05-20T20:26:05.932Z",size:3908,path:"../_server/assets/server-fns-CD-uTy4t.js.gz"}},ic={};const oc=useNitroApp(),ac={async fetch(o,a,c){const u=new URL(o.url);if(a.ASSETS&&function(s=""){if(nc[s])return!0;for(const o in ic)if(s.startsWith(o))return!0;return!1}(u.pathname))return a.ASSETS.fetch(o);let p;return function(s){return vn.test(s.method)}(o)&&(p=s.from(await o.arrayBuffer())),globalThis.__env__=a,oc.localFetch(u.pathname+u.search,{context:{waitUntil:s=>c.waitUntil(s),_platform:{cf:o.cf,cloudflare:{request:o,env:a,context:c}}},host:u.hostname,protocol:u.protocol,method:o.method,headers:o.headers,body:p})},scheduled(s,o,a){}};export{$n$1 as $,Ae$1 as A,Fa as B,Ma as D,Fn$1 as F,G$1 as G,Jt as J,Ha as L,za as M,Q$1 as Q,Show as S,Tn$1 as T,Un$1 as U,qa as W,Oa as X,La as _,ssrHydrationKey as a,ssrAttribute as b,createResource as c,createComponent as d,escape as e,eq as f,Sa as g,Suspense as h,getRequestEvent as i,children as j,createMemo as k,Gt$1 as l,z as m,getOwner as n,on$2 as o,createRoot as p,Nl as q,re$1 as r,ssr as s,Ol as t,wo as u,Tn as v,Ll as w,ac as x};
//# sourceMappingURL=nitro.mjs.map
